{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VF Hotel List</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/booking/listofhotel.css' %}">
    <script src="{% static 'js/booking/listofhotel.js' %}"></script>
    <script src="{% static 'js/booking/homepage2.js' %}"></script>
</head>
<body >
    <div id="preloader"></div>
    <style>
        #preloader {
            background: url("{% static 'image/booking/loading1.gif'%}") no-repeat center center;
            width: 100%;
            height: 300px;
            margin-top: 100px;
            align-items: center;
            justify-content: center;
        }
    </style>

    <!-- <div id="preloader"></div> -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Message</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <span id="errorMessageContainer"></span>
                </div>
            </div>
        </div>
    </div>


    <!-- FORGOT PASSWORD -->
    <div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter1Title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container2">
                            <form class="col-md-12 mt-2" id="signup_form">
                                <div class="d-flex justify-content-between" id="sign_head_div">
                                    <h4 class="signup_text">FORGET PASSWORD</h4>
                                    <button type="button" class="close" style="border: none;background: none;font-size: 25px;" data-dismiss="modal" aria-label="Close" id="forgetclose">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div>
                                    <p class="sign_utext">OTP send to the whatsapp or mail.</p>
                                </div>
                                <div class="input_div mt-2" id="UserName">
                                    <label for="email_or_phone_password">Email Or Phone Number</label><span class="error" id="emailError2"></span>
                                    <input type="text" class="mt-4 input_signin email_or_phone_password" placeholder="phone number or email" name="email_or_phone_password" id="email_or_phone_password">
                                    <span class="error" id="email_or_phone_number"></span>
                                </div>
                                <div class="input_div mt-2" id="Password"></div>
                                <div id="gif" style="display: none;width: 100%;align-items: center;justify-content: center;text-align: center;"><img src="/static/image/booking/icegif-727.gif" alt="Success GIF" style="
                                    background: none !important;
                                    width: 250px;
                                "></div>
                                <!-- <div class="mt-4" id="checkbox_div">
                                    <div class="d-flex">
                                        <input type="checkbox" style="width: 19px;height: 19px">
                                        <p class="mb-0 check_text">I Agree With <span>Terms Of Servies</span>  And The <span> Privacy Policy</span> </p>
                                    </div>
                                    <span class="error" id="checkboxError"></span>
                                </div> -->
                                <div><p id="otpmessage"></p></div>
                                <div class="row justify-content-center" id="otp_container_forget">
                                    <div class="mt-2">
                                        <div class="card mb-0 mt-0 border-0">
                                        <div class="card-body p-2 text-center">
                                            <!-- <h4>Verify</h4>
                                            <p>Your code was sent to you via email</p> -->
                                            <div class="otp-field mb-2">
                                                <input id="digit1" type="number" />
                                                <input id="digit2" type="number" disabled />
                                                <input id="digit3" type="number" disabled />
                                                <input id="digit4" type="number" disabled />
                                            </div>
                                            <span class="error" id="Otp_error"></span>
                                            <!-- <p class="resend text-muted mb-2">Didn't receive code? <a href="">Request again</a></p> -->
                                            <div class="mt-0 mb-0">Time left : <span id="timers"></span></div>
                                            <div id="verifyButton" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                            <script>
                                                function submitPassword() {
                                                    // Retrieve form values
                                                    var userName = $("#email_or_phone_password").val();
                                                    var password = $("#New_password").val();
                                                    var confirmPassword = $("#New_confirm_password").val();

                                                    var csrftoken = getCookie('csrftoken');
                    
                                                    // AJAX request
                                                    $.ajax({
                                                        type: "POST",
                                                        url: "/change_password/",
                                                        headers: {
                                                                'X-CSRFToken': csrftoken
                                                        },
                                                        data: {
                                                            user_name: userName,
                                                            password: password,
                                                            confirm_password:confirmPassword
                                                        },
                                                        success: function(response) {
                                                            // Handle success response
                                                            console.log(response);
                                                            if (response.success === true) {
                                                                document.getElementById('Password').innerHTML = " ";
                                                                document.getElementById('Password').innerHTML = "<p>Password Changed</p>";
                                                                document.getElementById('gif').style.display = 'block';
                                                                // If the response is success, submit the form
                                                            } else {
                                                                console.log("success")
                                                                $("#passwordErrors").text(response.error_message);
                                                            }
                                                        },
                                                        error: function(xhr, status, error) {
                                                            // Handle error
                                                            console.error(xhr.responseText);
                                                        }
                                                    });
                                                }
                                            </script>                                          
                                            <script>
                                                document.addEventListener('DOMContentLoaded', function () {
                                                    document.getElementById('verifyButton').addEventListener('click', function () {
                                                        var digit1 = document.getElementById('digit1').value;
                                                        var digit2 = document.getElementById('digit2').value;
                                                        var digit3 = document.getElementById('digit3').value;
                                                        var digit4 = document.getElementById('digit4').value;
                
                                                        // Concatenate the digits into a single string
                                                        var otp = digit1 + digit2 + digit3 + digit4;
                
                                                        // Get CSRF token
                                                        var csrftoken = getCookie('csrftoken');
                                            
                                                        // Send the OTP to the backend using AJAX
                                                        $.ajax({
                                                            type: 'POST',
                                                            url: '/verify-otp/',  // URL to the backend view
                                                            headers: {
                                                                'X-CSRFToken': csrftoken
                                                            },
                                                            data: {
                                                                'otp': otp,
                                                                // You can include other data if needed
                                                            },
                                                            success: function(response) {
                                                                // Handle success response
                                                                console.log(response);
                                                                if (response.success === true) {
                                                                    // If the response is success, submit the form
                                                                    document.getElementById('UserName').style.display = 'none';
                                                                    var name = document.getElementById('email_or_phone_password').value;
                                                                    console.log(name)
                                                                    document.getElementById('otp_container_forget').innerHTML = '';
                                                                    
                                                                    // Insert HTML inside 'msg' id
                                                                    document.getElementById('Password').innerHTML = `
                                                                        <div class="input_div mt-2">
                                                                            <div style="margin:4px;width: 100%;">
                                                                                <input type="password" class="input_signin password" name="password" id="New_password" placeholder="Enter Password">
                                                                            </div>
                                                                            <div style="margin:4px;width: 100%;">
                                                                                <input type="password" class="input_signin confirm_password" name="confirm_password" id="New_confirm_password" placeholder="Confirm Password">
                                                                                <span class="error" id="passwordErrors" class="passwordErrors"></span>
                                                                            </div>
                                                                        </div>
                                                                        <div id="verifyBtn" onclick="submitPassword()" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                                                    `;
                                                                } else {
                                                                    var otperror = document.getElementById('Otp_error');
                                                                    otperror.innerText = response.message;
                                                                    // var errorButton = document.getElementById('errorButtons');
                                                                    // errorButton.classList.remove('d-none');
                                                                    // var errorMessage = document.getElementById('errorMessageContainers');
                                                                    // errorMessage.innerHTML = response.message;
                                                                    // errorButton.click(); // Trigger click event to show the modal
                                                                }
                                                            },
                                                            error: function(xhr, errmsg, err) {
                                                                // Handle error
                                                                console.log(xhr.status + ": " + xhr.responseText);
                                                            }
                                                        });
                                                    });
                                                });
                                            </script>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 btn_div">
                                    <button class="sign_btn" id="signButton"  type="button" onclick="validateFormpassword()">OTP send to the whatsapp or mail</button>
                                </div>
                                <!-- <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Already Have An Account? </p> &nbsp
                                    <button type="button" onclick="loginroute()" class="lg_btn" style="border: none;background: none;text-decoration: underline"></button>
                                </div> -->
                            </form>
                        </div>
                        <!-- <script>
                            function loginroute(){
                                $("#LogClose").click();
                                $("#log-btn").click();
                            }
                        </script> -->
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap');
                    
                            * {
                                margin: 0;
                                padding: 0;
                                font-family: 'Inter', sans-serif;
                            }
                    /* 
                            body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            } */
                            
                            .otp-field {
                                flex-direction: row;
                                column-gap: 20px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            }
                    
                            .otp-field input {
                                height: 45px;
                                width: 42px;
                                border-radius: 6px;
                                outline: none;
                                font-size: 1.125rem;
                                text-align: center;
                                border: 1px solid #ddd;
                            }
                            
                            .otp-field input:focus {
                                box-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);
                            }
                    
                            .otp-field input::-webkit-inner-spin-button,
                            .otp-field input::-webkit-outer-spin-button {
                                display: none;
                            }
                    
                            .resend {
                                font-size: 12px;
                            }
                    
                            #otp_container_forget{
                                display: none;
                            }
                            
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                    
                            #image_container {
                                background:url("{% static 'images/Signin_bg.jfif' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }
                    
                            .container-fluid {
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            }
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            #signup_container {
                                padding: 20px;
                            }
                    
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 24px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            .input_signin {
                                background: rgba(237, 237, 237, 0.75);
                                border-radius: 53px;
                                padding: 13px 18px;
                                font-size: 15px;
                                height: auto !important;
                                font-weight: 600;
                                color:rgba(23, 52, 73, 0.61);
                                border: none;
                                width: 100%;
                                margin: 2px;
                            }
                    
                            .input::placeholder {
                                font-weight: 400;
                                color:rgba(23, 52, 73, 0.61);
                                font-size: 15px;
                            }
                    
                            #checkbox_div {
                               margin: 2px 10px;
                               /* display: none; */
                            }
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                    
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                           #verifyBtn {
                                padding: 12px 20px;
                                color:rgba(255, 255, 255, 1);
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                width: 100%;
                                height: 50px;
                                border: none;
                                font-weight: 600;
                                font-size: 15px;
                                border-radius: 50px;
                           }
                    
                           #timers {
                            border: 1px solid black;
                            border-radius: 10px;
                            font-weight: 600;
                            box-shadow: 5px 5px 5px 0.5 gray;
                            padding: 4px;
                           }
                            
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                            @media only screen and (max-width: 768px) {
                                #main_container {
                                    flex-direction: column;
                                }
                            }
                    
                        </style>
                        <!-- <script>
                            let timerOns = true;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signButton");
                            function timers(remaining) {
                                var m = Math.floor(remaining / 60);
                                var s = remaining % 60;
                        
                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timers').innerHTML = m + ':' + s;
                                remaining -= 1;
                        
                                if (remaining >= 0 && timerOns) {
                                    setTimeout(function () {
                                        timers(remaining);
                                    }, 1000);
                                    return;
                                }
                        
                                if (!timerOns) {
                                    // Do validate stuff here
                                    return;
                                }
                        
                                if (document.getElementById('UserName').style.display === 'none') {
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "none";
                                } else if (document.getElementById('UserName').style.display === 'block') {
                                    // Do timeout stuff here
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "block";
                                    signBtn.innerHTML = "Resend OTP";
                                } else {
                                    alert("Something went wrong");
                                }
                            }
                        </script> -->
                        
                       <script>
                        function validateFormpassword() {
                            var valid = true;
                            document.getElementById('email_or_phone_password').innerText = '';
                            // document.getElementById('phoneError').innerText = '';
                            // document.getElementById('emailError').innerText = '';
                            // document.getElementById('passwordError').innerText = '';
                            // document.getElementById('confirmPasswordError').innerText = '';
                            // document.getElementById('checkboxError').innerText = '';
                
                            var nameInput = document.querySelector('.email_or_phone_password');
                            // var phoneInput = document.querySelector('.phone_number');
                            // var emailInput = document.querySelector('.email');
                            // var passwordInput = document.querySelector('.password');
                            // var confirmPasswordInput = document.querySelector('.confirm_password');
                            // var checkbox = document.querySelector('#checkbox_div input[type="checkbox"]');
                            
                    
                            var email = nameInput.value;
                            // var phone = phoneInput.value;
                            // var email = emailInput.value;
                            // var password = passwordInput.value;
                            // var confirmPassword = confirmPasswordInput.value;
                    
                            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            var phonePattern = /^\d{10}$/;
                            if (email.trim() === '') {
                                document.getElementById('email_or_phone_number').innerText = 'Email is required';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            }  else if (!emailPattern.test(email) && !phonePattern.test(email)) {
                                document.getElementById('email_or_phone_number').innerText = 'Invalid email address or phone number';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                nameInput.style.border = ''; // Reset border style if valid
                            }
                
                            if (valid) {
                                document.getElementById("otpmessage").innerText = "OTP WILL BE SEND TO THE PHONE NUMBER AND MAIL";
                                sendOTPass();
                            }
                
                            return valid
                        }

                    </script>
                    <script>
                        function sendOTPass() {
                            // Send AJAX request to server to send OTP to the provided phone number
                            var phone_number = document.getElementById("email_or_phone_password").value;

                            // Get CSRF token from the cookie
                            var csrftoken = getCookie('csrftoken');

                            // Example AJAX request with CSRF token included
                            $.ajax({
                                url: '/send_otp_forgot/',
                                type: 'POST',
                                data: {
                                    'phone_number': phone_number,
                                    'csrfmiddlewaretoken': csrftoken // Include the CSRF token in the data
                                },
                                success: function(response) {
                                    if (response.success === true) {
                                        // If the response is success, submit the form
                                        document.getElementById("otpmessage").innerText = " ";
                                        otpDiv.style.display = "block";
                                        document.getElementById("signButton").style.display = "none";
                                        document.getElementById('otp_container_forget').style.display = 'block';

                                        // Store expiration time in localStorage
                                        var expirationTime = new Date();
                                        expirationTime.setSeconds(expirationTime.getSeconds() + 180); // Assuming expiration time is 180 seconds
                                        localStorage.setItem('expirationTime', expirationTime.getTime());

                                        timers();
                                    } else {
                                        var errorMessage = document.getElementById('otpmessage');
                                        errorMessage.innerText = response.message;
                                        var errorButton = document.getElementById('errorButtons');
                                        errorButton.click();
                                        otpDiv.style.display = "none";
                                        signBtn.style.display = "block";
                                    }
                                }
                            });
                        }

                        // Function to get CSRF token from the cookie
                        function getCookie(name) {
                            var cookieValue = null;
                            if (document.cookie && document.cookie !== '') {
                                var cookies = document.cookie.split(';');
                                for (var i = 0; i < cookies.length; i++) {
                                    var cookie = cookies[i].trim();
                                    // Check if the cookie name matches the requested name
                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                        // Extract and decode the CSRF token
                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                        break;
                                    }
                                }
                            }
                            return cookieValue;
                        }

                        var otpDivcon = document.getElementById("otp_container_forget");
                        var signBtncon = document.getElementById("signButton");

                        function timers() {
                            var expirationTime = localStorage.getItem('expirationTime');

                            if (!expirationTime) return;

                            function updateTimer() {
                                var currentTime = new Date().getTime();
                                var remainingTime = Math.max(0, Math.floor((expirationTime - currentTime) / 1000));

                                var m = Math.floor(remainingTime / 60);
                                var s = remainingTime % 60;

                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timers').innerHTML = m + ':' + s;

                                if (remainingTime > 0) {
                                    setTimeout(updateTimer, 1000);
                                } else {
                                    // Handle timeout
                                    otpDivcon.style.display = "none";
                                    signBtncon.style.display = "block";
                                    signBtncon.innerHTML = "Resend OTP";
                                }
                            }

                            updateTimer();
                        }
                    </script>
                    <script>
                        const inputss = document.querySelectorAll(".otp-field > input");
                        const buttons = document.querySelector(".verify_btn");
                
                        window.addEventListener("load", () => inputs[0].focus());
                        button.setAttribute("disabled", "disabled");
                
                        inputs[0].addEventListener("paste", function (event) {
                        event.preventDefault();
                
                        const pastedValue = (event.clipboardData || window.clipboardData).getData(
                            "text"
                        );
                        const otpLength = inputs.length;
                
                        for (let i = 0; i < otpLength; i++) {
                            if (i < pastedValue.length) {
                            inputs[i].value = pastedValue[i];
                            inputs[i].removeAttribute("disabled");
                            inputs[i].focus;
                            } else {
                            inputs[i].value = ""; // Clear any remaining inputs
                            inputs[i].focus;
                            }
                        }
                        });
                
                        inputs.forEach((input, index1) => {
                        input.addEventListener("keyup", (e) => {
                            const currentInput = input;
                            const nextInput = input.nextElementSibling;
                            const prevInput = input.previousElementSibling;
                
                            if (currentInput.value.length > 1) {
                            currentInput.value = "";
                            return;
                            }
                
                            if (
                            nextInput &&
                            nextInput.hasAttribute("disabled") &&
                            currentInput.value !== ""
                            ) {
                            nextInput.removeAttribute("disabled");
                            nextInput.focus();
                            }
                
                            if (e.key === "Backspace") {
                            inputs.forEach((input, index2) => {
                                if (index1 <= index2 && prevInput) {
                                input.setAttribute("disabled", true);
                                input.value = "";
                                prevInput.focus();
                                }
                            });
                            }
                
                            button.classList.remove("active");
                            button.setAttribute("disabled", "disabled");
                
                            const inputsNo = inputs.length;
                            if (!inputs[inputsNo - 1].disabled && inputs[inputsNo - 1].value !== "") {
                            button.classList.add("active");
                            button.removeAttribute("disabled");
                
                            return;
                            }
                        });
                        });
                    </script>  
                    </section>
            </div>
        </div>
        </div>
    </div> 

     <!-- SIGNIN POPUP -->
     <div class="modal fade" id="exampleModalCenter1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter1Title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container1">
                            <!-- <div class="col-md-6" id="image_container">
                                <div class="mt-2">
                                    <img src="{% static 'images/Magnet logo.png' %}" alt="" style="width: 79px;height: 79px;">
                                </div>
                                <div class="mt-3">
                                    <h4 class="image_h4">Explore The World And Discover The New Experiance</h4>
                                </div>
                                <div class="features_div col-md-6">
                                    <p class="features mt-4" style="width: 260px;">Customizable Tour Packages</p>
                                    <p class="features mt-4" style="width: 207px;">Personalized Services</p>
                                    <p class="features mt-4" style="width: 149px;">24/7 Service</p>
                                </div>
                                <img src="{% static 'images/Signin_bg.jfif' %}" alt="" style="width: 100%; height:100%;border-radius: 20px">
                            </div> -->
                            <form class="col-md-12 mt-2" id="signup_form">
                                {% csrf_token %}
                                <div class="d-flex justify-content-between" id="sign_head_div">
                                    <h4 class="signup_text">Sign Up</h4>
                                    <button type="button" class="close" style="border: none;background: none;font-size: 25px;" data-dismiss="modal" aria-label="Close" id="LogClose">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div>
                                    <p class="sign_utext">Create Your Account,Get Your Personalized Tour Account.</p>
                                </div>
                                <div class="input_div mt-2">
                                    <input type="text" class="mt-4 input_signin username" id="user_name" placeholder="User Name" name="user_name" >
                                    <span class="error" id="nameError"></span>
                                    <input type="text" class="mt-4 input_signin phone_number" placeholder="Phone Number" name="phone_number" id="phone_number">
                                    <span class="error" id="phoneError"></span>
                                    <input type="email" class="mt-4 input_signin email" placeholder="Email" name="email" id="Email">
                                    <span class="error" id="emailError"></span>
                                </div>
                                <div class="mt-3 justify-content-between d-flex">
                                    <div style="margin:4px;width: 100%;">
                                        <input type="password" class="input_signin password" name="password" id="password" placeholder="Enter Password">
                                        <span class="error" id="passwordError"></span>
                                    </div>
                                    <div style="margin:4px;width: 100%;">
                                        <input type="password" class="input_signin confirm_password" name="confirm_password" id="confirm_password" placeholder="Confirm Password" >
                                        <span class="error" id="confirmPasswordError"></span>
                                    </div>
                                </div>
                                <div class="mt-4" id="checkbox_div">
                                    <div class="d-flex">
                                        <input type="checkbox" style="width: 19px;height: 19px">
                                        <p class="mb-0 check_text">I Agree With <span>Terms Of Servies</span>  And The <span> Privacy Policy</span> </p>
                                    </div>
                                    <span class="error" id="checkboxError"></span>
                                </div>
                                <div><p id="otpmessages"></p></div>
                                <div class="row justify-content-center" id="otp_container">
                                    <div class="mt-2">
                                        <div class="card mb-0 mt-0 border-0">
                                        <div class="card-body p-2 text-center">
                                            <!-- <h4>Verify</h4>
                                            <p>Your code was sent to you via email</p> -->
                                            <div class="otp-field mb-2">
                                                <input id="digitA" type="number" />
                                                <input id="digitB" type="number" disabled />
                                                <input id="digitC" type="number" disabled />
                                                <input id="digitD" type="number" disabled />
                                            </div>
                                            <p class="resend text-muted mb-2">Didn't receive code? <a href="">Request again</a></p>
                                            <div class="mt-0 mb-0">Time left : <span id="timer"></span></div>
                                            <div id="verifyBtn" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                            {% if error_message %}
                                            <script>
                                                alert("{{ error_message }}")
                                            </script>    
                                            {% endif %}
                                            <script>
                                                function submitForm() {
                                                    // Retrieve form values
                                                    var userName = $("#user_name").val();
                                                    var phoneNumber = $("#phone_number").val();
                                                    var email = $("#Email").val();
                                                    var password = $(".password").val();
                                                    var confirmPassword = $(".confirm_password").val();

                                                    var csrftoken = getCookie('csrftoken');
                    
                                                    // AJAX request
                                                    $.ajax({
                                                        type: "POST",
                                                        url: "/signups/",
                                                        headers: {
                                                                'X-CSRFToken': csrftoken
                                                        },
                                                        data: {
                                                            user_name: userName,
                                                            phone_number: phoneNumber,
                                                            email: email,
                                                            password: password,
                                                            confirm_password:confirmPassword
                                                        },
                                                        success: function(response) {
                                                            // Handle success response
                                                            console.log(response);
                                                            if (response.success === true) {
                                                                // If the response is success, submit the form
                                                                $("#LogClose").click();
                                                                $("#log-btn").click();
                                                            } else {
                                                                console.log("success")
                                                                $("#LogClose").click();
                                                                var errorMessage = document.getElementById('errorMessageContainer');
                                                                errorMessage.innerHTML = response.error_message;
                                                                $("#errorButtons").click();
                                                            }
                                                        },
                                                        error: function(xhr, status, error) {
                                                            // Handle error
                                                            console.error(xhr.responseText);
                                                        }
                                                    });
                                                }
                                            </script>                                          
                                            <script>
                                                document.addEventListener('DOMContentLoaded', function () {
                                                    document.getElementById('verifyBtn').addEventListener('click', function () {
                                                        var digit1 = document.getElementById('digitA').value;
                                                        var digit2 = document.getElementById('digitB').value;
                                                        var digit3 = document.getElementById('digitC').value;
                                                        var digit4 = document.getElementById('digitD').value;
                
                                                        // Concatenate the digits into a single string
                                                        var otp = digit1 + digit2 + digit3 + digit4;
                
                                                        // Get CSRF token
                                                        var csrftoken = getCookie('csrftoken');
                                            
                                                        // Send the OTP to the backend using AJAX
                                                        $.ajax({
                                                            type: 'POST',
                                                            url: '/verify-otp/',  // URL to the backend view
                                                            headers: {
                                                                'X-CSRFToken': csrftoken
                                                            },
                                                            data: {
                                                                'otp': otp,
                                                                // You can include other data if needed
                                                            },
                                                            success: function(response) {
                                                                // Handle success response
                                                                console.log(response);
                                                                if (response.success === true) {
                                                                    // If the response is success, submit the form
                                                                    submitForm();
                                                                } else {
                                                                    var errorButton = document.getElementById('errorButtons');
                                                                    errorButton.classList.remove('d-none');
                                                                    var errorMessage = document.getElementById('errorMessageContainers');
                                                                    errorMessage.innerHTML = response.message;
                                                                    errorButton.click(); // Trigger click event to show the modal
                                                                }
                                                            },
                                                            error: function(xhr, errmsg, err) {
                                                                // Handle error
                                                                console.log(xhr.status + ": " + xhr.responseText);
                                                            }
                                                        });
                                                    });
                                                });
                                            </script>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 btn_div">
                                    <button class="sign_btn" id="signBtn"  type="button" onclick="validateFormSign()">OTP send to the whatsapp and mail</button>
                                </div>
                                <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Already Have An Account? </p> &nbsp
                                    <button type="button" onclick="loginroute()" class="lg_btn" style="border: none;background: none;text-decoration: underline">Log In</button>
                                </div>
                            </form>
                        </div>
                        <script>
                            function loginroute(){
                                $("#LogClose").click();
                                $("#log-btn").click();
                            }
                        </script>
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap');
                    
                            * {
                                margin: 0;
                                padding: 0;
                                font-family: 'Inter', sans-serif;
                            }
                    /* 
                            body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            } */
                            
                            .otp-field {
                                flex-direction: row;
                                column-gap: 20px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            }
                    
                            .otp-field input {
                                height: 45px;
                                width: 42px;
                                border-radius: 6px;
                                outline: none;
                                font-size: 1.125rem;
                                text-align: center;
                                border: 1px solid #ddd;
                            }
                            
                            .otp-field input:focus {
                                box-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);
                            }
                    
                            .otp-field input::-webkit-inner-spin-button,
                            .otp-field input::-webkit-outer-spin-button {
                                display: none;
                            }
                    
                            .resend {
                                font-size: 12px;
                            }
                    
                            #otp_container{
                                display: none;
                            }
                            
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                    
                            #image_container {
                                background:url("{% static 'images/Signin_bg.jfif' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }
                    
                            .container-fluid {
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            }
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            #signup_container {
                                padding: 20px;
                            }
                    
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 24px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            .input_signin {
                                background: rgba(237, 237, 237, 0.75);
                                border-radius: 53px;
                                padding: 13px 18px;
                                font-size: 15px;
                                height: auto !important;
                                font-weight: 600;
                                color:rgba(23, 52, 73, 0.61);
                                border: none;
                                width: 100%;
                                margin: 2px;
                            }
                    
                            .input::placeholder {
                                font-weight: 400;
                                color:rgba(23, 52, 73, 0.61);
                                font-size: 15px;
                            }
                    
                            #checkbox_div {
                               margin: 2px 10px;
                               /* display: none; */
                            }
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                    
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                           #verifyBtn {
                                padding: 12px 20px;
                                color:rgba(255, 255, 255, 1);
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                width: 100%;
                                height: 50px;
                                border: none;
                                font-weight: 600;
                                font-size: 15px;
                                border-radius: 50px;
                           }
                    
                           #timer {
                            border: 1px solid black;
                            border-radius: 10px;
                            font-weight: 600;
                            box-shadow: 5px 5px 5px 0.5 gray;
                            padding: 4px;
                           }
                            
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                            @media only screen and (max-width: 768px) {
                                #main_container {
                                    flex-direction: column;
                                }
                            }
                    
                        </style>
                        <!-- <script>
                            let timerOn = true;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signBtn");
                            function timer(remaining) {
                            var m = Math.floor(remaining / 60);
                            var s = remaining % 60;
                            
                            m = m < 10 ? '0' + m : m;
                            s = s < 10 ? '0' + s : s;
                            document.getElementById('timer').innerHTML = m + ':' + s;
                            remaining -= 1;
                            
                            if(remaining >= 0 && timerOn) {
                                setTimeout(function() {
                                    timer(remaining);
                                }, 1000);
                                return;
                            }
                    
                            if(!timerOn) {
                                // Do validate stuff here
                                return;
                            }
                            
                            // Do timeout stuff here
                            alert('Timeout for otp');
                            otpDiv.style.display = "none";
                            signBtn.style.display = "block"
                            signBtn.innerHTML = "Resend OTP"
                            }
                        </script> -->
                       <script>
                        function validateFormSign() {
                            var valid = true;
                            document.getElementById("otpmessages").innerText = "OTP WILL BE SEND TO THE PHONE NUMBER AND MAIL";
                            document.getElementById('nameError').innerText = '';
                            document.getElementById('phoneError').innerText = '';
                            document.getElementById('emailError').innerText = '';
                            document.getElementById('passwordError').innerText = '';
                            document.getElementById('confirmPasswordError').innerText = '';
                            document.getElementById('checkboxError').innerText = '';
                
                            var nameInput = document.querySelector('.username');
                            var phoneInput = document.querySelector('.phone_number');
                            var emailInput = document.querySelector('.email');
                            var passwordInput = document.querySelector('.password');
                            var confirmPasswordInput = document.querySelector('.confirm_password');
                            var checkbox = document.querySelector('#checkbox_div input[type="checkbox"]');
                            
                    
                            var name = nameInput.value;
                            var phone = phoneInput.value;
                            var email = emailInput.value;
                            var password = passwordInput.value;
                            var confirmPassword = confirmPasswordInput.value;
                    
                            if (name === '') {
                                document.getElementById('nameError').innerText = 'Name is required';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                nameInput.style.border = '';
                            }
                    
                            var phonePattern = /^\d{10}$/;
                            if (phone === '') {
                                document.getElementById('phoneError').innerText = 'Phone number is required';
                                phoneInput.style.border = '1px solid red';
                                valid = false;
                            } else if (!phonePattern.test(phone)) {
                                document.getElementById('phoneError').innerText = 'Invalid phone number';
                                phoneInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                phoneInput.style.border = '';
                            }
                
                            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            if (email.trim() === '') {
                                document.getElementById('emailError').innerText = 'Email is required';
                                emailInput.style.border = '1px solid red';
                                valid = false;
                            } else if (!emailPattern.test(email)) {
                                document.getElementById('emailError').innerText = 'Invalid email address';
                                emailInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                emailInput.style.border = ''; // Reset border style if valid
                            }
                            
                
                            if (password === '') {
                                document.getElementById('passwordError').innerText = 'Password is required';
                                passwordInput.style.border = '1px solid red';
                                valid = false;
                            } else if (password.length < 8) {
                                document.getElementById('passwordError').innerText = 'Password must be at least 8 characters long';
                                passwordInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                passwordInput.style.border = '';
                            }
                
                            if (confirmPassword === '') {
                                document.getElementById('confirmPasswordError').innerText = 'confirm your password';
                                confirmPasswordInput.style.border = '1px solid red';
                                valid = false;
                            } else if (confirmPassword !== password) {
                                document.getElementById('confirmPasswordError').innerText = 'Passwords do not match';
                                confirmPasswordInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                confirmPasswordInput.style.border = '';
                            }
                
                            if (!checkbox.checked) {
                                document.getElementById('checkboxError').innerText = 'Please agree to the terms and privacy policy';
                                valid = false;
                            }
                
                            if (valid) {
                                sendOTP();
                            }
                
                            return valid
                        }

                        // function sendOTP() {
                        //     // Send AJAX request to server to send OTP to the provided phone number
                        //     var phone_number = document.getElementById("phone_number").value;
                        //     var email = document.getElementById("Email").value;
                        //     var user_name = document.getElementById("user_name").value;
                        //     var otpDiv = document.getElementById("otp_container");
                        //     var signBtn = document.getElementById("signBtn");
                            
                        //     // Get CSRF token from the cookie
                        //     var csrftoken = getCookie('csrftoken');
                    
                        //     // Example AJAX request with CSRF token included
                        //     $.ajax({
                        //         url: '/send_otp/',
                        //         type: 'POST',
                        //         data: {
                        //             'phone_number': phone_number,
                        //             'email':email,
                        //             'user_name':user_name,
                        //             'csrfmiddlewaretoken': csrftoken  // Include the CSRF token in the data
                        //         },
                        //         success: function(response) {
                        //             if (response.success === true) {
                        //                 // If the response is success, submit the form
                        //                 console.log("hii")
                        //                 document.getElementById("otpmessage").innerText = "Otp send successfully"
                        //                 var errorButton = document.getElementById('errorButtons');
                        //                 errorButton.classList.remove('d-none');
                        //                 var errorMessage = document.getElementById('errorMessageContainers');
                        //                 errorMessage.innerHTML = response.message;
                        //                 errorButton.click();
                        //                 otpDiv.style.display = "block";
                        //                 signBtn.style.display = "none"
                        //                 timer(180);
                        //             } else {
                        //                 var errorButton = document.getElementById('errorButtons');
                        //                 errorButton.classList.remove('d-none');
                        //                 var errorMessage = document.getElementById('errorMessageContainers');
                        //                 errorMessage.innerHTML = response.message;
                        //                 errorButton.click();
                        //                 otpDiv.style.display = "none";
                        //                 signBtn.style.display = "block"
                        //             }
                        //         }
                        //     });
                        // }
                    </script>
                     <script>
                        function sendOTP() {
                            // Send AJAX request to server to send OTP to the provided phone number
                            var phone_number = document.getElementById("phone_number").value;
                            var email = document.getElementById("Email").value;
                            var user_name = document.getElementById("user_name").value;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signBtn");
                            
                            // Get CSRF token from the cookie
                            var csrftoken = getCookie('csrftoken');
                    
                            // Example AJAX request with CSRF token included
                            $.ajax({
                                url: '/send_otp/',
                                type: 'POST',
                                data: {
                                    'phone_number': phone_number,
                                    'email':email,
                                    'user_name':user_name,
                                    'csrfmiddlewaretoken': csrftoken  // Include the CSRF token in the data
                                },
                                success: function(response) {
                                    if (response.success === true) {
                                        // If the response is success, submit the for
                                        otpDiv.style.display = "block";
                                        signBtn.style.display = "none"
                                        var expirationTime = new Date();
                                        expirationTime.setSeconds(expirationTime.getSeconds() + 180); // Assuming expiration time is 180 seconds
                                        localStorage.setItem('expirationTime', expirationTime.getTime());

                                        timer();
                                    } else {
                                        var errorButton = document.getElementById('errorButtons');
                                        errorButton.click();
                                        otpDiv.style.display = "none";
                                        signBtn.style.display = "block"
                                    }
                                }
                            });
                        }
                
                
                        // Function to get CSRF token from the cookie
                        function getCookie(name) {
                            var cookieValue = null;
                            if (document.cookie && document.cookie !== '') {
                                var cookies = document.cookie.split(';');
                                for (var i = 0; i < cookies.length; i++) {
                                    var cookie = cookies[i].trim();
                                    // Check if the cookie name matches the requested name
                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                        // Extract and decode the CSRF token
                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                        break;
                                    }
                                }
                            }
                            return cookieValue;
                        }
                        
                        var otpDiv = document.getElementById("otp_container");
                        var signBtn = document.getElementById("signBtn");

                        function timer() {
                            var expirationTime = localStorage.getItem('expirationTime');

                            if (!expirationTime) return;

                            function updateTimer() {
                                var currentTime = new Date().getTime();
                                var remainingTime = Math.max(0, Math.floor((expirationTime - currentTime) / 1000));

                                var m = Math.floor(remainingTime / 60);
                                var s = remainingTime % 60;

                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timer').innerHTML = m + ':' + s;

                                if (remainingTime > 0) {
                                    setTimeout(updateTimer, 1000);
                                } else {
                                    // Handle timeout
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "block";
                                    signBtn.innerHTML = "Resend OTP";
                                }
                            }

                            updateTimer();
                        }

                        // Call timers() on page load to resume timer if expirationTime is stored
                        // timer();
                    </script>  
                    <script>
                        const inputs = document.querySelectorAll(".otp-field > input");
                        const button = document.querySelector(".verify_btn");
                
                        window.addEventListener("load", () => inputs[0].focus());
                        button.setAttribute("disabled", "disabled");
                
                        inputs[0].addEventListener("paste", function (event) {
                        event.preventDefault();
                
                        const pastedValue = (event.clipboardData || window.clipboardData).getData(
                            "text"
                        );
                        const otpLength = inputs.length;
                
                        for (let i = 0; i < otpLength; i++) {
                            if (i < pastedValue.length) {
                            inputs[i].value = pastedValue[i];
                            inputs[i].removeAttribute("disabled");
                            inputs[i].focus;
                            } else {
                            inputs[i].value = ""; // Clear any remaining inputs
                            inputs[i].focus;
                            }
                        }
                        });
                
                        inputs.forEach((input, index1) => {
                        input.addEventListener("keyup", (e) => {
                            const currentInput = input;
                            const nextInput = input.nextElementSibling;
                            const prevInput = input.previousElementSibling;
                
                            if (currentInput.value.length > 1) {
                            currentInput.value = "";
                            return;
                            }
                
                            if (
                            nextInput &&
                            nextInput.hasAttribute("disabled") &&
                            currentInput.value !== ""
                            ) {
                            nextInput.removeAttribute("disabled");
                            nextInput.focus();
                            }
                
                            if (e.key === "Backspace") {
                            inputs.forEach((input, index2) => {
                                if (index1 <= index2 && prevInput) {
                                input.setAttribute("disabled", true);
                                input.value = "";
                                prevInput.focus();
                                }
                            });
                            }
                
                            button.classList.remove("active");
                            button.setAttribute("disabled", "disabled");
                
                            const inputsNo = inputs.length;
                            if (!inputs[inputsNo - 1].disabled && inputs[inputsNo - 1].value !== "") {
                            button.classList.add("active");
                            button.removeAttribute("disabled");
                
                            return;
                            }
                        });
                        });
                    </script>  
                    </section>
            </div>
        </div>
        </div>
    </div>   
    
    <!-- LOGIN POPUP -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container">
                            <form class="col-md-12 mt-2" id="signup_container">
                                {% csrf_token %}
                                <button type="button" class="btn btn-primary d-none" id="errorButton" data-bs-toggle="modal" data-bs-target="#exampleModal" style="display: none;">
                                    Error Message
                                </button>
                                
                                <div class="modal fade container" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog ">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Error Message</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <span id="errorMessageContainer"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Container for the error message -->
                                <div id="errorContainer" style="display: none;">
                                    {{ error }}
                                </div>
                                
                                <script>
                                    // Function to check for error condition and display error message
                                    function checkForError() {
                                        var errorExists = document.getElementById('errorContainer').innerText.trim() !== ''; // Check if error exists based on the content of errorContainer
                                
                                        if (errorExists) {
                                            var errorButton = document.getElementById('errorButton');
                                            errorButton.classList.remove('d-none');
                                            var errorMessage = document.getElementById('errorMessageContainer');
                                            errorMessage.innerHTML = document.getElementById('errorContainer').innerHTML;
                                            errorButton.click(); // Trigger click event to show the modal
                                        }
                                    }
                                
                                    // Call the function to check for error on page load
                                    checkForError();
                                </script>
                                <div class="mt-2" id="sign_head_div">
                                    <div class=" d-flex justify-content-between">
                                        <h4 class="signup_text">Welcome Back</h4>
                                        <button type="button" class="close" style="border: none;background: none;font-size: 25px;" data-dismiss="modal" aria-label="Close" id="SignClose">
                                            <span aria-hidden="true">&times;</span>
                                            </button>
                                    </div>
                                    <div>
                                        <p class="sign_utext">Please enter your contact details to connect..</p>
                                    </div>
                                </div>
                                <div class="input_div mt-5">
                                    <label for="email">Email Or Phone Number</label><span class="error" id="emailError2"></span>
                                    <input type="text" class="mt-4 input_login email2" placeholder="Email or Phone Number" name="email_or_phone" id="email_or_phone">
                                </div>
                                <div class="mt-4">
                                    <label for="email">Password</label><span class="error" id="passwordError2"></span>
                                    <input type="password" class="input_login  password2 mt-4" name="password" id="signpassword" placeholder="Enter Password">
                                </div>
                                <div class="mt-5" id="checkbox_div">
                                    <div class="d-flex justify-content-between">
                                        <div class="d-flex">
                                            <input type="checkbox" class="checkbox2" style="width: 19px;height: 19px">
                                            <p class="mb-0 check_text">Remember Me</p>
                                        </div>
                                        <div>
                                            <a href="#" onclick="forgetpassword()" class="check_text">Forget Password?</a>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="error" id="checkboxError2"></span>
                                    </div>
                                </div>
                                <div class="mt-2 btn_div">
                                    <button class="sign_btn" onclick="validateFormPopup()" type="button">Log In</button>
                                </div>
                                <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Dont have an account ?</p> &nbsp
                                    <button type="button" onclick="linklogin()" class="lg_btn" style="border: none;background: none;text-decoration: underline">Sign Up Here</button>
                                </div>
                                <script>
                                    function linklogin(){
                                        $("#SignClose").click();
                                        $("#signup-btn").click();
                                    }
                                    function forgetpassword(){
                                        $("#SignClose").click();
                                        $("#forgotpassword").click();
                                    }
                                </script>
                            </form>
                        </div>
                        <script>
                            // Get references to the popup and the Ok button
                            var errorPopup = document.getElementById("errorPopup");
                            var okButton = document.getElementById("okButton");
                            
                            // Add event listener to the Ok button
                            okButton.addEventListener("click", function() {
                                // Hide the popup
                                errorPopup.style.display = "none";
                            });
                        </script>
                        <script>
                            function validateFormPopup() {
                                var valid = true;
                        
                                document.getElementById('emailError2').innerText = '';
                                document.getElementById('passwordError2').innerText = '';
                                document.getElementById('checkboxError2').innerText = '';
                        
                                var emailInput = document.querySelector('.email2');
                                var passwordInput = document.querySelector('.password2');
                                var checkboxInput = document.querySelector('.checkbox2');
                        
                                var email = emailInput.value;
                                var password = passwordInput.value;
                                var rememberMe = checkboxInput.checked;
                        
                                var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                                var phonePattern = /^\d{10}$/;
                                if (email.trim() === '') {
                                    document.getElementById('emailError2').innerText = 'Email is required';
                                    emailInput.style.border = '1px solid red';
                                    valid = false;
                                }  else if (!emailPattern.test(email) && !phonePattern.test(email)) {
                                    document.getElementById('emailError2').innerText = 'Invalid email address or phone number';
                                    emailInput.style.border = '1px solid red';
                                    valid = false;
                                } else {
                                    emailInput.style.border = ''; // Reset border style if valid
                                }
                        
                                // Password validation
                                if (password.trim() === "") {
                                    document.getElementById('passwordError2').innerText = "Password is required";
                                    passwordInput.style.border = '1px solid red';
                                    valid = false;
                                } else if (password.length < 6) {
                                    document.getElementById('passwordError2').innerText = "Password must be at least 6 characters long";
                                    passwordInput.style.border = '1px solid red';
                                    valid = false;
                                } else {
                                    passwordInput.style.border = '';
                                }
                        
                                if (!rememberMe) {
                                    document.getElementById('checkboxError2').innerText = "Please check 'Remember Me'";
                                    valid = false;
                                }

                                
                                if (valid) {
                                    // If form is valid, call submitLogForms() function
                                    submitLogForms();
                                }
                        
                                return valid;
                            }

                            function submitLogForms() {
                                // Retrieve form values
                                var email_or_phone = $("#email_or_phone").val();
                                var password = $("#signpassword").val();

                                var csrftoken = getCookie('csrftoken');

                                // AJAX request
                                $.ajax({
                                    type: "POST",
                                    url: "/login_views/",
                                    headers: {
                                            'X-CSRFToken': csrftoken
                                    },
                                    data: {
                                        email_or_phone: email_or_phone,
                                        password: password,
                                    },
                                    success: function(response) {
                                        // Handle success response
                                        console.log(response);
                                        if (response.success === true) {
                                            // If the response is success, submit the form
                                            $("#SignClose").click();
                                           console.log(response.email)
                                           console.log(response.phone_number)
                                           console.log(response.username)
                                        //    document.getElementById('log-btn').style.display = 'none';
                                        //     document.getElementById('logProfile').style.display = 'block';
                                            // document.getElementById("mblNumber").innerHTML = response.username;
                                        //    document.getElementById('hiddenEmail').value = response.email;
                                        //     document.getElementById('hiddenPhoneNumber').value = response.phone_number;
                                        //     document.getElementById('hiddenUsername').value = response.username;
                                            window.location.reload();
                                        } else {
                                            console.log("success")
                                            $("#SignClose").click();
                                            var errorMessage = document.getElementById('errorMessageContainer');
                                            errorMessage.innerHTML = response.error_message;
                                            $("#errorButtons").click();
                                        }
                                    },
                                    error: function(xhr, status, error) {
                                        // Handle error
                                        console.error(xhr.responseText);
                                    }
                                });
                            }
                        </script>
                        <script>
                            $(document).ready(function() {
                                var emailData = $("#hiddenEmail").val();
                                var phoneData = $("#hiddenPhoneNumber").val();
                                var usernameData = $("#hiddenUsername").val();
                                var logProfilePic = $("#logProfile");
                                var logbtnShow = $("#log-btn");
                        
                                // Check if emailData, phoneData, and usernameData are null or undefined
                                if (!emailData && !phoneData && !usernameData) {
                                    logbtnShow.show();
                                } else {
                                    logProfilePic.show();
                                    logbtnShow.hide();
                                }
                            });
                        </script>
                                
                        <style>
                        
                            /* body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            }  */
                    
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                            #image_container {
                                background:url("{% static 'images/image login.png' %}");
                                background-size: contain;
                                background-position: center center;
                                background-repeat: no-repeat;
                                /* background-attachment: fixed;
                                -webkit-background-size: cover; */
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }

                            .modal-header {
                                border-bottom: none !important;
                            }

                            .modal-content {
                                border-radius: 12px !important;
                            }
                    
                            /* .container-fluid { */
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            /* } */
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            /* #signup_container {
                                padding: 20px 30px;
                            }
                    */
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 32px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            label {
                                font-size: 16px;
                                color: rgba(43, 43, 43, 1);
                                font-weight: 600;
                            }
                    
                            .input_login {
                                border-radius: 8px !important;
                                padding: 13px 18px !important;
                                font-size: 15px !important;
                                font-weight: 500 !important;
                                color: rgba(43, 43, 43, 0.5) !important;
                                border: 1px solid rgba(43, 43, 43, 1) !important;
                                width: 100% !important;
                                margin: 2px !important;
                                height: auto !important;
                            }
                    
                            /* .input_login ::placeholder {
                                font-weight: 400  !important;
                                color:rgba(23, 52, 73, 0.61) !important;
                                font-size: 15px !important;
                            } */
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                    
                        </style>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <!-- INPUT SECTION -->
    <section id="input-sec" class="container-fluid">
        <form class="container inp_con" method="get" action="{% url 'hotellist' %}" onsubmit="return validateForm()">
            <!-- <form class="container inp-row" method="get" action="{% url 'hotellist' %}?city_name={{ nationality|urlize }}&city_id={{ cityid|urlize }}&country_code={{ countrycode|urlize }}&check-in={{ formatted_check_in_date|urlize }}&check-out={{ formatted_check_out_date|urlize }}&nation={{ nationality|urlize }}&roomInfoInput={{ personsdetails|urlize }}&totalRoomInfoInput={{ totalroom|urlize }}"> -->
            {% csrf_token %}
            <div class=" inp_div d-flex">
                <div class="inp-row col-md-10 justify-content-between p-3">
                    <div class="col-md-2 inp">
                        <label for="landmark">Landmark</label>
                        <div class="control-group ">
                            <div class="controls bootstrap-timepicker">
                                <input type="text" id="autocompleteInput" class="mt-2 input des" placeholder="Enter The Name, City, Landmark" style="font-size: 14px;" value= "{{ citytitle }}" name="cityname">
                                <input type="hidden" id="cityIdInput" name="city_id" value="{{cityid}}">
                                <input type="hidden" id="countryCodeInput" name="country_code" value="{{countrycode}}">
                                <i class="icon-time"></i>
                                <script>
                                    function validateForm() {
                                            var des = document.getElementsByClassName("des")[0].value.trim();
                                            var room = document.getElementById("room").value.trim();
                                            if (des === "") {
                                                alert("Please Enter Your Destination");
                                                return false; // Prevent form submission
                                            } 
                                                if (room === "") {
                                                alert("Please Enter Room Information");
                                                return false; // Prevent form submission
                                            }

                                            return true; // Allow form submission
                                        }
                                </script>
                                <script>
                                    $(function () {
                                        $("#autocompleteInput").autocomplete({
                                            source: function (request, response) {
                                                $.ajax({
                                                    url: "/search_destinations/",
                                                    dataType: "json",
                                                    data: {
                                                        query: request.term
                                                    },
                                                    success: function (data) {
                                                        response(data.data);
                                                    }
                                                });
                                            },
                                            minLength: 2,
                                            select: function (event, ui) {
                                                // Update the hidden input fields with selected values
                                                $("#cityIdInput").val(ui.item.cityID);
                                                $("#countryCodeInput").val(ui.item.countryCode);
                                            }
                                        });
                                    });
                                </script>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 inp">
                        <label for="check-in">Check In</label>
                        <input type="text" class="check mt-2 input" data-date="" data-date-format="DD MMMM YYYY" style="font-size: 14px;" name="check-in" id="check-in" readonly>
                        <input type="hidden" value="{{formatted_check_in_date}}" id="checkin">
                    </div>
                    <div class="col-md-2 inp">
                        <label for="check-out">Check <Out></Out></label>
                        <input type="text" class="check mt-2 input" data-date="" data-date-format="DD MMMM YYYY" value="{{formatted_check_out_date}}" style="font-size: 14px;" name="check-out" id="check-out" readonly>
                        <input type="hidden" value="{{formatted_check_out_date}}" id="checkout">
                    </div>
                    <div class="col-md-2 inp">
                        <label for="Nationality">Nationality</label>
                        <select class="Nationality mt-2 select" name="nation" id="nation">
                            <option value="IN" selected>India</option>
                            <option value="AF" >Afghanistan</option>
                            <option value="AL" >Albania</option>
                            <option value="DZ" >Algeria</option>
                            <option value="AS" >American Samoa</option>
                            <option value="AD" >Andorra</option>
                            <option value="AO" >Angola</option>
                            <option value="AI" >Anguilla</option>
                            <option value="AQ" >Antarctica</option>
                            <option value="AG" >Antigua &amp; Barbuda</option>
                            <option value="AR" >Argentina</option>
                            <option value="AM" >Armenia</option>
                            <option value="AW" >Aruba</option>
                            <option value="AU" >Australia</option>
                            <option value="AT" >Austria</option>
                            <option value="AZ" >Azerbaijan</option>
                            <option value="BS" >Bahamas</option>
                            <option value="BH" >Bahrain</option>
                            <option value="BD" >Bangladesh</option>
                            <option value="BB" >Barbados</option>
                            <option value="BY" >Belarus (Belorussia)</option>
                            <option value="BE" >Belgium</option>
                            <option value="BZ" >Belize</option>
                            <option value="BJ" >Benin</option>
                            <option value="BM" >Bermuda</option>
                            <option value="BT" >Bhutan</option>
                            <option value="BO" >Bolivia</option>
                            <option value="BA" >Bosnia and Herzegowina</option>
                            <option value="BW" >Botswana</option>
                            <option value="BV" >Bouvet Islands</option>
                            <option value="BR" >Brazil</option>
                            <option value="IO" >British Indian Ocean Territory</option>
                            <option value="VG" >British Virgin Islands</option>
                            <option value="BN" >Brunei Darussalam</option>
                            <option value="BG" >Bulgaria</option>
                            <option value="BF" >Burkina Faso</option>
                            <option value="BI" >Burundi</option>
                            <option value="KH" >Cambodia</option>
                            <option value="CM" >Cameroon</option>
                            <option value="CA" >Canada</option>
                            <option value="CB" >Canada Buffer</option>
                            <option value="CV" >Cape Verde</option>
                            <option value="KY" >Cayman Islands</option>
                            <option value="CF" >Central African Republic</option>
                            <option value="TD" >Chad</option>
                            <option value="CL" >Chile</option>
                            <option value="CN" >China</option>
                            <option value="CX" >Christmas Islands</option>
                            <option value="CC" >Cocos (Keeling) Island</option>
                            <option value="CO" >Colombia</option>
                            <option value="KM" >Comoros</option>
                            <option value="CG" >Congo</option>
                            <option value="CD" >Congo (Rep. Dem.)</option>
                            <option value="CK" >Cook Islands</option>
                            <option value="CR" >Costa Rica</option>
                            <option value="HR" >Croatia</option>
                            <option value="CU" >Cuba</option>
                            <option value="CY" >Cyprus</option>
                            <option value="CZ" >Czech Republic</option>
                            <option value="DK" >Denmark</option>
                            <option value="DJ" >Djibouti</option>
                            <option value="DO" >Dominican Republic</option>
                            <option value="DM" >Dominicana</option>
                            <option value="TP" >East Timor</option>
                            <option value="EC" >Ecuador</option>
                            <option value="EG" >Egypt</option>
                            <option value="SV" >El Salvador</option>
                            <option value="GQ" >Equatorial Guinea</option>
                            <option value="ER" >Eritrea</option>
                            <option value="EE" >Estonia</option>
                            <option value="ET" >Ethiopia</option>
                            <option value="EU" >European Monetary Union</option>
                            <option value="FK" >Falkland Islands</option>
                            <option value="FO" >Faroe Islands</option>
                            <option value="FJ" >Fiji Islands</option>
                            <option value="FI" >Finland</option>
                            <option value="FR" >France</option>
                            <option value="GF" >French Guiana</option>
                            <option value="PF" >French Polynesia</option>
                            <option value="TF" >French Southern Territories</option>
                            <option value="GA" >Gabon</option>
                            <option value="GM" >Gambia</option>
                            <option value="GE" >Georgia</option>
                            <option value="DE" >Germany</option>
                            <option value="GH" >Ghana</option>
                            <option value="GI" >Gibralter</option>
                            <option value="GR" >Greece</option>
                            <option value="GL" >Greenland</option>
                            <option value="GD" >Grenada</option>
                            <option value="GP" >Guadeloupe</option>
                            <option value="GU" >Guam</option>
                            <option value="GT" >Guatemala</option>
                            <option value="GN" >Guinea</option>
                            <option value="GW" >Guinea-Bissau</option>
                            <option value="GY" >Guyana</option>
                            <option value="HT" >Haiti</option>
                            <option value="HM" >Heard &amp; Mcdonald Islands</option>
                            <option value="HN" >Honduras</option>
                            <option value="HK" >Hong kong</option>
                            <option value="HU" >Hungary</option>
                            <option value="IS" >Iceland</option>
                            <option value="ID" >Indonesia</option>
                            <option value="IR" >Iran</option>
                            <option value="IQ" >Iraq</option>
                            <option value="IE" >Ireland</option>
                            <option value="IL" >Israel</option>
                            <option value="IT" >Italy</option>
                            <option value="CI" >Ivory Coast</option>
                            <option value="JM" >Jamaica</option>
                            <option value="JP" >Japan</option>
                            <option value="JO" >Jordan</option>
                            <option value="KZ" >Kazakhstan</option>
                            <option value="KE" >Kenya</option>
                            <option value="KI" >Kiribati</option>
                            <option value="KP" >Korea (Democratic People's Republic Of)</option>
                            <option value="KW" >Kuwait</option>
                            <option value="KG" >Kyrgyzstan</option>
                            <option value="LA" >Lao People's Democratic Republic</option>
                            <option value="LV" >Latvia</option>
                            <option value="LB" >Lebanon</option>
                            <option value="LS" >Lesotho</option>
                            <option value="LR" >Liberia</option>
                            <option value="LY" >Libyan Arab Jamahiriya</option>
                            <option value="LI" >Liechtenstein</option>
                            <option value="LT" >Lithuania</option>
                            <option value="QL" >Lithuania (Dummy Code)</option>
                            <option value="LU" >Luxembourg</option>
                            <option value="MO" >Macau</option>
                            <option value="MK" >Macedonia</option>
                            <option value="MG" >Madagascar</option>
                            <option value="MW" >Malawi</option>
                            <option value="MY" >Malaysia</option>
                            <option value="MV" >Maldives</option>
                            <option value="ML" >Mali</option>
                            <option value="MT" >Malta</option>
                            <option value="MH" >Marshall Islands</option>
                            <option value="MQ" >Martinique</option>
                            <option value="MR" >Mauritania</option>
                            <option value="MU" >Mauritius</option>
                            <option value="YT" >Mayotte</option>
                            <option value="MX" >Mexico</option>
                            <option value="MB" >Mexico Buffer</option>
                            <option value="FM" >Micronesia</option>
                            <option value="MD" >Moldova</option>
                            <option value="MC" >Monaco</option>
                            <option value="MN" >Mongolia</option>
                            <option value="MS" >Montserrat</option>
                            <option value="MA" >Morocco</option>
                            <option value="MZ" >Mozambique</option>
                            <option value="MM" >Myanmar</option>
                            <option value="NA" >Namibia</option>
                            <option value="NR" >Nauru</option>
                            <option value="NP" >Nepal</option>
                            <option value="NL" >Netherlands</option>
                            <option value="AN" >Netherlands Antilles</option>
                            <option value="NC" >New Caledonia</option>
                            <option value="NZ" >New Zealand</option>
                            <option value="NI" >Nicaragua</option>
                            <option value="NE" >Niger</option>
                            <option value="NG" >Nigeria</option>
                            <option value="NU" >Niue</option>
                            <option value="NF" >Norfolk Islands</option>
                            <option value="MP" >Northern Mariana Islands</option>
                            <option value="NO" >Norway</option>
                            <option value="OM" >Oman</option>
                            <option value="PK" >Pakistan</option>
                            <option value="PW" >Palau</option>
                            <option value="PS" >Palestinian Occ. Territories</option>
                            <option value="PA" >Panama</option>
                            <option value="PG" >Papua New Guinea</option>
                            <option value="PY" >Paraguay</option>
                            <option value="PE" >Peru</option>
                            <option value="PH" >Philippines</option>
                            <option value="PL" >Poland</option>
                            <option value="PT" >Portugal</option>
                            <option value="PR" >Puerto Rico</option>
                            <option value="QA" >Qatar</option>
                            <option value="RE" >Reunion</option>
                            <option value="RO" >Romania</option>
                            <option value="RW" >Ruanda</option>
                            <option value="RU" >Russian Federation</option>
                            <option value="LC" >Saint Lucia</option>
                            <option value="WS" >Samoa</option>
                            <option value="SM" >San Marino</option>
                            <option value="ST" >Sao Tome &amp; Principe</option>
                            <option value="SA" >Saudi Arabia</option>
                            <option value="SN" >Senegal</option>
                            <option value="SC" >Seychelles</option>
                            <option value="SL" >Sierra Leone</option>
                            <option value="SG" >Singapore</option>
                            <option value="SK" >Slovakia</option>
                            <option value="SI" >Slovenia</option>
                            <option value="SB" >Solomon Islands</option>
                            <option value="SO" >Somalia</option>
                            <option value="ZA" >South Africa</option>
                            <option value="GS" >South Georgia &amp; South Sandwich</option>
                            <option value="KR" >South Korea</option>
                            <option value="SU" >Soviet Union</option>
                            <option value="ES" >Spain</option>
                            <option value="LK" >Sri Lanka</option>
                            <option value="SH" >St. Helena</option>
                            <option value="KN" >St. Kitts and Nevis</option>
                            <option value="PM" >St. Pierre &amp; Miquelon</option>
                            <option value="VC" >St. Vincent &amp; the Grenadines</option>
                            <option value="SD" >Sudan</option>
                            <option value="SR" >Suriname</option>
                            <option value="SJ" >Svalbard &amp; Jan Mayen Islands</option>
                            <option value="SZ" >Swaziland</option>
                            <option value="SE" >Sweden</option>
                            <option value="CH" >Switzerland</option>
                            <option value="SY" >Syrian Arab Republic</option>
                            <option value="TW" >Taiwan</option>
                            <option value="TJ" >Tajikistan</option>
                            <option value="TZ" >Tanzania</option>
                            <option value="TH" >Thailand</option>
                            <option value="TG" >Togo</option>
                            <option value="TK" >Tokelau</option>
                            <option value="TO" >Tonga</option>
                            <option value="TT" >Trinidad and Tobago</option>
                            <option value="TN" >Tunisia</option>
                            <option value="TC" >Turcs &amp; Caicos Islands</option>
                            <option value="TR" >Turkey</option>
                            <option value="TM" >Turkmenistan</option>
                            <option value="TV" >Tuvalu</option>
                            <option value="UM" >U.S. Minor Outlaying Islands</option>
                            <option value="UG" >Uganda</option>
                            <option value="UA" >Ukraine</option>
                            <option value="AE" >United Arab Emirates</option>
                            <option value="GB" >United Kingdom</option>
                            <option value="UY" >Uruguay</option>
                            <option value="US" >USA</option>
                            <option value="UZ" >Uzbekistan</option>
                            <option value="VU" >Vanuatu</option>
                            <option value="VA" >Vatican City State</option>
                            <option value="VE" >Venezuela</option>
                            <option value="VN" >Vietnam</option>
                            <option value="VI" >Virgin Islands (US)</option>
                            <option value="WF" >Wallis &amp; Futuna Islands</option>
                            <option value="EH" >Western Sahara</option>
                            <option value="YE" >Yemen</option>
                            <option value="YU" >Yugoslavia</option>
                            <option value="ZM" >Zambia</option>
                            <option value="ZW" >Zimbabwe</option>
                        </select>
                    </div>
                    <div class="col-md-2 inp">
                        <label for="room-inp">Person& Rooms</label>
                        <input type="text" class="input mt-2" readonly id="room" placeholder="1 Room & 0 Adults" onclick="showForm()" >
                        <input type="hidden" id="roomInfoInput" name="roomInfoInput" value='{{ personsdetails }}'>
                        <input type="hidden" id="totalRoomInfoInput" name="totalRoomInfoInput" value="{{ totalroom }}">
                    </div>
                    <div class="hide-persondetails" style="display: none;">
                        <p class="rooms" id="totalRooms">{{ total_rooms }}</p>
                        <p class="adult" id="noOfAdults">{{ total_adults }}</p>
                        <p class="child" id="noOfChildren">{{ no_of_children }}</p>
                        <input type="hidden" name="roomInfoInputs" id="roomDetails" value='{{ personsdetails }}'>
                    </div>
                </div>
                <div class="search-btn col-md-2 mt-2 p-3 inp">
                    <button type="submit" class="btn btn-primary mod-btn">Modify Search</button>
                </div>
            </div>
        </form>
    </section>

    <!-- FORM SECTION -->
    <section id="form" style="position: absolute;">
        <div id="wrapper">
            <div id="form_div">
                <table class="table table-hover text-nowrap" id="attribute_table">
                    <thead>
                        <tr>
                            <th class="room-h" >Room</th>
                            <th class="room-h" >Adults</th>
                            <th class="room-h">Child</th>
                            <!-- <th class="room-h" id="childage_label" style="display: none;">Child Age</th> -->
                            <th class="room-h" id="age_1"></th>
                            <th class="room-h" id="age_2"></th>
                            <th class="room-h" id="age_3"></th>
                            <th class="room-h" id="age_4"></th>
                        </tr>
                    </thead>
                    <!-- <tr id="row1" class="room-info">
                        <td>Room1</td>
                        <td>
                            <select name='attribute_name' class='form-control attribute_name' id="adult_1" onchange="getAdultCount()">
                                <option value='0'>Select</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </td>
                        <td>
                            <select name='attribute_id' id="child_1" class='form-control attribute_value' onchange="getAdultCount()">
                                <option data-parent='0' value='0'>Select</option>
                                <option value="1">1</option>
                            </select>
                        </td>
                        <td>
                            <select name='attribute_child' id="childage_1" class='form-control attribute_value' onchange="getAdultCount()">
                                <option data-parent='0' value='0'>Select</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </td>
                    </tr> -->
                    <tr></tr>
                </table>
                <input class="btn" id="add-btn" type="button" onclick="add_attribute_row();" value="Add Room+">
                <input class="btn " id="remove-btn" type="button" onclick="del_att_row();" value="Remove Room-">
            </div>
            <button class="btn btn-primary" id="app-btn" onclick="hideForm()">Apply</button>
        </div>
    </section> 

    <!-- HOTEL SECTION -->
    <section id="hotel-sec" class="container d-flex flex-row mt-4">
        <div id="hotel-main" class="container col-md-3 mt-4">
            <div class="hotel-list row">
                <div class="filter-hv col-md-">
                    <div class="box-1">
                        <p class="a1">FILTERS</p>
                    </div>
                    <hr>
                    <div class="wrapper">
                        <h2>Price For Night</h2>
                        <div class="price-input">
                            <div class="field">
                                <label for="price"></label>
                                <input type="number" readonly class="form-control input-min" value="{{ min_price }}">
                            </div>
                            <div class="separator">-</div>
                            <div class="field">
                                <label for="price"></label>
                                <input type="number" readonly class="form-control input-max" value="{{ max_price }}">
                            </div>
                        </div>
                        <div class="slider">
                            <div class="progress"></div>
                        </div>
                        <div class="range-input">
                            <input type="range" class="form-range range-min" min="{{ min_price }}" max="{{ max_price }}" value="{{ min_price }}" step="100">
                            <input type="range" class="form-range range-max" min="{{ min_price }}" max="{{ max_price }}" value="{{ max_price }}" step="100">
                        </div>
                    </div>
                </div>
                <div class="filter-property">
                    <div class="filter-header">
                        <p class="h2">STAR RATING</p>
                    </div>
                    <div class="checklist-1">
                        <label class="form-check-label">
                            <input type="checkbox" name="checklist" value="5" class="form-check-input">
                            <div style="padding-top: 15px;padding-left: 10px;">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                            </div>
                        </label>
                        <label class="form-check-label">
                            <input type="checkbox" name="checklist" value="4" class="form-check-input">
                            <div style="padding-top: 15px;padding-left: 10px;">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star"></span>
                            </div>
                        </label>
                        <label class="form-check-label">
                            <input type="checkbox" name="checklist" value="3" class="form-check-input">
                            <div style="padding-top: 15px;padding-left: 10px;">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star"></span>
                                <span class="fa fa-star"></span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div id="hotel-info" class="container col-md-9 mt-4">
            <div id="sec-2" class="row">
                <div class="sortby-sec">
                    <div class="sort-by">
                        <p>Sort By :</p>
                    </div>    
                    <div class="checklist">
                        <button class="sb-btn" autofocus onclick="sortHotels('Name')">Hotel Name</button>
                        <button class="sb-btn" onclick="sortHotels('Rating')">Customer Rating</button>
                        <button class="sb-btn" onclick="sortHotels('Price')">Price</button>
                    </div>
                </div>
            </div>
        {% block content %}
                <div id="hotel-details" class="row">
                    <div id="hotelList">
                    {% if error_message %}
                        <p>{{ error_message }}</p>
                    {% else %}
                        {% for hotel in hotel_info %}
                            <div class="hotel" data-rating="{{ hotel.Rating }}" data-price="{{ hotel.Price }}" data-name="{{ hotel.HotelName }}">
                                <div class="hotel-div">
                                    <div class="hotel-room-sec">
                                        <div class="hotel-img">
                                            <img src={{ hotel.ImageURL }} alt="" >
                                        </div>
                                        <div class="hotel-data">
                                            <div class="hotel-name">
                                                <input type="hidden" id="{{ hotel.HotelCode }}A" value="{{ hotel.HotelName }}">
                                                <p>{{ hotel.HotelName }}</p>
                                            </div>                 
                                            <input type="hidden" id="{{ hotel.HotelCode }}_rating" value="{{ hotel.Rating }}">
                                            <div id="{{ hotel.HotelCode }}_starRating" class="hotel-star mb-0">
                                                {% for star in "12345" %}
                                                    <span class="fa fa-star {% if forloop.counter <= hotel.Rating %}checked{% else %}unchecked{% endif %}"></span>
                                                {% endfor %}
                                            </div>
                                            <div class="hotel-loc mb-0">
                                                <address>{{ hotel.Address }}</address>
                                            </div>
                                            <div class="hotel-view mt-0 mb-2">
                                                <a class="view-details-link_1" href="{% url 'your_view' %}?hotel-code={{ hotel.HotelCode }}&trace-id={{ hotel.TraceId }}&result-index={{ hotel.ResultIndex }}&token-id={{ token_id }}&total_rooms={{ total_rooms }}&CategoryId={{ hotel.CategoryId }}">View Details</a>
                                            </div>

                                        </div>
                                        <div class="price-sec mt-4">
                                            <div class="hotel-price">
                                                <p class="price">INR {{hotel.Price}}</p>
                                                <p class="pn">Per Night</p>
                                            </div>
                                            <div class="hotel-btn">
                                                <button class="btn btn-primary select-room-btn" id="{{ hotel.HotelCode }}2"
                                                data-hotel-code="{{ hotel.HotelCode }}" 
                                                data-trace-id="{{ hotel.TraceId }}" 
                                                data-result-index="{{ hotel.ResultIndex }}" 
                                                onclick="handleSelectRoom('{{ hotel.HotelCode }}', '{{ hotel.TraceId }}', '{{ hotel.ResultIndex }}','{{ token_id }}')">Select Room</button>
                                                <button type="hidden" class="btn btn-primary select-room-btn" id="{{ hotel.HotelCode }}1" onclick="hiderooms('{{ hotel.HotelCode }}')" style="display: none;">Hide Room</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="{{hotel.HotelCode}}" class="col-md-6 hotel-room" style="display: none;">
                                    <div class="hide-room1" ></div>
                                </div>
                            </div>
                        {% endfor %}
                    {% endif %}
                    </div>
                </div>
        {% endblock %}
        </div> 
    </section>

    <!-- INLINE SCRIPTS -->
    <script>

        // SLIDER RANGE FUNCTION --------------
        const rangeInput = document.querySelectorAll(".range-input input"),
        priceInput = document.querySelectorAll(".price-input input"),
        range = document.querySelector(".slider .progress");
        let priceGap = 1000;
     
        priceInput.forEach(input =>{
            input.addEventListener("input", e =>{
                let minPrice = parseInt(priceInput[0].value),
                maxPrice = parseInt(priceInput[1].value);
                
                if((maxPrice - minPrice >= priceGap) && maxPrice <= rangeInput[1].max){
                    if(e.target.className === "input-min"){
                        rangeInput[0].value = minPrice;
                        range.style.left = ((minPrice - rangeInput[0].min) / (rangeInput[0].max - rangeInput[0].min)) * 100 + "%";
                    }else{
                        rangeInput[1].value = maxPrice;
                        range.style.right = ((rangeInput[1].max - maxPrice) / (rangeInput[1].max - rangeInput[1].min)) * 100 + "%";
                    }
                }
            });
        });
    
        rangeInput.forEach(input =>{
            input.addEventListener("input", e =>{
                RangeSlider()
               
            });
        });

    $( document ).ready(function() {
        RangeSlider()
    });

    function RangeSlider() {
        let minVal = parseInt(rangeInput[0].value),
                maxVal = parseInt(rangeInput[1].value);
                filterHotelsByPrice(minVal,maxVal)
                console.log(minVal,maxVal)
                if((maxVal - minVal) < priceGap){
                    if(e.target.className === "range-min"){
                        rangeInput[0].value = Math.min(maxVal - priceGap, rangeInput[0].max);
                    }else{
                        rangeInput[1].value = Math.max(minVal + priceGap, rangeInput[1].min);
                    }
                }else{
                    priceInput[0].value = minVal;
                    priceInput[1].value = maxVal;
                    range.style.left = ((minVal - rangeInput[0].min) / (rangeInput[0].max - rangeInput[0].min)) * 100 + "%";
                    range.style.right = ((rangeInput[1].max - maxVal) / (rangeInput[1].max - rangeInput[1].min)) * 100 + "%";
                }

    }
    //Book room ----
    function bookRoom() {
        var hiddenPhoneNumber = document.getElementById('hiddenPhoneNumber');
        
        if (hiddenPhoneNumber && hiddenPhoneNumber.value) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = '/hotelreview/';
            var roomJsonList = document.getElementById('hide-123').value;
            var datalist = document.getElementById('data-123').value;
            var unescapedValue = datalist.replace(/&quot;/g, '"');
            var parsedJSON = JSON.parse(unescapedValue);
            var unescapedValue1 = roomJsonList.replace(/&quot;/g, '"');
            var parsedJSON1 = JSON.parse(unescapedValue1);
            var hotelCode = parsedJSON.HotelCode; 
            var hotelId = hotelCode + 'A';
            var hotelNameInputElement = document.getElementById(hotelId);
            
            if (hotelNameInputElement) {
                var hotelName = hotelNameInputElement.value;
                var csrfToken = document.cookie.match(/csrftoken=([\w-]+)/)[1];
                var csrfTokenField = document.createElement('input');
                csrfTokenField.type = 'hidden';
                csrfTokenField.name = 'csrfmiddlewaretoken';
                csrfTokenField.value = csrfToken;
                form.appendChild(csrfTokenField);
                var roomJsonElement = document.createElement('input');
                roomJsonElement.type = 'hidden';
                roomJsonElement.name = 'roomJsonElement';
                roomJsonElement.value = JSON.stringify(parsedJSON1);
                form.appendChild(roomJsonElement);
                var hotelNameField = document.createElement('input');
                hotelNameField.type = 'hidden';
                hotelNameField.name = 'hotelName';
                hotelNameField.value = hotelName;
                form.appendChild(hotelNameField);
                var hide123Value = document.createElement('input');
                hide123Value.type = 'hidden';
                hide123Value.name = 'hide123Value';
                hide123Value.value = JSON.stringify(parsedJSON);
                form.appendChild(hide123Value);
                var categoryid1 = document.getElementById('categoryid').value;
                var categoryidField = document.createElement('input');
                categoryidField.type = 'hidden';
                categoryidField.name = 'categoryid1';
                categoryidField.value = categoryid1;
                form.appendChild(categoryidField);
                document.body.appendChild(form);
                form.submit();
            } else {
                console.error('Hotel name input element not found.');
            }
        } else {
            $("#log-btn").click();
        }
    }

    // DATE FUNCTION ---------------------------------

    $(function () {
        // Initialize Datepicker for the first date
        $("#check-in").datepicker({
        minDate: 0, // Minimum date is today
        dateFormat: 'dd MM yy', // Set the date format
        onSelect: function (dateText, inst) {
            // Update the data-date attribute using moment.js
            $(this).attr("data-date", moment(dateText, "DD MMMM YYYY").format($(this).attr("data-date-format")));

            // Calculate the next date using moment.js
            var nextDate = moment(dateText, "DD MMMM YYYY").add(1, 'days').format("DD MMMM YYYY");

            // Set the default date for the second datepicker to one day after the selected date
            $("#check-out").datepicker("option", "minDate", nextDate);
            $("#check-out").datepicker("setDate", nextDate);
        }
        });

        // Initialize Datepicker for the second date
        $("#check-out").datepicker({
        minDate: 1, // Minimum date is one day after today
        dateFormat: 'dd MM yy', // Set the date format
        });

        // Set the default date to today for the first datepicker
        $("#check-in").datepicker("setDate", new Date());

        // Set the default date for the second datepicker to one day after today
        var nextDefaultDate = moment().add(1, 'days').format("DD MMMM YYYY");
        $("#check-out").val(nextDefaultDate);

        var $datepicker = $('#check-in');
        $datepicker.datepicker();
        var checkinValue = $("#checkin").val();
        console.log(checkinValue)

        // Set the datepicker's date using the retrieved value
        $datepicker.datepicker('setDate', checkinValue);

        var $datepicker = $('#check-out');
        $datepicker.datepicker();
        var checkOutValue = $("#checkout").val();
        console.log(checkOutValue)

        // Set the datepicker's date using the retrieved value
        $datepicker.datepicker('setDate', checkOutValue);

    });

    // LOADER FUNCTION -----------------------------

    var loader =  document.getElementById("preloader")
        window.addEventListener("load", function() {
            loader.style.display="none"
        })

    // PAGE SHOW FUNCTION -----------------------------

    window.addEventListener('pageshow', function(event) {
            // Check if the page is being shown from the bfcache (back-forward cache)
            if (event.persisted) {
                // Reload the page
                window.location.reload();
            }
        });

    // FORM ROOM VALUE FUNCTIONS -----------------------

    $(document).ready(function() {
        var roomDetails = JSON.parse($("#roomDetails").val());
        var roomsCount = roomDetails.length;
        var html = "";

        for (var i = 1; i <= roomsCount; i++) { 
            html += "<tr id='row" + i + "' class='room-info'>";
            html += "<td class='room_no'>Room" + i + "</td>"; 
            html += "<td>";
            html += "<select name='attribute_name' class='selectbox_form attribute_name' id='adult_" + i + "' onchange='getAdultCount()'>";
            html += "<option value='1'>1</option>";
            html += "<option value='2'>2</option>";
            html += "<option value='3'>3</option>";
            html += "<option value='4'>4</option>";
            html += "<option value='5'>5</option>";
            html += "<option value='6'>6</option>";
            html += "</select>";
            html += "</td>";
            html += "<td>";
            html += "<select name='attribute_id' id='child_" + i + "' class='selectbox_form attribute_value' onchange='updateChildAges(" + i + ");getAdultCount()'>";
            html += "<option data-parent='0' value='0'>Select</option>";
            html += "<option value='1'>1</option>";
            html += "<option value='2'>2</option>";
            html += "<option value='3'>3</option>";
            html += "<option value='4'>4</option>";
            html += "</select>";
            html += "</td>";

            // Initially hide all child age select tags
            for (var j = 1; j <= 4; j++) {
                html += "<td>";
                html += "<select name='attribute_child' id='childage_" + i + "_" + j + "' class='selectbox_form attribute_value' style='display: none' onchange='getAdultCount()'>";
                // html += "<option data-parent='0'>Select</option>";
                for (var age = 1; age <= 12; age++) {
                    html += "<option value='" + age + "'>" + age + "</option>";
                }
                html += "</select>";
                html += "</td>";
            }

            html += "</tr>";
        }

        $("#attribute_table").append(html);

        // Set values for adult and child selects
        $.each(roomDetails, function(i, item) {
            $("#adult_" + (i + 1)).val(item.NoOfAdults);
            $("#child_" + (i + 1)).val(item.NoOfChild);
            
            var childAges = item.ChildAge;
            for (var j = 0; j < childAges.length; j++) {
                $("#childage_" + (i + 1) + "_" + (j + 1)).val(childAges[j]);
            }

            // Show child age select tags up to the selected child count
            for (var k = 1; k <= item.NoOfChild; k++) {
                $("#childage_" + (i + 1) + "_" + k).show();
                document.getElementById("age_"+k).innerHTML = "Age "+ k;
            }
        });
    });

    function updateChildAges(roomIndex) {
        var childCount = $("#child_" + roomIndex).val();
        for (var i = 1; i <= 4; i++) {
            if (i <= childCount) {
                $("#childage_" + roomIndex + "_" + i).show();
            } else {
                $("#childage_" + roomIndex + "_" + i).hide();
            }
        }
    }


    //  ROOM INPUT SHOW VALUE FUNCTIONS

    //  let searchParams = new URLSearchParams(window.location.search)
        // let param = searchParams.get('totalNoOfRooms');
        var jsonData2 = {"TotalRooms": `{{ total_rooms }}`};
        var jsonData = {"TotalAdults": `{{ total_adults }}`};
        
        var totalRoomsValue = jsonData2.TotalRooms;
        var totalAdultsValue = jsonData.TotalAdults;

        var roomElement = document.getElementById('totalRooms');
        var adultElement = document.getElementById('noOfAdults');
        var roomInput = document.getElementById('room');

        if (roomElement && adultElement && roomInput) {
            roomInput.value = totalRoomsValue + " Room " + " " + "&" +" " + totalAdultsValue + " Adults";
        }

        
        function filterHotelsByRating() {
            var selectedRatings = [];
            // Iterate over checked star rating checkboxes
            $('input[name="checklist"]:checked').each(function () {
                selectedRatings.push($(this).val());
            });

            $(".hotel").each(function () {
                var hotelRating = parseInt($(this).data("rating"));

                // Show the hotel if it matches any of the selected ratings, or if no ratings are selected
                if (selectedRatings.length === 0 || selectedRatings.includes(hotelRating.toString())) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        }

        // Attach the filter function to the checkbox change event
        $('input[name="checklist"]').on("change", function () {
            filterHotelsByRating();
        });

        function getAdultCount() {
            $rowno = $("#attribute_table tr").length-2
            totaladult=0
            totalchild=0
            roominfo=[]
            totalroominf0=[]

            for(i=1;i<=$rowno;i++) {
                totaladult=parseInt(totaladult) + parseInt($("#adult_"+i).val())
                totalchild=parseInt(totalchild) + parseInt($("#child_"+i).val())
                // var childAge = parseInt($("#child_"+i).val()) !== 0 ? [parseInt($("#childage_"+i).val())] : null;
                
                // Handle the first row separately
                // var childrenCountFirstRow = parseInt($("#child_1").val());
                // var childAgeFirstRow = [];

                // for (var k = 1; k <= childrenCountFirstRow; k++) {
                //     var ageFirstRow = parseInt($("#childage_" + k).val());
                //     if (!isNaN(ageFirstRow)) {
                //         childAgeFirstRow.push(ageFirstRow);
                //     }
                // }

                // roominfo[0] = {
                //     "NoOfAdults": parseInt($("#adult_1").val()),
                //     "NoOfChild": parseInt($("#child_1").val()),
                //     "ChildAge": childAgeFirstRow
                // };
                

                var childrenCount = parseInt($("#child_" + i).val());
                var childAge = [];

                for (var j = 1; j <= childrenCount; j++) {
                document.getElementById("age_"+j).innerHTML = "Age "+ j;
                var age = parseInt($("#childage_" + i + "_" + j).val());
                if (!isNaN(age)) {
                    childAge.push(age);
                }
              
            }
    
                roominfo[i-1]={"NoOfAdults":parseInt($("#adult_"+i).val()) ,"NoOfChild":parseInt($("#child_"+i).val()),"ChildAge":childAge }
                

                // roominfo[i-1]={"NoOfAdults":parseInt($("#adult_"+i).val()) ,"NoOfChild": parseInt($("#child_"+i).val()),"ChildAge": childAge }
            }

            var roomCount = $rowno + " " + "Room" +" " + "&" + " " + totaladult +" " + "Adults";
            document.getElementById('room').value = roomCount;
            
            showChildAgeSelectors()

            // console.log($rowno,totaladult,totalchild)
            totalroominf0={"TotalRooms":$rowno,"NoOfAdults":totaladult,"NoOfChild":totalchild}
            console.log(roominfo,totalroominf0)
            console.log(totalroominf0)

            document.getElementById('roomInfoInput').value = JSON.stringify(roominfo);
            document.getElementById('totalRoomInfoInput').value = JSON.stringify(totalroominf0);
            document.getElementById('totalNoOfRooms').value = $rowno;

            // document.getElementById('roomInfoInput').value = JSON.stringify(roominfo);
            // document.getElementById('totalRoomInfoInput').value = JSON.stringify({
            //     "TotalRooms": $rowno,


            };

            function showChildAgeSelectors() {
            // Hide all child age selectors first
            $("[id^=childage_]").hide();
            $("[id^=age_]").hide();

            // Get the number of children selected in the first row
            var childrenCountFirstRow = parseInt($("#child_1").val());

            // Show the corresponding child age selectors in the first row
            for (var i = 1; i <= childrenCountFirstRow; i++) {
                $("#childage_" + i).show();
                $("#age_" + i).show();
            }
            

            // Iterate through each dynamically added row
            $("#attribute_table tr").each(function(index, row) {
                var rowNumber = index + 1;
                var childrenCount = parseInt($("#child_" + rowNumber).val());

                // Show the corresponding child age selectors for each dynamically added row
                for (var i = 1; i <= childrenCount; i++) {
                    $("#childage_" + rowNumber + "_" + i).show();
                    $("#age_" + i).show();
                }
            });
        }
   

    </script>

    <script>
        $(document).ready(function() {
            var emailData = $("#hiddenEmail").val();
            var phoneData = $("#hiddenPhoneNumber").val();
            var usernameData = $("#hiddenUsername").val();
            var logProfilePic = $("#logProfile");
            var logbtnShow = $("#log-btn");
            var usernameShow = $("#mblNumber");

            // Check if emailData, phoneData, and usernameData are null or undefined
            if (!emailData && !phoneData && !usernameData) {
                logbtnShow.show();
            } else {
                logProfilePic.show();
                logbtnShow.hide();
                usernameShow.html(usernameData);
            }
        });
    </script>
    <script type="text/javascript">
        window.addEventListener('pageshow', function(event) {
            var historyTraversal = event.persisted || (typeof window.performance != 'undefined' && window.performance.navigation.type === 2);
            if (historyTraversal) {
                // Reload the page if navigating back
                window.location.reload();
            }
        });
    </script>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script> -->

    <style>
        #loading {
            background: url("{% static 'image/booking/loading.gif'%}") no-repeat center center;
            width: 100%;
            height: 15px;
            align-items: center;
            justify-content: center;
            /* position: absolute;
            top: 20%;
            left: 0;
            height: 100%;
            width: 100%;
            z-index: 0; */
        }

        #form {
            /* margin: -25px 10px 10px 650px; */
            background:  rgba(255, 255, 255, 1);
            /* width: 330px; */
            padding: 10px;
            height: auto;
            box-shadow: 5px 5px 12px grey;
            border-radius: 10px;
            justify-content: center;
            align-items: center;
            display: none;
        }

        .table>:not(caption)>*>* {
                padding: 4px !important;
            }




        /* #form select {
            font-size: 13px;
        } */

        .selectbox_form {
            width: 70px;
            padding:6px 4px;
            border-radius: 8px;
            font-size: 12px;
        }

        .sb-btn {
            color: black !important;
            /* border: 1px solid white; */
            background-color: white !important;
            border-radius: 12px;
            margin: 2px;
            padding: 4px 6px;
            font-size: 13px;
        }

        .sb-btn:hover {
            opacity: 60% !important;
        }

        .sb-btn:focus {
            opacity: 60% !important;
        }

        .sb-btn:visited {
            opacity: 60% !important;
        }

        @media only screen and (max-width: 768px) {
            .sb-btn {
            border-radius: 12px;
            margin: 2px;
            padding: 4px;
            font-size: 10px;
        }

        #form select {
                font-size: 10px;
            }

            .table>:not(caption)>*>* {
                padding: 4px !important;
            }

            .selectbox_form {
                width: 40px;
                padding: 4px;
                border-radius: 8px;
            }

            .room-h {
                font-size: 14px;
            }

            .room_no {
                font-size: 13px;
            }
        }

                   
 #form {
    margin: -50px 20px 20px 850px;
    /* Media query for screens up to 500px */
    @media only screen and (min-width: 400px) and (max-width: 500px) {
        margin: -100px 20px 4px;
        padding: 6px;
    }

    /* Media query for screens up to 700px */
    @media only screen and (min-width: 300px) and (max-width: 400px) {
        margin: -100px 2px 10px 2px;
    }

    /* Media query for screens up to 700px */
    @media only screen and (min-width: 501px) and (max-width: 700px) {
        margin: -65px 10px 10px 100px;
    }

    /* Media query for screens up to 900px */
    @media only screen and (min-width: 701px) and (max-width: 913px) {
        margin: -65px 10px 10px 250px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 913px) and (max-width: 1100px) {
        margin: -65px 10px 10px 400px;
    }

     /* Media query for screens up to 1100px */
     @media only screen and (min-width: 1100px) and (max-width:1200px ) {
        margin: -65px 10px 10px 540px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 1100px) and (max-width:1280px ) {
        margin: -65px 10px 10px 650px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 1280px) and (max-width: 1400px) {
        margin: -65px 10px 10px 716px;
    }

}
        


    </style>
  
</body>
</html>