{% load static %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zxx">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Travelin - Travel Tour Booking HTML Templates</title>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'image/home/Magnet logo.png' %}">
    <!-- Bootstrap core CSS -->
    <link href="{% static 'css/home/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
    <!--Custom CSS-->
    <link href="{% static 'css/home/style.css' %}" rel="stylesheet" type="text/css">
    <!--Plugin CSS-->
    <link href="{% static 'css/home/plugin.css' %}" rel="stylesheet" type="text/css">

    <!--Font Awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">

    <link rel="stylesheet" href="{% static 'css/home/fonts/line-icons.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/booking/hotelviews.css' %}">
</head>

    <!-- Preloader -->
    <div id="preloader">
        <div id="status"></div>
    </div>
    <!-- Preloader Ends -->

    <!-- header starts -->
    {% include 'home/header.html' %}
    <!-- header ends -->

    <!-- BreadCrumb Starts -->  
    <section class="breadcrumb-main pb-20 pt-14" style="background-image: url(images/bg/bg1.jpg);">
        <div class="section-shape section-shape1 top-inherit bottom-0" style="background-image: url(images/shape8.png);"></div>
        <div class="breadcrumb-outer">
            <div class="container">
                <div class="breadcrumb-content text-center">
                    <h1 class="mb-3">Flight Detail</h1>
                    <nav aria-label="breadcrumb" class="d-block">
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Flight Detail</li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <div class="dot-overlay"></div>
    </section>
    <!-- BreadCrumb Ends --> 

    <!-- top Destination starts -->
    <section class="trending pt-6 pb-0 bg-lgrey">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="single-content">
                        <div class="single-full-title border-b mb-2 pb-2">
                            <div class="single-title">
                                <h2 class="mb-0">{{ combined_info.hotel_info.hotel_name }}</h2>
                                <input type="hidden" class="room-index" id="hotelNameContainer" value="{{ combined_info.hotel_info.hotel_name }}">
                                <div class="rating-main d-lg-flex align-items-center text-lg-start text-center">
                                    <!-- <p class="mb-0 me-2">Business Class</p> -->
                                    <div class="rating me-2" id="{{ combined_info.hotel_info.hotel_name }}_starRating">
                                        {% for star in "12345" %}
                                            <span class="fa fa-star {% if forloop.counter <= combined_info.hotel_info.star_rating %}checked{% else %}unchecked{% endif %}"></span>
                                        {% endfor %}
                                    </div>
                                    
                                </div>
                                <div class="col-md-6" style="font-size: 13px;">
                                    <address>{{ combined_info.hotel_info.address }}</address>
                                </div>
                            </div>
                        </div>
                        <div class="description-images mb-4 overflow-hidden">
                            <div class="thumbnail-images position-relative">
                                <div class="slider-store rounded overflow-hidden" style="height: 450px !important;">
                                    {% for image_url in combined_info.hotel_info.images %}
                                    <div >
                                       <img src="{{ image_url }}" alt="1" style="height: 450px !important;">
                                    </div>
                                    {% endfor %}
                                    
                                </div>
                                <div class="slider-thumbs mt-1" style="height: 100px !important;" >
                                    {% for image_url in combined_info.hotel_info.images %}
                                    <div>
                                        <img src="{{ image_url }}" alt="1" style="height:100px !important; width: 200px;">
                                     </div>
                                     {% endfor %}
                                     
                                </div>
                            </div>
                        </div>

                        <div class="description mb-2">
                            <h4>General</h4>
                            <p>{{ combined_info.hotel_info.description|safe }}</p>
                            </div>

                        <div class="description mb-2">
                            <div class="row">
                               
                                <div class="mb-2">
                                    <div class="desc-box bg-grey p-4 rounded">
                                        <h4 class="mb-2">Facilities</h4>
                                        <ul>
                                            {% for facility in combined_info.hotel_info.hotel_facilities %}
                                            {% if forloop.counter0 > 200 %}
                                            <li class="d-block pb-1"><i class="fa fa-check pink px-2"></i>{{facility }}</li>
                                            {% else %}
                                            {% if forloop.first %}
                                            <div class="row">
                                                {% endif %}
                                                <div class="col-md-6 col-sm-6 col-xxs-3 pt-1 pb-1">
                                                    <li class=""><i class="fa fa-check pink  px-2"></i>{{ facility }}</li>
                                                </div>
                                                {% if forloop.last %}
                                                    <!-- Close the row if it's the last item -->
                                                    </div>
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                                
                            </div>
                        </div>

                        <div class="accrodion-grp faq-accrodion mb-4" data-grp-name="faq-accrodion">
                            <div class="accrodion active">
                                <div class="accrodion-title rounded">
                                    <h5 class="mb-0"><span>ROOMS</span></h5>
                                </div>
                                <div class="accrodion-content" style="display: block;">
                                    <div class="inner" style="padding: 0px !important;">
                                        <div class="room-details hotel-room" id="listofrooms">
                                            {{ combined_info.room_details_html|safe }}
                                        </div>
                                    </div><!-- /.inner -->
                                </div>
                            </div>
                            <!-- <div class="accrodion ">
                                <div class="accrodion-title rounded">
                                    <h5 class="mb-0"><span>Day 2</span> - Zurich - Biel/Bienne - Neuchatel - Geneva</h5>
                                </div>
                                <div class="accrodion-content" style="display: none;">
                                    <div class="inner">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa, inventore cumque veniam, praesentium velit incidunt rem quas a, quos eos ipsum, reprehenderit voluptatem.</p>
                                    </div>
                                </div>
                            </div> -->
                            <!-- <div class="accrodion">
                                <div class="accrodion-title rounded">
                                    <h5 class="mb-0"><span>Day 3</span> - Enchanting Engelberg</h5>
                                </div>
                                <div class="accrodion-content" style="display: none;">
                                    <div class="inner">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa, inventore cumque veniam, praesentium velit incidunt rem quas a, quos eos ipsum, reprehenderit voluptatem.</p>
                                    </div>
                                </div>
                            </div> -->
                            <!-- <div class="accrodion ">
                                <div class="accrodion-title rounded">
                                    <h5 class="mb-0"><span>Day 4</span> - Barcelona - Zaragoza - Madrid</h5>
                                </div>
                                <div class="accrodion-content" style="display: none;">
                                    <div class="inner">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa, inventore cumque veniam, praesentium velit incidunt rem quas a, quos eos ipsum, reprehenderit voluptatem.</p>
                                    </div>
                                </div>
                            </div> -->
                        </div>

                        <div class="single-map mb-4">
                            <h4>Map</h4>
                            <div class="map rounded overflow-hidden">
                                <div style="width: 100%">
                                    <iframe class=" rounded overflow-hidden" height="400" src="https://maps.google.com/maps?q={{ extracted_info.latitude }},{{ extracted_info.longitude }}&z=15&output=embed"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 ps-lg-4">
                    <div class="sidebar-sticky">
                        <div class="list-sidebar">
                            <div class="sidebar-item mb-4">
                                <div class="book-form w-100 bg-white box-shadow p-4 pb-1 z-index1 rounded">
                                    <div class="row d-flex align-items-center justify-content-between">
                                        <div class="col-lg-12 mb-2 text-center">
                                            <ul class="pb-2 mb-2 border-b">
                                                <li class="me-1 p-2 bg-grey d-inline-block rounded">Check Availability</li>
                                                <!-- <li class="me-1 p-2 bg-grey d-inline-block rounded"><input type="radio"> One-way</li>
                                                <li class="p-2 bg-grey d-inline-block rounded"><input type="radio"> Multi-city</li> -->
                                            </ul>
                                        </div>
                                        <div class="col-lg-6 mb-2">
                                            <div class="form-group">
                                                <div class="input-box">
                                                    <label>Check In</label>
                                                    <p class="int">{{ combined_info.hotel_info.check_in_date }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 mb-2">
                                            <div class="form-group">
                                                <div class="input-box">
                                                    <label>Check Out</label>
                                                    <p class="int">{{ combined_info.hotel_info.check_out_date }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 mb-2">
                                            <div class="form-group">
                                                <div class="input-box">
                                                    <label>No Of Nightst</label>
                                                    <p class="int">{{ combined_info.hotel_info.No_of_Night }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 mb-2">
                                            <div class="form-group">
                                                <div class="input-box">
                                                    <label>Person & Rooms</label>
                                                    <p class="int">{{ combined_info.hotel_info.guest_details }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        
                                    </div>
                                </div>
                            </div>
                           
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- top Destination ends -->




    <!-- footer starts -->
    {% include 'home/footer.html' %}
    <!-- footer ends -->
    
    <!-- Back to top start -->
    <div id="back-to-top">
        <a href="#"></a>
    </div>
    <!-- Back to top ends -->

 

   


    <!-- *Scripts* -->
    <script src="{% static 'js/home/jquery-3.5.1.min.js' %}"></script>
    <script src="{% static 'js/home/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/home/particles.js' %}"></script>
    <script src="{% static 'js/home/particlerun.js' %}"></script>
    <script src="{% static 'js/home/plugin.js' %}"></script>
    <script src="{% static 'js/home/main.js' %}"></script>
    <script src="{% static 'js/home/custom-accordian.js' %}"></script>
    <script src="{% static 'js/home/custom-nav.js' %}"></script>

    <script>
        // An array of image sources
        var image_str=document.getElementById("piccol").value
        image_str=image_str.replace('[', '');
        image_str=image_str.replace(']', '');

        var imageSources = image_str.split(",");
        var firstImageSource = imageSources[0];
        var newSrc = firstImageSource.replace(/'/g, '');
        document.getElementById('mainImage').src = newSrc;

        // Now, 'firstImageSource' contains the first value from the array
        console.log(firstImageSource);

        // var combinedInfoImages = document.querySelector('.hide-elements p.tax').textContent.trim();
        // var imageSources = JSON.parse(combinedInfoImages);

        // alert(imageSources);

        // Dynamically generate thumbnails and attach the changeImage function
        var thumbnailContainer = document.getElementById('thumbnailContainer');
        var prevButton = document.getElementById('prevButton');
        var nextButton = document.getElementById('nextButton');
        var currentIndex = 0;

        for (var i = 0; i < imageSources.length; i++) {
        var image_tag = imageSources[i].replace("'", '')
            image_tag = image_tag.replace(" ", '')
            image_tag = image_tag.replace("'", '')
        // alert(image_tag)
            var thumbnailImage = document.createElement('img');
            thumbnailImage.src = image_tag
            thumbnailImage.className = 'thumbnail';
            thumbnailImage.onclick = function () {
                changeImage(this.src);
            };

            thumbnailContainer.appendChild(thumbnailImage);
        }

        // Function to change the main image
        function changeImage(imageSrc) {
            document.getElementById('mainImage').src = imageSrc;
        }

        // Event listener for the previous button
        prevButton.addEventListener('click', function () {
            console.log('Previous button clicked');
            if (currentIndex > 0) {
                currentIndex--;
                var prevImageSrc = imageSources[currentIndex];
                changeImage(prevImageSrc);
            }
        });

        // Event listener for the next button
        nextButton.addEventListener('click', function () {
            console.log('Next button clicked');
            if (currentIndex < imageSources.length - 1) {
                currentIndex++;
                var nextImageSrc = imageSources[currentIndex];
                changeImage(nextImageSrc);
            }
        });

        // Assuming you have jQuery included in your project
        $('.view-details-link').on('click', function(event) {
            event.preventDefault();
        
            var hotelCode = $(this).data('hotel-code');
            var traceId = $(this).data('trace-id');
            var resultIndex = $(this).data('result-index');
            var tokenId = $(this).data('token-id');
            console.log(hotelCode)
        
            // Your AJAX request to send data to views.py
            var csrftoken = document.cookie.match(/csrftoken=([\w-]+)/)[1];
            $.ajax({
                url: "/your_view/",  
                type: "POST",
                data: {
                    'hotelCode': hotelCode,
                    'traceId': traceId,
                    'resultIndex': resultIndex,
                    'tokenId': tokenId
                },
                headers: {
                    'X-CSRFToken': csrftoken  // Include the CSRF token in the headers
                },
                success: function(response) {
                    // Handle the response from the server
                    if (response.error) {
                        console.error(response.error);
                        print('hii')
                    } else {
                        // document.body.innerHTML = response.html;
                        print('hii')
                        var newWindow = window.open();
                        newWindow.document.write(response.html);
                        // updateRoomDetails(response.room_details, hotelCode);
                    }
                },
                error: function(error) {
                    // Handle errors if any
                    console.error(error);
                }
            });
        });

        //reload
        window.addEventListener('pageshow', function(event) {
            // Check if the page is being shown from the bfcache (back-forward cache)
            if (event.persisted) {
                // Reload the page
                window.location.reload();
            }
        });
    </script>
    <script>
        function bookRoom1() {
            var hiddenPhoneNumber = document.getElementById('hiddenPhoneNumber');
                
            if (hiddenPhoneNumber && hiddenPhoneNumber.value) {
                var roomJsonElement = document.querySelector('.hide-elements .room-json');
                var dataJsonElement = document.querySelector('.hide-elements .data-json');
                var hotelName = document.querySelector('.h-name p').innerText;
                console.log(hotelName)

                if (roomJsonElement && dataJsonElement) {
                    var currentRoomJson = JSON.parse(roomJsonElement.innerText);
                    var currentDataJson = JSON.parse(dataJsonElement.innerText);
                    console.log(currentRoomJson);
                    console.log(currentDataJson);

                    var payload = {
                        ResultIndex: currentDataJson.ResultIndex,
                        HotelCode: currentDataJson.HotelCode,
                        HotelName: hotelName,
                        GuestNationality:"IN",
                        NoOfRooms: "1",
                        ClientReferenceNo: "0",
                        IsVoucherBooking: "true",
                        HotelRoomsDetails: [
                            {
                                RoomIndex: currentRoomJson.RoomIndex,
                                RoomTypeCode: currentRoomJson.RoomTypeCode,
                                RoomTypeName: currentRoomJson.RoomTypeName,
                                RatePlanCode:currentRoomJson.RatePlanCode,
                                BedTypeCode:null,
                                SmokingPreference:0,
                                Supplements:null,
                                Price:currentRoomJson.Price
                            }
                        ],
                        EndUserIp: '123.1.1.1',  // Replace with actual end user IP
                        TokenId: currentDataJson.TokenId,
                        TraceId: currentDataJson.TraceId,
                    };
                    var csrftoken = document.cookie.match(/csrftoken=([\w-]+)/)[1];
                    // Assuming you have jQuery available
                    $.ajax({
                        url: '/hotelreview/',
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify(payload),
                        headers: {
                            'X-CSRFToken': csrftoken  // Include the CSRF token in the headers
                        },
                        success: function(response) {
                            console.log(response);
                            var newWindow = window.open();
                            newWindow.document.write(response.html);
                            // Handle the response as needed
                        },
                        error: function(error) {
                            console.error(error);
                        }
                    });
                }
            } else {
                $("#log-btn").click();
            }
        }
    </script>
    <script>
        function bookRoom() {
            var hiddenPhoneNumber = document.getElementById('hiddenPhoneNumber');
            
            // if (hiddenPhoneNumber && hiddenPhoneNumber.value) {
                var form = document.createElement('form');
                form.method = 'POST';
                form.action = '/hotelreview/';
                var roomJsonList = document.getElementById('hide-123').value;
                var unescapedValue1 = roomJsonList.replace(/&quot;/g, '"');
                var parsedJSON1 = JSON.parse(unescapedValue1);
                var datalist = document.getElementById('data-123').value;
                var unescapedValue = datalist.replace(/&quot;/g, '"');
                var parsedJSON = JSON.parse(unescapedValue);
                var hotelCode = parsedJSON.HotelCode; 
                var hotelNameInputElement =  document.getElementById('hotelNameContainer').value;
                if (hotelNameInputElement) {
                    var hotelName = hotelNameInputElement;
                    var csrfToken = document.cookie.match(/csrftoken=([\w-]+)/)[1];
                    var csrfTokenField = document.createElement('input');
                    csrfTokenField.type = 'hidden';
                    csrfTokenField.name = 'csrfmiddlewaretoken';
                    csrfTokenField.value = csrfToken;
                    form.appendChild(csrfTokenField);
                    var roomJsonElement = document.createElement('input');
                    roomJsonElement.type = 'hidden';
                    roomJsonElement.name = 'roomJsonElement';
                    roomJsonElement.value = JSON.stringify(parsedJSON1);
                    form.appendChild(roomJsonElement);
                    var hotelNameField = document.createElement('input');
                    hotelNameField.type = 'hidden';
                    hotelNameField.name = 'hotelName';
                    hotelNameField.value = hotelName;
                    form.appendChild(hotelNameField);
                    var hide123Value = document.createElement('input');
                    hide123Value.type = 'hidden';
                    hide123Value.name = 'hide123Value';
                    hide123Value.value = JSON.stringify(parsedJSON);
                    form.appendChild(hide123Value);
                    var categoryid1 = document.getElementById('categoryid').value;
                    var categoryidField = document.createElement('input');
                    categoryidField.type = 'hidden';
                    categoryidField.name = 'categoryid1';
                    categoryidField.value = categoryid1;
                    form.appendChild(categoryidField);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    console.error('Hotel name input element not found.');
                }
            // } else {
            //     $("#log-btn").click();
            // }
        }
    </script>

    <script>
        //Preload
        var loader =  document.getElementById("preloader")
        window.addEventListener("load", function() {
            loader.style.display="none"
        })
    </script>
    <script>
        $(document).ready(function() {
             var emailData = $("#hiddenEmail").val();
             var phoneData = $("#hiddenPhoneNumber").val();
             var usernameData = $("#hiddenUsername").val();
             var logProfilePic = $("#logProfile");
             var logbtnShow = $("#log-btn");
             var usernameShow = $("#mblNumber");
             
             if (emailData === "" && phoneData === "" && usernameData === "") {
                 logbtnShow.show();
             } else {
                 logProfilePic.show();
                 logbtnShow.hide();
                 usernameShow.html(usernameData);
             }
         });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>