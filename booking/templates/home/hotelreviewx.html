{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VF Hotel Preview</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="your-custom.css">
    <link rel="stylesheet" href="{% static 'css/booking/hotelreviews.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        .checked {
            color: orange;
        }
    </style>
</head>
<body id="body">
  
    <section id="process" class="bg-light py-5">
        <div class="container mt-5">
            <div class="d-flex flex-row justify-content-between">
                <label class="text-center">Traveller Details</label>
                <label class="text-center">Review</label>
                <label class="text-center">Payment</label>
            </div>
            <div class="mt-3">
                <input type="range" class="custom-range" min="0" max="100" value="50" style="width: 100%;">
            </div>
        </div>
    </section>
    <!-- Button trigger modal -->
    <button type="button" id="timeOutBtn" class="btn btn-primary d-none" data-toggle="modal" data-target="#exampleModal">
        Timeout
    </button>
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Timeout</h5>
              <!-- <button type="button" class="close-btn" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button> -->
            </div>
            <div class="modal-body">
                <div id="customPopup" class="container popup">
                    <div class="popup-content col-md-12 text-center">
                        <p >Your session has timed out. Please try again.</p>
                        <!-- <button  class="btn btn-primary ses-btn"></button> -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a href="{% url 'hotel' %}"><button type="button" class="btn btn-secondary">Ok</button></a>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title cp_head" id="exampleModalLongTitle">Cancellation Policy</h5>
            <button type="button" class="close-btn" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <div class="mt-2">
                    <p class="cp_refund">Full Refund Allowed</p>
                    <table class="table table-bordered">
                        <thead>
                            <tr class="t_head">
                                <th>Cancelled on or After</th>
                                <th>Cancelled on or Before</th>
                                <th>Cancellation Charges</th>
                            </tr>
                        </thead>
                        <input type="hidden" id="CancellationPolicies" value="{{ details.CancellationPolicies }}">
                        <tbody id="cancellationPoliciesTableBody">
                            <tr>
                                <td>16-Dec-2023 00:00:00</td>
                                <td>18-Dec-2023 23:59:59</td>
                                <td>4029 Amount Charges.</td>
                            </tr>
                        </tbody>
                    </table>
                    <script>
                        // Sample data similar to details.CancellationPolicies
                        var cancellationPoliciesString = document.getElementById("CancellationPolicies").value;
                        var cancellationPolicies = JSON.parse(cancellationPoliciesString);
                        console.log(cancellationPolicies)
                        
                        // Function to generate <tr> elements dynamically
                        function generateCancellationPolicyRows() {
                            var tableBody = document.getElementById("cancellationPoliciesTableBody");
                            var tableRows = "";
                        
                            // Loop over cancellation policies and generate <tr> elements
                            cancellationPolicies.forEach(function(policy) {
                                // Format FromDate and ToDate
                                var fromDate = new Date(policy.FromDate).toLocaleString('en-US', {day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit'});
                                var toDate = new Date(policy.ToDate).toLocaleString('en-US', {day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit'});
                        
                                var row = `
                                    <tr>
                                        <td>${fromDate}</td>
                                        <td>${toDate}</td>
                                        <td>${policy.Charge} ${policy.Currency} Amount Charges.</td>
                                    </tr>
                                `;
                                tableRows += row;
                            });
                        
                            // Update the table body with generated rows
                            tableBody.innerHTML = tableRows;
                        }
                        
                        // Call the function to generate rows
                        generateCancellationPolicyRows();
                    </script>
                    <ul  class="cp_list">
                        <li>No Show will attract full cancellation charge unless otherwise specified.</li>
                        <li>Early check out will attract full cancellation charge unless otherwise specified.</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
        </div>
    </div>
   
    <section class="container" id="total-review">
        <div class="hotel-summary col-md-8">
            <div class="det">
                <div class="d-flex justify-content-between">
                    <div>
                        <h2 class="heading">Hotel Summary</h2>
                    </div>
                    <button type="button" class="btn btn-primary cp_btn" data-toggle="modal" data-target="#exampleModalCenter">
                        Cancellation Policy
                      </button>
                      <a href="" style="display: none;"><p>{{ details.cancellation_policy }}</p></a>
                    
                </div>
                <div class=""  style="background:rgba(238, 246, 255, 1);border-radius: 8px;padding: 6px 10px 0px;">
                    <div class="d-flex row" style="padding:3px;">
                        <div class="d-flex">
                            <div class="hotel-name">
                                <p>{{ details.hotel_name }}</p>
                            </div>
                            <div class="star-view" style="padding-left: 6px;">
                                {% for star in "12345" %}
                                    <span class="fa fa-star {% if forloop.counter <= details.rating %}checked{% else %}unchecked{% endif %}"></span>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="hotel-loc">
                            <address>{{ details.address }}</address>
                        </div>
                    </div>
                    <div class="container mt-1"  style="padding: 6px 10px 0px;">
                        <div class="d-flex col-md-12 justify-content-between">
                            <div class="col-md-4">
                                <p class="dtls_text">Check In</p>
                                <p class="dtls_utext">{{ details.check_in_date }}</p>
                            </div>
                            <div class="col-md-4">
                                <p class="dtls_text">Check Out</p>
                                <p class="dtls_utext">{{ details.check_out_date }}</p>
                            </div>
                            <div class="col-md-4">
                                <p class="dtls_text">Night(s)</p>
                                <p class="dtls_utext">{{ details.No_of_Night }}</p>
                            </div>
                        </div>
                        <div class="d-flex col-md-12 justify-content-between" >
                            <div class="col-md-4">
                                <p class="dtls_text">Room(s)</p>
                                <p class="dtls_utext">{{ details.totalrooms }}</p>
                            </div>
                            <div class="col-md-4"> 
                                <p class="dtls_text">Adult(s)</p>
                                <p class="dtls_utext">{{ details.adults }}</p>
                            </div>
                            <div class="col-md-4">
                                <p class="dtls_text">Children</p>
                                <p class="dtls_utext">{{ details.childs }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <input type="hidden" class="block_book" name="block_book" placeholder="block_book" value="{{ current_time }}">
            <input type="hidden" class="hide_123_val" name="hide_123_val" placeholder="block_book" value="{{ future_time }}">
            <input type="hidden" class="category_id" name="category_id" placeholder="category_id" value="{{ category_id }}">
            <form method="POST" action="{% url 'previewpage' %}" id="paymentForm" onsubmit="return validateForm()">
                {% csrf_token %}
                <div class="det container mt-3" style="border:8px solid #A3C2F445;">
                    <div class="d-flex" style="border-radius: 10px;">
                        <h2 class="heading">Contact Details</h2>
                    </div> 
                    <div>
                        <p class="guide_text">Please enter user name and mobile number where you would like to receive your confirmation.</p>
                    </div>
                    <div class="d-flex">
                        <div class="col-md-4">
                            <input type="text" class="username" name="user_name" placeholder="Enter Your Name" value="">
                            <span class="error" id="nameError"></span>
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="phone_number" name="phone_number" placeholder="Enter Your Number" value="" >
                            <span class="error" id="phoneError"></span>
                        </div>
                        <div>
                            <input type="hidden" class="published_amount" name="published_amount" placeholder="User Name" value="{{ details.total_price }}">
                            <input type="hidden" class="payment_flag" name="payment_flag" placeholder="User Name" value="process">
                            <input type="hidden" class="payment_id" name="payment_id" placeholder="User Name" value="1a2c">
                            <input type="hidden" class="room_information" name="room_information" placeholder="User Name" value="{{ details }}">
                            <input type="hidden" id="curTime" name="curTime">
                            <input type="hidden" class="payed_amount" name="payed_amount" placeholder="User Name" value="0">
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="email" name="email" placeholder="Enter Your Email" value="" >
                            <span class="error" id="emailError"></span>
                        </div>
                    </div>
                    <!-- <div class="d-flex col-md-12 mt-3" style="margin: 0px 5px;">
                        <input id="contactCheckbox" type="checkbox" style="width: 20px;height: 20px;margin-top: 9px; margin-right: 10px;">
                        <label for="" class="checkinput mb-3" style="font-size: 14px;color:#0071FF;;">Select login number as contact number</label>
                        <span class="error" id="checkboxError"></span>
                    </div> -->
                </div>
                <div class="det container col-md-12 mt-3">
                    <div class="row">
                        <h2 class="heading">Guest Information</h2>
                        <p class="u_heading">Enter the details of the guest</p>
                    </div>
                
                    <div id="guestDetailsContainer">
                        <!-- Guest details will be dynamically added here -->
                    </div>
                    
                    <input type="hidden" class="room_information" name="user_information" placeholder="User Name" value="">
                    <div id="hiddenGuestData" style="display: none;">{{ personsdetails }}</div> 
                </div>
                <div class="mt-3 col-md-12">
                    <p class="heading">Special Request (Optional)</p>
                    <textarea name="req" id="req" cols="50" rows="5"></textarea>
                </div>
                <div class="hotel-pay pay_2 container  mt-4" style="display: none;">
                    <div class="mt-1">
                        <h2 class="price-head">Pricing Details</h2>
                    </div>
                    <hr>
                    <div class="d-flex col-md-12" style="justify-content: space-between;">
                        <div class="col-md-9">
                            <p>Base Fare</p>
                            <p style="font-size: 13px;">({{ details.totalrooms }}Room X {{ details.No_of_Night }}Night)</p>
                        </div>
                        <div class="d-flex col-md-3 justify-content-between">
                            <p class="text-start">INR</p>
                            <p class="text-end">{{ details.published_price }}</p>
                        </div>
                    </div>
                    <div class="d-flex col-md-12" style="justify-content: space-between;">
                        <div class="col-md-9">
                            <p>Taxes and Fees</p>
                        </div>
                        <div class="d-flex col-md-3 justify-content-between">
                            <p class="text-start">INR</p>
                            <p  class="text-end">{{ details.final_tax }}</p>
                        </div>
                    </div>
                    <div class="d-flex col-md-12" style="justify-content: space-between;">
                        <div class="col-md-9">
                            <p>Total Price</p>
                        </div>
                        <div class="d-flex col-md-3 justify-content-between">
                            <p class="text-start">INR</p>
                            <p class="text-end">{{ details.total_price }}</p>
                        </div>
                    </div>
                    <hr>
                    <div class="d-flex col-md-12 mb-0" style="justify-content: space-between;">
                        <div class="col-md-9">
                            <p>Your Price</p>
                        </div>
                        <div class="d-flex col-md-3" style="color: rgba(94, 255, 129, 1); justify-content: space-between;">
                            <p class="text-start justify-content-between">INR</p>
                            <p  class="text-end">{{ details.total_price }}</p>
                        </div>
                    </div>
                </div>
                <div class="mt-3 col-md-12 text-end">
                    <button type="submit" id="myButton" onclick="sendit()" class="btn btn-primary pro-btn">Proceed To Preview</button>
                </div>
            </form>
        </div>
          <script>
            function sendit() {
                if (validateForm()) {
                    var currentTime = new Date();
                    var currentTimeWithSec = currentTime.toString().slice(4, 24);

                    var contime = currentTimeWithSec;

                    document.getElementById('curTime').value = contime;

                    // var form = document.createElement('form');
                    // form.method = 'POST';
                    // form.action = '/hotelbooked/';

                    // // Get values of hidden inputs
                    // var blockBook = document.querySelector('.block_book').value;
                    // var hide123Val = document.querySelector('.hide_123_val').value;
                    // var categoryId = document.querySelector('.category_id').value;

                    // // Append hidden input fields to the form
                    // var blockBookField = document.createElement('input');
                    // blockBookField.type = 'hidden';
                    // blockBookField.name = 'block_book';
                    // blockBookField.value = blockBook;
                    // form.appendChild(blockBookField);

                    // var hide123ValField = document.createElement('input');
                    // hide123ValField.type = 'hidden';
                    // hide123ValField.name = 'hide_123_val';
                    // hide123ValField.value = hide123Val;
                    // form.appendChild(hide123ValField);

                    // var categoryIdField = document.createElement('input');
                    // categoryIdField.type = 'hidden';
                    // categoryIdField.name = 'category_id';
                    // categoryIdField.value = categoryId;
                    // form.appendChild(categoryIdField);

                    // // // Add hidden input field for current time with seconds
                    // // var currentTimeField = document.createElement('input');
                    // // currentTimeField.type = 'hidden';
                    // // currentTimeField.name = 'current_time';
                    // // currentTimeField.value = currentTimeWithSec;
                    // // form.appendChild(currentTimeField);
                    
                    // // Rest of your existing code
                    // // ...
                    // document.body.appendChild(form);
                    // form.submit();
                }
            }
        </script>
       
        <div class="hotel-pay pay_1 container col-md-4 mt-4">
            <div class="mt-1">
                <h2 class="price-head">Pricing Details</h2>
            </div>
            <hr>
            <div class="d-flex col-md-12" style="justify-content: space-between;">
                <div class="col-md-9">
                    <p>Base Fare</p>
                    <p style="font-size: 13px;">({{ details.totalrooms }}Room X {{ details.No_of_Night }}Night)</p>
                </div>
                <div class="d-flex col-md-3 justify-content-between">
                    <p class="text-start">INR</p>
                    <p class="text-end">{{ details.published_price }}</p>
                </div>
            </div>
            <div class="d-flex col-md-12" style="justify-content: space-between;">
                <div class="col-md-9">
                    <p>Taxes and Fees</p>
                </div>
                <div class="d-flex col-md-3 justify-content-between">
                    <p class="text-start">INR</p>
                    <p  class="text-end">{{ details.final_tax }}</p>
                </div>
            </div>
            <div class="d-flex col-md-12" style="justify-content: space-between;">
                <div class="col-md-9">
                    <p>Total Price</p>
                </div>
                <div class="d-flex col-md-3 justify-content-between">
                    <p class="text-start">INR</p>
                    <p class="text-end">{{ details.total_price }}</p>
                </div>
            </div>
            <hr>
            <div class="d-flex col-md-12 mb-0" style="justify-content: space-between;">
                <div class="col-md-9">
                    <p>Your Price</p>
                </div>
                <div class="d-flex col-md-3" style="color: rgba(94, 255, 129, 1); justify-content: space-between;">
                    <p class="text-start justify-content-between">INR</p>
                    <p  class="text-end">{{ details.total_price }}</p>
                </div>
            </div>
        </div>
    </section>
    <footer id="footer" class="text-center container-fluid mt-3 mb-1">
        <p id="timer">Time remaining: 10:00</p>
    </footer>
   <script>
        function validateForm() {
        var valid = true;

        document.getElementById('nameError').innerText = '';
        document.getElementById('phoneError').innerText = '';
        document.getElementById('emailError').innerText = '';

        var nameInput = document.querySelector('.username');
        var phoneInput = document.querySelector('.phone_number');
        var emailInput = document.querySelector('.email');

        var name = nameInput.value;
        var phone = phoneInput.value;
        var email = emailInput.value;

        if (name.trim() === '') {
            document.getElementById('nameError').innerText = 'Name is required';
            nameInput.style.border = '1px solid red';
            valid = false;
        } else {
            nameInput.style.border = ''; // Reset border style if valid
        }

        var phonePattern = /^\d{10}$/;
        if (phone.trim() === '') {
            document.getElementById('phoneError').innerText = 'Phone number is required';
            phoneInput.style.border = '1px solid red';
            valid = false;
        } else if (!phonePattern.test(phone)) {
            document.getElementById('phoneError').innerText = 'Invalid phone number';
            phoneInput.style.border = '1px solid red';
            valid = false;
        } else {
            phoneInput.style.border = ''; // Reset border style if valid
        }

        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (email.trim() === '') {
            document.getElementById('emailError').innerText = 'Email is required';
            emailInput.style.border = '1px solid red';
            valid = false;
        } else if (!emailPattern.test(email)) {
            document.getElementById('emailError').innerText = 'Invalid email address';
            emailInput.style.border = '1px solid red';
            valid = false;
        } else {
            emailInput.style.border = ''; // Reset border style if valid
        }

        guestData.forEach(function (room, roomIndex) {
        for (var i = 0; i < room.NoOfAdults; i++) {
            var adultFirstName = document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_first_name"]`);
            var adultLastName = document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_last_name"]`);

            if (adultFirstName.value.trim() === '') {
                document.getElementById(`firstNameError_${roomIndex + 1}_adult_${i + 1}`).innerText = 'Please Enter the first name';
                adultFirstName.style.border = '1px solid red';
                valid = false;
            } else {
                adultFirstName.style.border = '';
                document.getElementById(`firstNameError_${roomIndex + 1}_adult_${i + 1}`).innerText = ' '; // Reset border style if valid
            }

            if (adultLastName.value.trim() === '') {
                document.getElementById(`lastNameError_${roomIndex + 1}_adult_${i + 1}`).innerText = 'Please Enter the last name';
                adultLastName.style.border = '1px solid red';
                valid = false;
            } else {
                adultLastName.style.border = ''; // Reset border style if valid
                document.getElementById(`lastNameError_${roomIndex + 1}_adult_${i + 1}`).innerText = ' ';
            }
        }

        for (var j = 0; j < room.NoOfChild; j++) {
            var childFirstName = document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_first_name"]`);
            var childLastName = document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_last_name"]`);

            if (childFirstName.value.trim() === '') {
                document.getElementById(`cfirstNameError_${roomIndex + 1}_child_${j + 1}`).innerText = 'Please Enter the first name';
                childFirstName.style.border = '1px solid red';
                valid = false;
            } else {
                childFirstName.style.border = ''; // Reset border style if valid
                document.getElementById(`cfirstNameError_${roomIndex + 1}_child_${j + 1}`).innerText = ' ';
            }

            if (childLastName.value.trim() === '') {
                document.getElementById(`clastNameError_${roomIndex + 1}_child_${j + 1}`).innerText = 'Please Enter the last name';
                childLastName.style.border = '1px solid red';
                valid = false;
            } else {
                childLastName.style.border = ''; // Reset border style if valid
                document.getElementById(`clastNameError_${roomIndex + 1}_child_${j + 1}`).innerText = ' ';
            }
        }
    });


        var specialRequest = document.getElementById('req').value;

        return valid;
    }
    </script>
    <script>
        var personsdetails = document.getElementById('hiddenGuestData').textContent;
        var guestData = JSON.parse(personsdetails || "[]");

        console.log(guestData);

        function generateRoomDetails() {
            var container = document.getElementById('guestDetailsContainer');
            container.innerHTML = ''; // Clear existing content


            guestData.forEach(function (room, roomIndex) {
                var roomElement = document.createElement('div');
                roomElement.className = 'mt-2';
                roomElement.innerHTML = `<h3>Room ${roomIndex + 1}</h3>`;


                for (var i = 0; i < room.NoOfAdults; i++) {
                    var adultElement = document.createElement('div');
                    adultElement.className = 'mt-2';
                    adultElement.innerHTML = `
                        <div class="">
                            <h4 class="name_no">Adult ${i + 1}</h4>
                        </div>
                        <div class="d-flex">
                            <div class="col-md-2">
                                <select name="room_${roomIndex + 1}_adult_${i + 1}_gender">
                                    <option value="Mr">Mr</option>
                                    <option value="Mrs">Mrs</option>
                                    <option value="Miss">Miss</option>
                                </select>
                            </div>
                            <div class="col-md-5">
                                <input type="text" placeholder="Enter Your First Name" name="room_${roomIndex + 1}_adult_${i + 1}_first_name">
                                <span class="error" id="firstNameError_${roomIndex + 1}_adult_${i + 1}"></span>
                            </div>

                            
                            <div class="col-md-5">
                                <input type="text" placeholder="Enter Your Last Name" name="room_${roomIndex + 1}_adult_${i + 1}_last_name">
                                <span class="error" id="lastNameError_${roomIndex + 1}_adult_${i + 1}"></span>
                            </div>
                            <input type="hidden" name="room_${roomIndex + 1}_adult_${i + 1}_age" value="0">
                        </div>`;

                    roomElement.appendChild(adultElement);

                }

                for (var j = 0; j < room.NoOfChild; j++) {
                    var childElement = document.createElement('div');
                    childElement.className = 'mt-2';
                    childElement.innerHTML = `
                        <div class="row">
                            <h4 class="name_no">Child ${j + 1}</h4>
                        </div>
                        <div class="d-flex">
                            <div class="col-md-2">
                                <select name="room_${roomIndex + 1}_child_${j + 1}_gender">
                                    <option value="Mr">Mr</option>
                                    <option value="Mrs">Mrs</option>
                                    <option value="Miss">Miss</option>
                                </select>
                            </div>
                            <div class="col-md-5">
                                <input type="text" placeholder="Enter Your First Name" name="room_${roomIndex + 1}_child_${j + 1}_first_name">
                                <span class="error" id="cfirstNameError_${roomIndex + 1}_child_${j + 1}"></span>
                            </div>
                            <div class="col-md-5">
                                <input type="text" placeholder="Enter Your Last Name" name="room_${roomIndex + 1}_child_${j + 1}_last_name">
                                <span class="error" id="clastNameError_${roomIndex + 1}_child_${j + 1}"></span>
                            </div>
                            <div class="col-md-0" style="display:none">
                                <input type="hidden" name="room_${roomIndex + 1}_child_${j + 1}_ChildAge" value="${room.ChildAge[j]}">
                            </div>
                        </div>`;

                    roomElement.appendChild(childElement);

                }


                container.appendChild(roomElement);
            });
        }
        generateRoomDetails();
    </script>
    <script>
        document.getElementById('myButton').addEventListener('click', function () {
            if (validateForm()) {
            // Collect adult and child details from the form
        
            var adultChildDetails = [];
            guestData.forEach(function (room, roomIndex) {
                var roomDetails = {
                    adults: [],
                    children: []
                };

                for (var i = 0; i < room.NoOfAdults; i++) {
                    var adultDetails = {
                        gender: document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_gender"]`).value,
                        firstName: document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_first_name"]`).value,
                        lastName: document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_last_name"]`).value,
                        age: document.querySelector(`[name="room_${roomIndex + 1}_adult_${i + 1}_age"]`).value
                    };
                    roomDetails.adults.push(adultDetails);
                }

                for (var j = 0; j < room.NoOfChild; j++) {
                    var childDetails = {
                        gender: document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_gender"]`).value,
                        firstName: document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_first_name"]`).value,
                        lastName: document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_last_name"]`).value,
                        age: document.querySelector(`[name="room_${roomIndex + 1}_child_${j + 1}_ChildAge"]`).value
                    };
                    roomDetails.children.push(childDetails);
                }

                // Add room details to the array
                adultChildDetails.push({
                    ['room' + (roomIndex + 1)]: roomDetails
                });
            });
    

            var jsonString = JSON.stringify(adultChildDetails);
            // Submit the form
            document.querySelector('[name="user_information"]').value = jsonString;
            document.querySelector('form').submit();
        } else {
            return false;
        }
    });
    </script>
    <script>
        const timeoutDuration = 10 * 60 * 1000; // 10 minutes
        let timeoutTimer;

        function updateTimerDisplay(timeRemaining) {
            const minutes = Math.floor(timeRemaining / 60000);
            const seconds = Math.floor((timeRemaining % 60000) / 1000);
            const formattedTime = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById("timer").innerText = `Time remaining: ${formattedTime}`;
        }

        function resetTimer() {
            clearTimeout(timeoutTimer);
            let timeRemaining = timeoutDuration;

            function update() {
                updateTimerDisplay(timeRemaining);
                timeRemaining -= 1000;

                if (timeRemaining < 0) {
                 $("#timeOutBtn").click();
                    updateTimerDisplay(0); 
                    // alert("Your session has timed out. Please try again.");
                    // document.getElementById("paymentForm").reset();
                    // updateTimerDisplay(0); // Display 00:00 after timeout
                } else {
                    timeoutTimer = setTimeout(update, 1000);
                }
            }

            update();
        }
            
        resetTimer();

        
    </script>   



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-dn9z4yv9tiGOdLRQa5z9MKX9OrwD1gXcc5F+2zLQ5VQV/ZVXs3tSSA6KvoRf22kx" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8sh+WyUtBEQK7kojAIZ7uSTZ5nKVoKU"></script> -->
    <script>
        var loader =  document.getElementById("preloader")
        window.addEventListener("load", function() {
            loader.style.display="none"
        })
     </script>
    
  
</body>
</html>