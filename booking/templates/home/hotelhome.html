{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VF Home</title>
    <link rel="stylesheet" href="{% static 'css/booking/hotelhome.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="{% static 'js/booking/hotelhome.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js"></script>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
    <div id="preloader"></div>
    <style>
        #preloader {
            background: url("{% static 'image/booking/loading1.gif'%}") no-repeat center center;
            width: 100%;
            height: 300px;
            margin-top: 100px;
            align-items: center;
            justify-content: center;
        }

    </style>
    <!-- SLIDER -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Message</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <span id="errorMessageContainer"></span>
                </div>
            </div>
        </div>
    </div>

    <section>
        <div class="container-fluid slider-sec">
            <div class="row">
                <div class="col-md-12">
                    <div class="slider-container">
                        <div class="slider">
                            <div class="slide"><img src="{% static 'image/booking/Background.jpg' %}" alt="Image 1" class="img-fluid"></div>
                            <div class="slide"><img src="{% static 'image/booking/Background 2.jpg' %}" alt="Image 2" class="img-fluid"></div>
                            <div class="slide"><img src="{% static 'image/booking/Background 3.jpg' %}" alt="Image 3" class="img-fluid"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

 
    <!-- FORGOT PASSWORD -->
    <div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter1Title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container2">
                            <form class="col-md-12 mt-2" id="signup_form">
                                <div class="d-flex justify-content-between" id="sign_head_div">
                                    <h4 class="signup_text">FORGET PASSWORD</h4>
                                    <button type="button" class="close" style="border-bottom: none;" data-dismiss="modal" aria-label="Close" id="forgetclose">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div>
                                    <p class="sign_utext">OTP send to the whatsapp or mail.</p>
                                </div>
                                <div class="input_div mt-2" id="UserName">
                                    <label for="email_or_phone_password">Email Or Phone Number</label><span class="error" id="emailError2"></span>
                                    <input type="text" class="mt-4 input_signin email_or_phone_password" placeholder="phone number or email" name="email_or_phone_password" id="email_or_phone_password">
                                    <span class="error" id="email_or_phone_number"></span>
                                </div>
                                <div class="input_div mt-2" id="Password"></div>
                                <div id="gif" style="display: none;width: 100%;align-items: center;justify-content: center;text-align: center;"><img src="/static/image/booking/icegif-727.gif" alt="Success GIF" style="
                                    background: none !important;
                                    width: 250px;
                                "></div>
                                <!-- <div class="mt-4" id="checkbox_div">
                                    <div class="d-flex">
                                        <input type="checkbox" style="width: 19px;height: 19px">
                                        <p class="mb-0 check_text">I Agree With <span>Terms Of Servies</span>  And The <span> Privacy Policy</span> </p>
                                    </div>
                                    <span class="error" id="checkboxError"></span>
                                </div> -->
                                <div><p id="otpmessage"></p></div>
                                <div class="row justify-content-center" id="otp_container_forget">
                                    <div class="mt-2">
                                        <div class="card mb-0 mt-0 border-0">
                                        <div class="card-body p-2 text-center">
                                            <!-- <h4>Verify</h4>
                                            <p>Your code was sent to you via email</p> -->
                                            <div class="otp-field mb-2">
                                                <input id="digit1" type="number" />
                                                <input id="digit2" type="number" disabled />
                                                <input id="digit3" type="number" disabled />
                                                <input id="digit4" type="number" disabled />
                                            </div>
                                            <span class="error" id="Otp_error"></span>
                                            <!-- <p class="resend text-muted mb-2">Didn't receive code? <a href="">Request again</a></p> -->
                                            <div class="mt-0 mb-0">Time left : <span id="timers"></span></div>
                                            <div id="verifyButton" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                            <script>
                                                function submitPassword() {
                                                    // Retrieve form values
                                                    var userName = $("#email_or_phone_password").val();
                                                    var password = $("#New_password").val();
                                                    var confirmPassword = $("#New_confirm_password").val();

                                                    var csrftoken = getCookie('csrftoken');
                    
                                                    // AJAX request
                                                    $.ajax({
                                                        type: "POST",
                                                        url: "/change_password/",
                                                        headers: {
                                                                'X-CSRFToken': csrftoken
                                                        },
                                                        data: {
                                                            user_name: userName,
                                                            password: password,
                                                            confirm_password:confirmPassword
                                                        },
                                                        success: function(response) {
                                                            // Handle success response
                                                            console.log(response);
                                                            if (response.success === true) {
                                                                document.getElementById('Password').innerHTML = " ";
                                                                document.getElementById('Password').innerHTML = "<p>Password Changed</p>";
                                                                document.getElementById('gif').style.display = 'block';
                                                                // If the response is success, submit the form
                                                            } else {
                                                                console.log("success")
                                                                $("#passwordErrors").text(response.error_message);
                                                            }
                                                        },
                                                        error: function(xhr, status, error) {
                                                            // Handle error
                                                            console.error(xhr.responseText);
                                                        }
                                                    });
                                                }
                                            </script>                                          
                                            <script>
                                                document.addEventListener('DOMContentLoaded', function () {
                                                    document.getElementById('verifyButton').addEventListener('click', function () {
                                                        var digit1 = document.getElementById('digit1').value;
                                                        var digit2 = document.getElementById('digit2').value;
                                                        var digit3 = document.getElementById('digit3').value;
                                                        var digit4 = document.getElementById('digit4').value;
                
                                                        // Concatenate the digits into a single string
                                                        var otp = digit1 + digit2 + digit3 + digit4;
                
                                                        // Get CSRF token
                                                        var csrftoken = getCookie('csrftoken');
                                            
                                                        // Send the OTP to the backend using AJAX
                                                        $.ajax({
                                                            type: 'POST',
                                                            url: '/verify-otp/',  // URL to the backend view
                                                            headers: {
                                                                'X-CSRFToken': csrftoken
                                                            },
                                                            data: {
                                                                'otp': otp,
                                                                // You can include other data if needed
                                                            },
                                                            success: function(response) {
                                                                // Handle success response
                                                                console.log(response);
                                                                if (response.success === true) {
                                                                    // If the response is success, submit the form
                                                                    document.getElementById('UserName').style.display = 'none';
                                                                    var name = document.getElementById('email_or_phone_password').value;
                                                                    console.log(name)
                                                                    document.getElementById('otp_container_forget').innerHTML = '';
                                                                    
                                                                    // Insert HTML inside 'msg' id
                                                                    document.getElementById('Password').innerHTML = `
                                                                        <div class="input_div mt-2">
                                                                            <div style="margin:4px;width: 100%;">
                                                                                <input type="password" class="input_signin password" name="password" id="New_password" placeholder="Enter Password">
                                                                            </div>
                                                                            <div style="margin:4px;width: 100%;">
                                                                                <input type="password" class="input_signin confirm_password" name="confirm_password" id="New_confirm_password" placeholder="Confirm Password">
                                                                                <span class="error" id="passwordErrors" class="passwordErrors"></span>
                                                                            </div>
                                                                        </div>
                                                                        <div id="verifyBtn" onclick="submitPassword()" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                                                    `;
                                                                } else {
                                                                    var otperror = document.getElementById('Otp_error');
                                                                    otperror.innerText = response.message;
                                                                    // var errorButton = document.getElementById('errorButtons');
                                                                    // errorButton.classList.remove('d-none');
                                                                    // var errorMessage = document.getElementById('errorMessageContainers');
                                                                    // errorMessage.innerHTML = response.message;
                                                                    // errorButton.click(); // Trigger click event to show the modal
                                                                }
                                                            },
                                                            error: function(xhr, errmsg, err) {
                                                                // Handle error
                                                                console.log(xhr.status + ": " + xhr.responseText);
                                                            }
                                                        });
                                                    });
                                                });
                                            </script>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 btn_div">
                                    <button class="sign_btn" id="signButton"  type="button" onclick="validateFormpassword()">OTP send to the whatsapp or mail</button>
                                </div>
                                <!-- <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Already Have An Account? </p> &nbsp
                                    <button type="button" onclick="loginroute()" class="lg_btn" style="border: none;background: none;text-decoration: underline"></button>
                                </div> -->
                            </form>
                        </div>
                        <!-- <script>
                            function loginroute(){
                                $("#LogClose").click();
                                $("#log-btn").click();
                            }
                        </script> -->
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap');
                    
                            * {
                                margin: 0;
                                padding: 0;
                                font-family: 'Inter', sans-serif;
                            }
                    /* 
                            body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            } */
                            
                            .otp-field {
                                flex-direction: row;
                                column-gap: 20px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            }
                    
                            .otp-field input {
                                height: 45px;
                                width: 42px;
                                border-radius: 6px;
                                outline: none;
                                font-size: 1.125rem;
                                text-align: center;
                                border: 1px solid #ddd;
                            }
                            
                            .otp-field input:focus {
                                box-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);
                            }
                    
                            .otp-field input::-webkit-inner-spin-button,
                            .otp-field input::-webkit-outer-spin-button {
                                display: none;
                            }
                    
                            .resend {
                                font-size: 12px;
                            }
                    
                            #otp_container_forget{
                                display: none;
                            }
                            
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                    
                            #image_container {
                                background:url("{% static 'images/Signin_bg.jfif' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }
                    
                            .container-fluid {
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            }
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            #signup_container {
                                padding: 20px;
                            }
                    
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 24px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            .input_signin {
                                background: rgba(237, 237, 237, 0.75);
                                border-radius: 53px;
                                padding: 13px 18px;
                                font-size: 15px;
                                height: auto !important;
                                font-weight: 600;
                                color:rgba(23, 52, 73, 0.61);
                                border: none;
                                width: 100%;
                                margin: 2px;
                            }
                    
                            .input::placeholder {
                                font-weight: 400;
                                color:rgba(23, 52, 73, 0.61);
                                font-size: 15px;
                            }
                    
                            #checkbox_div {
                               margin: 2px 10px;
                               /* display: none; */
                            }
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                    
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                           #verifyBtn {
                                padding: 12px 20px;
                                color:rgba(255, 255, 255, 1);
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                width: 100%;
                                height: 50px;
                                border: none;
                                font-weight: 600;
                                font-size: 15px;
                                border-radius: 50px;
                           }
                    
                           #timers {
                            border: 1px solid black;
                            border-radius: 10px;
                            font-weight: 600;
                            box-shadow: 5px 5px 5px 0.5 gray;
                            padding: 4px;
                           }
                            
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                            @media only screen and (max-width: 768px) {
                                #main_container {
                                    flex-direction: column;
                                }
                            }
                    
                        </style>
                        <!-- <script>
                            let timerOns = true;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signButton");
                            function timers(remaining) {
                                var m = Math.floor(remaining / 60);
                                var s = remaining % 60;
                        
                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timers').innerHTML = m + ':' + s;
                                remaining -= 1;
                        
                                if (remaining >= 0 && timerOns) {
                                    setTimeout(function () {
                                        timers(remaining);
                                    }, 1000);
                                    return;
                                }
                        
                                if (!timerOns) {
                                    // Do validate stuff here
                                    return;
                                }
                        
                                if (document.getElementById('UserName').style.display === 'none') {
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "none";
                                } else if (document.getElementById('UserName').style.display === 'block') {
                                    // Do timeout stuff here
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "block";
                                    signBtn.innerHTML = "Resend OTP";
                                } else {
                                    alert("Something went wrong");
                                }
                            }
                        </script> -->
                        
                       <script>
                        function validateFormpassword() {
                            var valid = true;
                            document.getElementById('email_or_phone_password').innerText = '';
                            // document.getElementById('phoneError').innerText = '';
                            // document.getElementById('emailError').innerText = '';
                            // document.getElementById('passwordError').innerText = '';
                            // document.getElementById('confirmPasswordError').innerText = '';
                            // document.getElementById('checkboxError').innerText = '';
                
                            var nameInput = document.querySelector('.email_or_phone_password');
                            // var phoneInput = document.querySelector('.phone_number');
                            // var emailInput = document.querySelector('.email');
                            // var passwordInput = document.querySelector('.password');
                            // var confirmPasswordInput = document.querySelector('.confirm_password');
                            // var checkbox = document.querySelector('#checkbox_div input[type="checkbox"]');
                            
                    
                            var email = nameInput.value;
                            // var phone = phoneInput.value;
                            // var email = emailInput.value;
                            // var password = passwordInput.value;
                            // var confirmPassword = confirmPasswordInput.value;
                    
                            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            var phonePattern = /^\d{10}$/;
                            if (email.trim() === '') {
                                document.getElementById('email_or_phone_number').innerText = 'Email is required';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            }  else if (!emailPattern.test(email) && !phonePattern.test(email)) {
                                document.getElementById('email_or_phone_number').innerText = 'Invalid email address or phone number';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                nameInput.style.border = ''; // Reset border style if valid
                            }
                
                            if (valid) {
                                document.getElementById("otpmessage").innerText = "OTP WILL BE SEND TO THE PHONE NUMBER AND MAIL";
                                sendOTPass();
                            }
                
                            return valid
                        }

                    </script>
                    <script>
                        function sendOTPass() {
                            // Send AJAX request to server to send OTP to the provided phone number
                            var phone_number = document.getElementById("email_or_phone_password").value;

                            // Get CSRF token from the cookie
                            var csrftoken = getCookie('csrftoken');

                            // Example AJAX request with CSRF token included
                            $.ajax({
                                url: '/send_otp_forgot/',
                                type: 'POST',
                                data: {
                                    'phone_number': phone_number,
                                    'csrfmiddlewaretoken': csrftoken // Include the CSRF token in the data
                                },
                                success: function(response) {
                                    if (response.success === true) {
                                        // If the response is success, submit the form
                                        document.getElementById("otpmessage").innerText = " ";
                                        otpDiv.style.display = "block";
                                        document.getElementById("signButton").style.display = "none";
                                        document.getElementById('otp_container_forget').style.display = 'block';

                                        // Store expiration time in localStorage
                                        var expirationTime = new Date();
                                        expirationTime.setSeconds(expirationTime.getSeconds() + 180); // Assuming expiration time is 180 seconds
                                        localStorage.setItem('expirationTime', expirationTime.getTime());

                                        timers();
                                    } else {
                                        var errorMessage = document.getElementById('otpmessage');
                                        errorMessage.innerText = response.message;
                                        var errorButton = document.getElementById('errorButtons');
                                        errorButton.click();
                                        otpDiv.style.display = "none";
                                        signBtn.style.display = "block";
                                    }
                                }
                            });
                        }

                        // Function to get CSRF token from the cookie
                        function getCookie(name) {
                            var cookieValue = null;
                            if (document.cookie && document.cookie !== '') {
                                var cookies = document.cookie.split(';');
                                for (var i = 0; i < cookies.length; i++) {
                                    var cookie = cookies[i].trim();
                                    // Check if the cookie name matches the requested name
                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                        // Extract and decode the CSRF token
                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                        break;
                                    }
                                }
                            }
                            return cookieValue;
                        }

                        var otpDivcon = document.getElementById("otp_container_forget");
                        var signBtncon = document.getElementById("signButton");

                        function timers() {
                            var expirationTime = localStorage.getItem('expirationTime');

                            if (!expirationTime) return;

                            function updateTimer() {
                                var currentTime = new Date().getTime();
                                var remainingTime = Math.max(0, Math.floor((expirationTime - currentTime) / 1000));

                                var m = Math.floor(remainingTime / 60);
                                var s = remainingTime % 60;

                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timers').innerHTML = m + ':' + s;

                                if (remainingTime > 0) {
                                    setTimeout(updateTimer, 1000);
                                } else {
                                    // Handle timeout
                                    otpDivcon.style.display = "none";
                                    signBtncon.style.display = "block";
                                    signBtncon.innerHTML = "Resend OTP";
                                }
                            }

                            updateTimer();
                        }
                    </script>
                    <script>
                        const inputss = document.querySelectorAll(".otp-field > input");
                        const buttons = document.querySelector(".verify_btn");
                
                        window.addEventListener("load", () => inputs[0].focus());
                        button.setAttribute("disabled", "disabled");
                
                        inputs[0].addEventListener("paste", function (event) {
                        event.preventDefault();
                
                        const pastedValue = (event.clipboardData || window.clipboardData).getData(
                            "text"
                        );
                        const otpLength = inputs.length;
                
                        for (let i = 0; i < otpLength; i++) {
                            if (i < pastedValue.length) {
                            inputs[i].value = pastedValue[i];
                            inputs[i].removeAttribute("disabled");
                            inputs[i].focus;
                            } else {
                            inputs[i].value = ""; // Clear any remaining inputs
                            inputs[i].focus;
                            }
                        }
                        });
                
                        inputs.forEach((input, index1) => {
                        input.addEventListener("keyup", (e) => {
                            const currentInput = input;
                            const nextInput = input.nextElementSibling;
                            const prevInput = input.previousElementSibling;
                
                            if (currentInput.value.length > 1) {
                            currentInput.value = "";
                            return;
                            }
                
                            if (
                            nextInput &&
                            nextInput.hasAttribute("disabled") &&
                            currentInput.value !== ""
                            ) {
                            nextInput.removeAttribute("disabled");
                            nextInput.focus();
                            }
                
                            if (e.key === "Backspace") {
                            inputs.forEach((input, index2) => {
                                if (index1 <= index2 && prevInput) {
                                input.setAttribute("disabled", true);
                                input.value = "";
                                prevInput.focus();
                                }
                            });
                            }
                
                            button.classList.remove("active");
                            button.setAttribute("disabled", "disabled");
                
                            const inputsNo = inputs.length;
                            if (!inputs[inputsNo - 1].disabled && inputs[inputsNo - 1].value !== "") {
                            button.classList.add("active");
                            button.removeAttribute("disabled");
                
                            return;
                            }
                        });
                        });
                    </script>  
                    </section>
            </div>
        </div>
        </div>
    </div> 

     <!-- SIGNIN POPUP -->
    <div class="modal fade" id="exampleModalCenter1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter1Title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container1">
                            <!-- <div class="col-md-6" id="image_container">
                                <div class="mt-2">
                                    <img src="{% static 'images/Magnet logo.png' %}" alt="" style="width: 79px;height: 79px;">
                                </div>
                                <div class="mt-3">
                                    <h4 class="image_h4">Explore The World And Discover The New Experiance</h4>
                                </div>
                                <div class="features_div col-md-6">
                                    <p class="features mt-4" style="width: 260px;">Customizable Tour Packages</p>
                                    <p class="features mt-4" style="width: 207px;">Personalized Services</p>
                                    <p class="features mt-4" style="width: 149px;">24/7 Service</p>
                                </div>
                                <img src="{% static 'images/Signin_bg.jfif' %}" alt="" style="width: 100%; height:100%;border-radius: 20px">
                            </div> -->
                            <form class="col-md-12 mt-2" id="signup_form">
                                {% csrf_token %}
                                <div class="d-flex justify-content-between" id="sign_head_div">
                                    <h4 class="signup_text">Sign Up</h4>
                                    <button type="button" class="close" style="border-bottom: none;" data-dismiss="modal" aria-label="Close" id="LogClose">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div>
                                    <p class="sign_utext">Create Your Account,Get Your Personalized Tour Account.</p>
                                </div>
                                <div class="input_div mt-2">
                                    <input type="text" class="mt-4 input_signin username" id="user_name" placeholder="User Name" name="user_name" >
                                    <span class="error" id="nameError"></span>
                                    <input type="text" class="mt-4 input_signin phone_number" placeholder="Phone Number" name="phone_number" id="phone_number">
                                    <span class="error" id="phoneError"></span>
                                    <input type="email" class="mt-4 input_signin email" placeholder="Email" name="email" id="Email">
                                    <span class="error" id="emailError"></span>
                                </div>
                                <div class="mt-3 justify-content-between d-flex">
                                    <div style="margin:4px;width: 100%;">
                                        <input type="password" class="input_signin password" name="password" id="password" placeholder="Enter Password">
                                        <span class="error" id="passwordError"></span>
                                    </div>
                                    <div style="margin:4px;width: 100%;">
                                        <input type="password" class="input_signin confirm_password" name="confirm_password" id="confirm_password" placeholder="Confirm Password" >
                                        <span class="error" id="confirmPasswordError"></span>
                                    </div>
                                </div>
                                <div class="mt-4" id="checkbox_div">
                                    <div class="d-flex">
                                        <input type="checkbox" style="width: 19px;height: 19px">
                                        <p class="mb-0 check_text">I Agree With <span>Terms Of Servies</span>  And The <span> Privacy Policy</span> </p>
                                    </div>
                                    <span class="error" id="checkboxError"></span>
                                </div>
                                <div><p id="otpmessages"></p></div>
                                <div class="row justify-content-center" id="otp_container">
                                    <div class="mt-2">
                                        <div class="card mb-0 mt-0 border-0">
                                        <div class="card-body p-2 text-center">
                                            <!-- <h4>Verify</h4>
                                            <p>Your code was sent to you via email</p> -->
                                            <div class="otp-field mb-2">
                                                <input id="digitA" type="number" />
                                                <input id="digitB" type="number" disabled />
                                                <input id="digitC" type="number" disabled />
                                                <input id="digitD" type="number" disabled />
                                            </div>
                                            <p class="resend text-muted mb-2">Didn't receive code? <a href="">Request again</a></p>
                                            <div class="mt-0 mb-0">Time left : <span id="timer"></span></div>
                                            <div id="verifyBtn" class=" verify_btn btn btn-primary mb-0 mt-2">Submit</div>
                                            {% if error_message %}
                                            <script>
                                                alert("{{ error_message }}")
                                            </script>    
                                            {% endif %}
                                            <script>
                                                function submitForm() {
                                                    // Retrieve form values
                                                    var userName = $("#user_name").val();
                                                    var phoneNumber = $("#phone_number").val();
                                                    var email = $("#Email").val();
                                                    var password = $(".password").val();
                                                    var confirmPassword = $(".confirm_password").val();

                                                    var csrftoken = getCookie('csrftoken');
                    
                                                    // AJAX request
                                                    $.ajax({
                                                        type: "POST",
                                                        url: "/signups/",
                                                        headers: {
                                                                'X-CSRFToken': csrftoken
                                                        },
                                                        data: {
                                                            user_name: userName,
                                                            phone_number: phoneNumber,
                                                            email: email,
                                                            password: password,
                                                            confirm_password:confirmPassword
                                                        },
                                                        success: function(response) {
                                                            // Handle success response
                                                            console.log(response);
                                                            if (response.success === true) {
                                                                // If the response is success, submit the form
                                                                $("#LogClose").click();
                                                                $("#log-btn").click();
                                                            } else {
                                                                console.log("success")
                                                                $("#LogClose").click();
                                                                var errorMessage = document.getElementById('errorMessageContainer');
                                                                errorMessage.innerHTML = response.error_message;
                                                                $("#errorButtons").click();
                                                            }
                                                        },
                                                        error: function(xhr, status, error) {
                                                            // Handle error
                                                            console.error(xhr.responseText);
                                                        }
                                                    });
                                                }
                                            </script>                                          
                                            <script>
                                                document.addEventListener('DOMContentLoaded', function () {
                                                    document.getElementById('verifyBtn').addEventListener('click', function () {
                                                        var digit1 = document.getElementById('digitA').value;
                                                        var digit2 = document.getElementById('digitB').value;
                                                        var digit3 = document.getElementById('digitC').value;
                                                        var digit4 = document.getElementById('digitD').value;
                
                                                        // Concatenate the digits into a single string
                                                        var otp = digit1 + digit2 + digit3 + digit4;
                
                                                        // Get CSRF token
                                                        var csrftoken = getCookie('csrftoken');
                                            
                                                        // Send the OTP to the backend using AJAX
                                                        $.ajax({
                                                            type: 'POST',
                                                            url: '/verify-otp/',  // URL to the backend view
                                                            headers: {
                                                                'X-CSRFToken': csrftoken
                                                            },
                                                            data: {
                                                                'otp': otp,
                                                                // You can include other data if needed
                                                            },
                                                            success: function(response) {
                                                                // Handle success response
                                                                console.log(response);
                                                                if (response.success === true) {
                                                                    // If the response is success, submit the form
                                                                    submitForm();
                                                                } else {
                                                                    var errorButton = document.getElementById('errorButtons');
                                                                    errorButton.classList.remove('d-none');
                                                                    var errorMessage = document.getElementById('errorMessageContainers');
                                                                    errorMessage.innerHTML = response.message;
                                                                    errorButton.click(); // Trigger click event to show the modal
                                                                }
                                                            },
                                                            error: function(xhr, errmsg, err) {
                                                                // Handle error
                                                                console.log(xhr.status + ": " + xhr.responseText);
                                                            }
                                                        });
                                                    });
                                                });
                                            </script>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4 btn_div">
                                    <button class="sign_btn" id="signBtn"  type="button" onclick="validateFormSign()">OTP send to the whatsapp and mail</button>
                                </div>
                                <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Already Have An Account? </p> &nbsp
                                    <button type="button" onclick="loginroute()" class="lg_btn" style="border: none;background: none;text-decoration: underline">Log In</button>
                                </div>
                            </form>
                        </div>
                        <script>
                            function loginroute(){
                                $("#LogClose").click();
                                $("#log-btn").click();
                            }
                        </script>
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap');
                    
                            * {
                                margin: 0;
                                padding: 0;
                                font-family: 'Inter', sans-serif;
                            }
                    /* 
                            body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            } */
                            
                            .otp-field {
                                flex-direction: row;
                                column-gap: 20px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            }
                    
                            .otp-field input {
                                height: 45px;
                                width: 42px;
                                border-radius: 6px;
                                outline: none;
                                font-size: 1.125rem;
                                text-align: center;
                                border: 1px solid #ddd;
                            }
                            
                            .otp-field input:focus {
                                box-shadow: 0 1px 0 rgba(0, 0, 0, 0.1);
                            }
                    
                            .otp-field input::-webkit-inner-spin-button,
                            .otp-field input::-webkit-outer-spin-button {
                                display: none;
                            }
                    
                            .resend {
                                font-size: 12px;
                            }
                    
                            #otp_container{
                                display: none;
                            }
                            
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                    
                            #image_container {
                                background:url("{% static 'images/Signin_bg.jfif' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }
                    
                            .container-fluid {
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            }
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            #signup_container {
                                padding: 20px;
                            }
                    
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 24px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            .input_signin {
                                background: rgba(237, 237, 237, 0.75);
                                border-radius: 53px;
                                padding: 13px 18px;
                                font-size: 15px;
                                height: auto !important;
                                font-weight: 600;
                                color:rgba(23, 52, 73, 0.61);
                                border: none;
                                width: 100%;
                                margin: 2px;
                            }
                    
                            .input::placeholder {
                                font-weight: 400;
                                color:rgba(23, 52, 73, 0.61);
                                font-size: 15px;
                            }
                    
                            #checkbox_div {
                               margin: 2px 10px;
                               /* display: none; */
                            }
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                    
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                           #verifyBtn {
                                padding: 12px 20px;
                                color:rgba(255, 255, 255, 1);
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                width: 100%;
                                height: 50px;
                                border: none;
                                font-weight: 600;
                                font-size: 15px;
                                border-radius: 50px;
                           }
                    
                           #timer {
                            border: 1px solid black;
                            border-radius: 10px;
                            font-weight: 600;
                            box-shadow: 5px 5px 5px 0.5 gray;
                            padding: 4px;
                           }
                            
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                            @media only screen and (max-width: 768px) {
                                #main_container {
                                    flex-direction: column;
                                }
                            }
                    
                        </style>
                        <!-- <script>
                            let timerOn = true;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signBtn");
                            function timer(remaining) {
                            var m = Math.floor(remaining / 60);
                            var s = remaining % 60;
                            
                            m = m < 10 ? '0' + m : m;
                            s = s < 10 ? '0' + s : s;
                            document.getElementById('timer').innerHTML = m + ':' + s;
                            remaining -= 1;
                            
                            if(remaining >= 0 && timerOn) {
                                setTimeout(function() {
                                    timer(remaining);
                                }, 1000);
                                return;
                            }
                    
                            if(!timerOn) {
                                // Do validate stuff here
                                return;
                            }
                            
                            // Do timeout stuff here
                            alert('Timeout for otp');
                            otpDiv.style.display = "none";
                            signBtn.style.display = "block"
                            signBtn.innerHTML = "Resend OTP"
                            }
                        </script> -->
                       <script>
                        function validateFormSign() {
                            var valid = true;
                            document.getElementById("otpmessages").innerText = "OTP WILL BE SEND TO THE PHONE NUMBER AND MAIL";
                            document.getElementById('nameError').innerText = '';
                            document.getElementById('phoneError').innerText = '';
                            document.getElementById('emailError').innerText = '';
                            document.getElementById('passwordError').innerText = '';
                            document.getElementById('confirmPasswordError').innerText = '';
                            document.getElementById('checkboxError').innerText = '';
                
                            var nameInput = document.querySelector('.username');
                            var phoneInput = document.querySelector('.phone_number');
                            var emailInput = document.querySelector('.email');
                            var passwordInput = document.querySelector('.password');
                            var confirmPasswordInput = document.querySelector('.confirm_password');
                            var checkbox = document.querySelector('#checkbox_div input[type="checkbox"]');
                            
                    
                            var name = nameInput.value;
                            var phone = phoneInput.value;
                            var email = emailInput.value;
                            var password = passwordInput.value;
                            var confirmPassword = confirmPasswordInput.value;
                    
                            if (name === '') {
                                document.getElementById('nameError').innerText = 'Name is required';
                                nameInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                nameInput.style.border = '';
                            }
                    
                            var phonePattern = /^\d{10}$/;
                            if (phone === '') {
                                document.getElementById('phoneError').innerText = 'Phone number is required';
                                phoneInput.style.border = '1px solid red';
                                valid = false;
                            } else if (!phonePattern.test(phone)) {
                                document.getElementById('phoneError').innerText = 'Invalid phone number';
                                phoneInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                phoneInput.style.border = '';
                            }
                
                            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            if (email.trim() === '') {
                                document.getElementById('emailError').innerText = 'Email is required';
                                emailInput.style.border = '1px solid red';
                                valid = false;
                            } else if (!emailPattern.test(email)) {
                                document.getElementById('emailError').innerText = 'Invalid email address';
                                emailInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                emailInput.style.border = ''; // Reset border style if valid
                            }
                            
                
                            if (password === '') {
                                document.getElementById('passwordError').innerText = 'Password is required';
                                passwordInput.style.border = '1px solid red';
                                valid = false;
                            } else if (password.length < 8) {
                                document.getElementById('passwordError').innerText = 'Password must be at least 8 characters long';
                                passwordInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                passwordInput.style.border = '';
                            }
                
                            if (confirmPassword === '') {
                                document.getElementById('confirmPasswordError').innerText = 'confirm your password';
                                confirmPasswordInput.style.border = '1px solid red';
                                valid = false;
                            } else if (confirmPassword !== password) {
                                document.getElementById('confirmPasswordError').innerText = 'Passwords do not match';
                                confirmPasswordInput.style.border = '1px solid red';
                                valid = false;
                            } else {
                                confirmPasswordInput.style.border = '';
                            }
                
                            if (!checkbox.checked) {
                                document.getElementById('checkboxError').innerText = 'Please agree to the terms and privacy policy';
                                valid = false;
                            }
                
                            if (valid) {
                                sendOTP();
                            }
                
                            return valid
                        }

                        // function sendOTP() {
                        //     // Send AJAX request to server to send OTP to the provided phone number
                        //     var phone_number = document.getElementById("phone_number").value;
                        //     var email = document.getElementById("Email").value;
                        //     var user_name = document.getElementById("user_name").value;
                        //     var otpDiv = document.getElementById("otp_container");
                        //     var signBtn = document.getElementById("signBtn");
                            
                        //     // Get CSRF token from the cookie
                        //     var csrftoken = getCookie('csrftoken');
                    
                        //     // Example AJAX request with CSRF token included
                        //     $.ajax({
                        //         url: '/send_otp/',
                        //         type: 'POST',
                        //         data: {
                        //             'phone_number': phone_number,
                        //             'email':email,
                        //             'user_name':user_name,
                        //             'csrfmiddlewaretoken': csrftoken  // Include the CSRF token in the data
                        //         },
                        //         success: function(response) {
                        //             if (response.success === true) {
                        //                 // If the response is success, submit the form
                        //                 console.log("hii")
                        //                 document.getElementById("otpmessage").innerText = "Otp send successfully"
                        //                 var errorButton = document.getElementById('errorButtons');
                        //                 errorButton.classList.remove('d-none');
                        //                 var errorMessage = document.getElementById('errorMessageContainers');
                        //                 errorMessage.innerHTML = response.message;
                        //                 errorButton.click();
                        //                 otpDiv.style.display = "block";
                        //                 signBtn.style.display = "none"
                        //                 timer(180);
                        //             } else {
                        //                 var errorButton = document.getElementById('errorButtons');
                        //                 errorButton.classList.remove('d-none');
                        //                 var errorMessage = document.getElementById('errorMessageContainers');
                        //                 errorMessage.innerHTML = response.message;
                        //                 errorButton.click();
                        //                 otpDiv.style.display = "none";
                        //                 signBtn.style.display = "block"
                        //             }
                        //         }
                        //     });
                        // }
                    </script>
                     <script>
                        function sendOTP() {
                            // Send AJAX request to server to send OTP to the provided phone number
                            var phone_number = document.getElementById("phone_number").value;
                            var email = document.getElementById("Email").value;
                            var user_name = document.getElementById("user_name").value;
                            var otpDiv = document.getElementById("otp_container");
                            var signBtn = document.getElementById("signBtn");
                            
                            // Get CSRF token from the cookie
                            var csrftoken = getCookie('csrftoken');
                    
                            // Example AJAX request with CSRF token included
                            $.ajax({
                                url: '/send_otp/',
                                type: 'POST',
                                data: {
                                    'phone_number': phone_number,
                                    'email':email,
                                    'user_name':user_name,
                                    'csrfmiddlewaretoken': csrftoken  // Include the CSRF token in the data
                                },
                                success: function(response) {
                                    if (response.success === true) {
                                        // If the response is success, submit the for
                                        otpDiv.style.display = "block";
                                        signBtn.style.display = "none"
                                        var expirationTime = new Date();
                                        expirationTime.setSeconds(expirationTime.getSeconds() + 180); // Assuming expiration time is 180 seconds
                                        localStorage.setItem('expirationTime', expirationTime.getTime());

                                        timer();
                                    } else {
                                        var errorButton = document.getElementById('errorButtons');
                                        errorButton.click();
                                        otpDiv.style.display = "none";
                                        signBtn.style.display = "block"
                                    }
                                }
                            });
                        }
                
                
                        // Function to get CSRF token from the cookie
                        function getCookie(name) {
                            var cookieValue = null;
                            if (document.cookie && document.cookie !== '') {
                                var cookies = document.cookie.split(';');
                                for (var i = 0; i < cookies.length; i++) {
                                    var cookie = cookies[i].trim();
                                    // Check if the cookie name matches the requested name
                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                        // Extract and decode the CSRF token
                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                        break;
                                    }
                                }
                            }
                            return cookieValue;
                        }
                        
                        var otpDiv = document.getElementById("otp_container");
                        var signBtn = document.getElementById("signBtn");

                        function timer() {
                            var expirationTime = localStorage.getItem('expirationTime');

                            if (!expirationTime) return;

                            function updateTimer() {
                                var currentTime = new Date().getTime();
                                var remainingTime = Math.max(0, Math.floor((expirationTime - currentTime) / 1000));

                                var m = Math.floor(remainingTime / 60);
                                var s = remainingTime % 60;

                                m = m < 10 ? '0' + m : m;
                                s = s < 10 ? '0' + s : s;
                                document.getElementById('timer').innerHTML = m + ':' + s;

                                if (remainingTime > 0) {
                                    setTimeout(updateTimer, 1000);
                                } else {
                                    // Handle timeout
                                    otpDiv.style.display = "none";
                                    signBtn.style.display = "block";
                                    signBtn.innerHTML = "Resend OTP";
                                }
                            }

                            updateTimer();
                        }

                        // Call timers() on page load to resume timer if expirationTime is stored
                        // timer();
                    </script>  
                    <script>
                        const inputs = document.querySelectorAll(".otp-field > input");
                        const button = document.querySelector(".verify_btn");
                
                        window.addEventListener("load", () => inputs[0].focus());
                        button.setAttribute("disabled", "disabled");
                
                        inputs[0].addEventListener("paste", function (event) {
                        event.preventDefault();
                
                        const pastedValue = (event.clipboardData || window.clipboardData).getData(
                            "text"
                        );
                        const otpLength = inputs.length;
                
                        for (let i = 0; i < otpLength; i++) {
                            if (i < pastedValue.length) {
                            inputs[i].value = pastedValue[i];
                            inputs[i].removeAttribute("disabled");
                            inputs[i].focus;
                            } else {
                            inputs[i].value = ""; // Clear any remaining inputs
                            inputs[i].focus;
                            }
                        }
                        });
                
                        inputs.forEach((input, index1) => {
                        input.addEventListener("keyup", (e) => {
                            const currentInput = input;
                            const nextInput = input.nextElementSibling;
                            const prevInput = input.previousElementSibling;
                
                            if (currentInput.value.length > 1) {
                            currentInput.value = "";
                            return;
                            }
                
                            if (
                            nextInput &&
                            nextInput.hasAttribute("disabled") &&
                            currentInput.value !== ""
                            ) {
                            nextInput.removeAttribute("disabled");
                            nextInput.focus();
                            }
                
                            if (e.key === "Backspace") {
                            inputs.forEach((input, index2) => {
                                if (index1 <= index2 && prevInput) {
                                input.setAttribute("disabled", true);
                                input.value = "";
                                prevInput.focus();
                                }
                            });
                            }
                
                            button.classList.remove("active");
                            button.setAttribute("disabled", "disabled");
                
                            const inputsNo = inputs.length;
                            if (!inputs[inputsNo - 1].disabled && inputs[inputsNo - 1].value !== "") {
                            button.classList.add("active");
                            button.removeAttribute("disabled");
                
                            return;
                            }
                        });
                        });
                    </script>  
                    </section>
            </div>
        </div>
        </div>
    </div>   
    
    <!-- LOGIN POPUP -->
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <section class="container">
                        <div class="d-flex" id="main_container">
                            <!-- <div class="col-md-7" id="image_container">
                                <div class="mt-3">
                                    <h4 class="image_h4">Explore The World And Discover The New Experiance</h4>
                                </div>
                                <div class="features_div col-md-6">
                                    <p class="features mt-4" style="width: 260px;">Customizable Tour Packages</p>
                                    <p class="features mt-4" style="width: 207px;">Personalized Services</p>
                                    <p class="features mt-4" style="width: 149px;">24/7 Service</p>
                                </div>
                                <div class="mt-2">
                                    <img src="{% static 'images/Magnet logo.png' %}" alt="" style="width: 100px;height: 100px;">
                                </div>
                                <img src="{% static 'images/Signin_bg.jfif' %}" alt="" style="width: 100%; height:100%;border-radius: 20px">
                            </div> -->
                            <form class="col-md-12 mt-2" id="signup_container">
                                {% csrf_token %}
                                <button type="button" class="btn btn-primary d-none" id="errorButton" data-bs-toggle="modal" data-bs-target="#exampleModal" style="display: none;">
                                    Error Message
                                </button>
                                
                                <div class="modal fade container" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog ">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Error Message</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <span id="errorMessageContainer"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Container for the error message -->
                                <div id="errorContainer" style="display: none;">
                                    {{ error }}
                                </div>
                                
                                <script>
                                    // Function to check for error condition and display error message
                                    function checkForError() {
                                        var errorExists = document.getElementById('errorContainer').innerText.trim() !== ''; // Check if error exists based on the content of errorContainer
                                
                                        if (errorExists) {
                                            var errorButton = document.getElementById('errorButton');
                                            errorButton.classList.remove('d-none');
                                            var errorMessage = document.getElementById('errorMessageContainer');
                                            errorMessage.innerHTML = document.getElementById('errorContainer').innerHTML;
                                            errorButton.click(); // Trigger click event to show the modal
                                        }
                                    }
                                
                                    // Call the function to check for error on page load
                                    checkForError();
                                </script>
                                <div class="mt-2" id="sign_head_div">
                                    <div class=" d-flex justify-content-between">
                                        <h4 class="signup_text">Welcome Back</h4>
                                        <button type="button" class="close" style="border-bottom: none;margin-top: -25px;" data-dismiss="modal" aria-label="Close" id="SignClose">
                                            <span aria-hidden="true">&times;</span>
                                            </button>
                                    </div>
                                    <div>
                                        <p class="sign_utext">Please enter your contact details to connect..</p>
                                    </div>
                                </div>
                                <div class="input_div mt-5">
                                    <label for="email">Email Or Phone Number</label><span class="error" id="emailError2"></span>
                                    <input type="text" class="mt-4 input_login email2" placeholder="Email or Phone Number" name="email_or_phone" id="email_or_phone">
                                </div>
                                <div class="mt-4">
                                    <label for="email">Password</label><span class="error" id="passwordError2"></span>
                                    <input type="password" class="input_login  password2 mt-4" name="password" id="signpassword" placeholder="Enter Password">
                                </div>
                                <div class="mt-5" id="checkbox_div">
                                    <div class="d-flex justify-content-between">
                                        <div class="d-flex">
                                            <input type="checkbox" class="checkbox2" style="width: 19px;height: 19px">
                                            <p class="mb-0 check_text">Remember Me</p>
                                        </div>
                                        <div>
                                            <a href="#" onclick="forgetpassword()" class="check_text">Forget Password?</a>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="error" id="checkboxError2"></span>
                                    </div>
                                </div>
                                <div class="mt-2 btn_div">
                                    <button class="sign_btn" onclick="validateFormPopup()" type="button">Log In</button>
                                </div>
                                <div class="mt-3 d-flex" id="concern_text">
                                    <p class="mb-0">Don’t have an account ?</p> &nbsp
                                    <button type="button" onclick="linklogin()" class="lg_btn" style="border: none;background: none;text-decoration: underline">Sign Up Here</button>
                                </div>
                                <script>
                                    function linklogin(){
                                        $("#SignClose").click();
                                        $("#signup-btn").click();
                                    }
                                    function forgetpassword(){
                                        $("#SignClose").click();
                                        $("#forgotpassword").click();
                                    }
                                </script>
                            </form>
                        </div>
                        <script>
                            // Get references to the popup and the Ok button
                            var errorPopup = document.getElementById("errorPopup");
                            var okButton = document.getElementById("okButton");
                            
                            // Add event listener to the Ok button
                            okButton.addEventListener("click", function() {
                                // Hide the popup
                                errorPopup.style.display = "none";
                            });
                        </script>
                        <script>
                            function validateFormPopup() {
                                var valid = true;
                        
                                document.getElementById('emailError2').innerText = '';
                                document.getElementById('passwordError2').innerText = '';
                                document.getElementById('checkboxError2').innerText = '';
                        
                                var emailInput = document.querySelector('.email2');
                                var passwordInput = document.querySelector('.password2');
                                var checkboxInput = document.querySelector('.checkbox2');
                        
                                var email = emailInput.value;
                                var password = passwordInput.value;
                                var rememberMe = checkboxInput.checked;
                        
                                var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                                var phonePattern = /^\d{10}$/;
                                if (email.trim() === '') {
                                    document.getElementById('emailError2').innerText = 'Email is required';
                                    emailInput.style.border = '1px solid red';
                                    valid = false;
                                }  else if (!emailPattern.test(email) && !phonePattern.test(email)) {
                                    document.getElementById('emailError2').innerText = 'Invalid email address or phone number';
                                    emailInput.style.border = '1px solid red';
                                    valid = false;
                                } else {
                                    emailInput.style.border = ''; // Reset border style if valid
                                }
                        
                                // Password validation
                                if (password.trim() === "") {
                                    document.getElementById('passwordError2').innerText = "Password is required";
                                    passwordInput.style.border = '1px solid red';
                                    valid = false;
                                } else if (password.length < 6) {
                                    document.getElementById('passwordError2').innerText = "Password must be at least 6 characters long";
                                    passwordInput.style.border = '1px solid red';
                                    valid = false;
                                } else {
                                    passwordInput.style.border = '';
                                }
                        
                                if (!rememberMe) {
                                    document.getElementById('checkboxError2').innerText = "Please check 'Remember Me'";
                                    valid = false;
                                }

                                
                                if (valid) {
                                    // If form is valid, call submitLogForms() function
                                    submitLogForms();
                                }
                        
                                return valid;
                            }

                            function submitLogForms() {
                                // Retrieve form values
                                var email_or_phone = $("#email_or_phone").val();
                                var password = $("#signpassword").val();

                                var csrftoken = getCookie('csrftoken');

                                // AJAX request
                                $.ajax({
                                    type: "POST",
                                    url: "/login_views/",
                                    headers: {
                                            'X-CSRFToken': csrftoken
                                    },
                                    data: {
                                        email_or_phone: email_or_phone,
                                        password: password,
                                    },
                                    success: function(response) {
                                        // Handle success response
                                        console.log(response);
                                        if (response.success === true) {
                                            // If the response is success, submit the form
                                            $("#SignClose").click();
                                           console.log(response.email)
                                           console.log(response.phone_number)
                                           console.log(response.username)
                                            window.location.reload();
                                        } else {
                                            console.log("success")
                                            $("#SignClose").click();
                                            var errorMessage = document.getElementById('errorMessageContainer');
                                            errorMessage.innerHTML = response.error_message;
                                            $("#errorButtons").click();
                                        }
                                    },
                                    error: function(xhr, status, error) {
                                        // Handle error
                                        console.error(xhr.responseText);
                                    }
                                });
                            }
                        </script>
                        <script>
                            $(document).ready(function() {
                                var emailData = $("#hiddenEmail").val();
                                var phoneData = $("#hiddenPhoneNumber").val();
                                var usernameData = $("#hiddenUsername").val();
                                var logProfilePic = $("#logProfile");
                                var logbtnShow = $("#log-btn");
                        
                                // Check if emailData, phoneData, and usernameData are null or undefined
                                if (!emailData && !phoneData && !usernameData) {
                                    logbtnShow.show();
                                } else {
                                    logProfilePic.show();
                                    logbtnShow.hide();
                                }
                            });
                        </script>
                                
                        <style>
                        
                            /* body:before {
                                content: '';
                                position: absolute;
                                width: 100vw;
                                height: 100vh;
                                background-image: url("{% static 'images/image_bg.png' %}");
                                background-position: center center;
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                -webkit-background-size: cover;
                                background-size: cover;
                                -webkit-filter: blur(10px);
                                -moz-filter: blur(10px);
                                filter: blur(10px);
                            }  */
                    
                            .error {
                                color: red;
                                font-size: 10px;
                                margin-left: 15px;
                            }
                            #image_container {
                                background:url("{% static 'images/image login.png' %}");
                                background-size: contain;
                                background-position: center center;
                                background-repeat: no-repeat;
                                /* background-attachment: fixed;
                                -webkit-background-size: cover; */
                                border-radius: 20px;
                                padding: 10px 15px;
                                margin: 15px 5px; 
                            }
                    
                            .image_h4 {
                                font-size: 36px;
                                font-weight: 700;
                                color:rgba(255, 255, 255, 1) ;
                            }
                    
                            .features_div {
                                margin-top: 80px;
                            }
                    
                            .features {
                                font-size: 16px;
                                color:rgba(255, 255, 255, 1);
                                font-weight: 500;
                                /* background: rgba(255, 255, 255, 0.28); */
                                padding: 27px 20px;
                                background: rgba(255, 254, 254, 0.13);
                                backdrop-filter: blur(5px);
                                border-radius: 18px;
                            }

                            .modal-header {
                                border-bottom: none !important;
                            }

                            .modal-content {
                                border-radius: 12px !important;
                            }
                    
                            /* .container-fluid { */
                                
                                /* -webkit-filter: blur(10px); */
                                /* -moz-filter: blur(10px); */
                                /* filter: blur(10px); */
                                /* padding: 40px 20px; */
                            /* } */
                    
                            #main_container {
                                background: rgba(255, 255, 255, 1);
                                /* box-shadow: 5px 5px 12px 0.5px; */
                                border-radius: 20px;
                            }
                    
                            /* #signup_container {
                                padding: 20px 30px;
                            }
                    */
                            #sign_head_div {
                                margin: 2px;
                            }
                    
                            .signup_text {
                                color: rgba(0, 78, 174, 1);
                                font-size: 32px;
                                font-weight: 600;
                            }
                    
                            .sign_utext {
                                font-size: 15px;
                                font-weight: 500;
                                color: rgba(0, 0, 0, 0.7);
                            }
                    
                            .input_div{
                                flex-direction: column;
                                display: flex;
                                margin: 2px;
                            }
                    
                            label {
                                font-size: 16px;
                                color: rgba(43, 43, 43, 1);
                                font-weight: 600;
                            }
                    
                            .input_login {
                                border-radius: 8px !important;
                                padding: 13px 18px !important;
                                font-size: 15px !important;
                                font-weight: 500 !important;
                                color: rgba(43, 43, 43, 0.5) !important;
                                border: 1px solid rgba(43, 43, 43, 1) !important;
                                width: 100% !important;
                                margin: 2px !important;
                                height: auto !important;
                            }
                    
                            /* .input_login ::placeholder {
                                font-weight: 400  !important;
                                color:rgba(23, 52, 73, 0.61) !important;
                                font-size: 15px !important;
                            } */
                    
                            .check_text {
                                color: rgba(23, 52, 73, 1);
                                font-size: 14px;
                                font-weight: 400;
                                padding-left: 10px;
                            }
                            .check_text span {
                                color: rgba(0, 78, 174, 1);
                                font-weight: 500;
                                cursor: pointer;
                            }
                            .sign_btn {
                                padding: 12px 20px;
                                background: linear-gradient(240deg, rgba(0, 78, 174, 1), rgba(75, 153, 249, 1));
                                border-radius: 50px;
                                color:rgba(255, 255, 255, 1);
                                text-align: center;
                                font-weight: 600;
                                font-size: 15px;
                                width: 100%;
                                height: 50px;
                                border: none;
                            }
                    
                            .sign_btn:hover {
                                background: linear-gradient(240deg, rgba(75, 153, 249, 1), rgba(0, 78, 174, 1));
                            }
                    
                            #concern_text {
                                align-items: center;
                                justify-content: center;
                                text-align: center;
                                margin: 2px;
                            }
                    
                            #concern_text p {
                                color: rgba(0, 0, 0, 0.71);
                                font-size: 15px;
                                font-weight: 600;
                    
                            }
                    
                            .btn_div {
                                margin: 2px;
                            }
                    
                            .lg_btn {
                                color: rgba(40, 150, 31, 1) !important;
                                font-size: 15px;
                                font-weight: 600;
                                cursor: pointer;
                                text-decoration: underline;
                            }
                    
                            .lg_btn:hover {
                                opacity: 60%;
                            }
                    
                    
                        </style>
                    </section>
                </div>
            </div>
        </div>
    </div>
    <!-- SLIDER TEXT SECTION -->
    <section id="text-sec">
        <div id="title">
            <div class="d-flex flex-row titles">
                <p id="head-title">THIS WINTER HOLIDAY</p>&nbsp
                <p id="sub-title" style="font-weight: 200;"><i>HOT TRIPS</i></p>
            </div>
            <div>
                <p id="under-title">Enjoy Your Holiday With Us</p>
            </div>
        </div>
    </section>

    <!-- HOME INPUT SECTION -->
    <section id="home-sec">
        <div class="container-fluid">
            <div class="head">
                <p>Book Your Hotels</p>
            </div>
            <form id="input-sec" class="row"  method="get" action="{% url 'process_form' %}" onsubmit="return validateForm()"  >
                {% csrf_token %}
                <fieldset class="scheduler-border col-md-3">
                    <legend class="scheduler-border">Where</legend>
                    <div class="control-group">
                        <div class="controls bootstrap-timepicker">
                            <input type="text"  class="des"  id="autocompleteInput" placeholder="Enter The Name, City, Landmark" style="font-size: 14px;" name="cityname" autofocus>
                            <input type="hidden" id="cityIdInput" name="city_id">
                            <input type="hidden" id="countryCodeInput" name="country_code">
                            <i class="icon-time"></i>
                            <script>
                                $(function () {
                                    $("#autocompleteInput").autocomplete({
                                        source: function (request, response) {
                                            $.ajax({
                                                url: "/search_destinations/",
                                                dataType: "json",
                                                data: {
                                                    query: request.term
                                                },
                                                success: function (data) {
                                                    response(data.data);
                                                }
                                            });
                                        },
                                        minLength: 2,
                                        select: function (event, ui) {
                                            // Update the hidden input fields with selected values
                                            $("#cityIdInput").val(ui.item.cityID);
                                            $("#countryCodeInput").val(ui.item.countryCode);
                                        }
                                    });
                                });
                            </script>
                            <style>
                                #cityIdInput {
                                    color: blue;
                                }
                            </style>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="scheduler-border col-md-2">
                    <legend class="scheduler-border">Check-In</legend>
                    <div class="control-group">
                        <div class="controls bootstrap-timepicker">
                            <input type="text" class="check" data-date="" data-date-format="DD MMMM YYYY" style="font-size: 14px;" name="check-in" id="check-in" readonly>
                            <i class="icon-time"></i>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="scheduler-border col-md-2">
                    <legend class="scheduler-border">Check-Out</legend>
                    <div class="control-group">
                        <div class="controls bootstrap-timepicker">
                            <input type="text" class="check" data-date="" data-date-format="DD MMMM YYYY" style="font-size: 14px;" name="check-out" id="check-out" readonly>
                            <i class="icon-time"></i>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="scheduler-border col-md-2 mb-3">
                    <legend class="scheduler-border">Nationality</legend>
                    <div class="control-group">
                        <div class="controls bootstrap-timepicker" style="width: 100%;">
                            <select class="Nationality" name="nation" id="nation" style="font-size: 14px;width: 100%;border: none; outline: none;" value="Enter the nation">
                                <option value="IN" selected>India</option>
                                <option value="AF" >Afghanistan</option>
                                <option value="AL" >Albania</option>
                                <option value="DZ" >Algeria</option>
                                <option value="AS" >American Samoa</option>
                                <option value="AD" >Andorra</option>
                                <option value="AO" >Angola</option>
                                <option value="AI" >Anguilla</option>
                                <option value="AQ" >Antarctica</option>
                                <option value="AG" >Antigua &amp; Barbuda</option>
                                <option value="AR" >Argentina</option>
                                <option value="AM" >Armenia</option>
                                <option value="AW" >Aruba</option>
                                <option value="AU" >Australia</option>
                                <option value="AT" >Austria</option>
                                <option value="AZ" >Azerbaijan</option>
                                <option value="BS" >Bahamas</option>
                                <option value="BH" >Bahrain</option>
                                <option value="BD" >Bangladesh</option>
                                <option value="BB" >Barbados</option>
                                <option value="BY" >Belarus (Belorussia)</option>
                                <option value="BE" >Belgium</option>
                                <option value="BZ" >Belize</option>
                                <option value="BJ" >Benin</option>
                                <option value="BM" >Bermuda</option>
                                <option value="BT" >Bhutan</option>
                                <option value="BO" >Bolivia</option>
                                <option value="BA" >Bosnia and Herzegowina</option>
                                <option value="BW" >Botswana</option>
                                <option value="BV" >Bouvet Islands</option>
                                <option value="BR" >Brazil</option>
                                <option value="IO" >British Indian Ocean Territory</option>
                                <option value="VG" >British Virgin Islands</option>
                                <option value="BN" >Brunei Darussalam</option>
                                <option value="BG" >Bulgaria</option>
                                <option value="BF" >Burkina Faso</option>
                                <option value="BI" >Burundi</option>
                                <option value="KH" >Cambodia</option>
                                <option value="CM" >Cameroon</option>
                                <option value="CA" >Canada</option>
                                <option value="CB" >Canada Buffer</option>
                                <option value="CV" >Cape Verde</option>
                                <option value="KY" >Cayman Islands</option>
                                <option value="CF" >Central African Republic</option>
                                <option value="TD" >Chad</option>
                                <option value="CL" >Chile</option>
                                <option value="CN" >China</option>
                                <option value="CX" >Christmas Islands</option>
                                <option value="CC" >Cocos (Keeling) Island</option>
                                <option value="CO" >Colombia</option>
                                <option value="KM" >Comoros</option>
                                <option value="CG" >Congo</option>
                                <option value="CD" >Congo (Rep. Dem.)</option>
                                <option value="CK" >Cook Islands</option>
                                <option value="CR" >Costa Rica</option>
                                <option value="HR" >Croatia</option>
                                <option value="CU" >Cuba</option>
                                <option value="CY" >Cyprus</option>
                                <option value="CZ" >Czech Republic</option>
                                <option value="DK" >Denmark</option>
                                <option value="DJ" >Djibouti</option>
                                <option value="DO" >Dominican Republic</option>
                                <option value="DM" >Dominicana</option>
                                <option value="TP" >East Timor</option>
                                <option value="EC" >Ecuador</option>
                                <option value="EG" >Egypt</option>
                                <option value="SV" >El Salvador</option>
                                <option value="GQ" >Equatorial Guinea</option>
                                <option value="ER" >Eritrea</option>
                                <option value="EE" >Estonia</option>
                                <option value="ET" >Ethiopia</option>
                                <option value="EU" >European Monetary Union</option>
                                <option value="FK" >Falkland Islands</option>
                                <option value="FO" >Faroe Islands</option>
                                <option value="FJ" >Fiji Islands</option>
                                <option value="FI" >Finland</option>
                                <option value="FR" >France</option>
                                <option value="GF" >French Guiana</option>
                                <option value="PF" >French Polynesia</option>
                                <option value="TF" >French Southern Territories</option>
                                <option value="GA" >Gabon</option>
                                <option value="GM" >Gambia</option>
                                <option value="GE" >Georgia</option>
                                <option value="DE" >Germany</option>
                                <option value="GH" >Ghana</option>
                                <option value="GI" >Gibralter</option>
                                <option value="GR" >Greece</option>
                                <option value="GL" >Greenland</option>
                                <option value="GD" >Grenada</option>
                                <option value="GP" >Guadeloupe</option>
                                <option value="GU" >Guam</option>
                                <option value="GT" >Guatemala</option>
                                <option value="GN" >Guinea</option>
                                <option value="GW" >Guinea-Bissau</option>
                                <option value="GY" >Guyana</option>
                                <option value="HT" >Haiti</option>
                                <option value="HM" >Heard &amp; Mcdonald Islands</option>
                                <option value="HN" >Honduras</option>
                                <option value="HK" >Hong kong</option>
                                <option value="HU" >Hungary</option>
                                <option value="IS" >Iceland</option>
                                <option value="ID" >Indonesia</option>
                                <option value="IR" >Iran</option>
                                <option value="IQ" >Iraq</option>
                                <option value="IE" >Ireland</option>
                                <option value="IL" >Israel</option>
                                <option value="IT" >Italy</option>
                                <option value="CI" >Ivory Coast</option>
                                <option value="JM" >Jamaica</option>
                                <option value="JP" >Japan</option>
                                <option value="JO" >Jordan</option>
                                <option value="KZ" >Kazakhstan</option>
                                <option value="KE" >Kenya</option>
                                <option value="KI" >Kiribati</option>
                                <option value="KP" >Korea (Democratic People's Republic Of)</option>
                                <option value="KW" >Kuwait</option>
                                <option value="KG" >Kyrgyzstan</option>
                                <option value="LA" >Lao People's Democratic Republic</option>
                                <option value="LV" >Latvia</option>
                                <option value="LB" >Lebanon</option>
                                <option value="LS" >Lesotho</option>
                                <option value="LR" >Liberia</option>
                                <option value="LY" >Libyan Arab Jamahiriya</option>
                                <option value="LI" >Liechtenstein</option>
                                <option value="LT" >Lithuania</option>
                                <option value="QL" >Lithuania (Dummy Code)</option>
                                <option value="LU" >Luxembourg</option>
                                <option value="MO" >Macau</option>
                                <option value="MK" >Macedonia</option>
                                <option value="MG" >Madagascar</option>
                                <option value="MW" >Malawi</option>
                                <option value="MY" >Malaysia</option>
                                <option value="MV" >Maldives</option>
                                <option value="ML" >Mali</option>
                                <option value="MT" >Malta</option>
                                <option value="MH" >Marshall Islands</option>
                                <option value="MQ" >Martinique</option>
                                <option value="MR" >Mauritania</option>
                                <option value="MU" >Mauritius</option>
                                <option value="YT" >Mayotte</option>
                                <option value="MX" >Mexico</option>
                                <option value="MB" >Mexico Buffer</option>
                                <option value="FM" >Micronesia</option>
                                <option value="MD" >Moldova</option>
                                <option value="MC" >Monaco</option>
                                <option value="MN" >Mongolia</option>
                                <option value="MS" >Montserrat</option>
                                <option value="MA" >Morocco</option>
                                <option value="MZ" >Mozambique</option>
                                <option value="MM" >Myanmar</option>
                                <option value="NA" >Namibia</option>
                                <option value="NR" >Nauru</option>
                                <option value="NP" >Nepal</option>
                                <option value="NL" >Netherlands</option>
                                <option value="AN" >Netherlands Antilles</option>
                                <option value="NC" >New Caledonia</option>
                                <option value="NZ" >New Zealand</option>
                                <option value="NI" >Nicaragua</option>
                                <option value="NE" >Niger</option>
                                <option value="NG" >Nigeria</option>
                                <option value="NU" >Niue</option>
                                <option value="NF" >Norfolk Islands</option>
                                <option value="MP" >Northern Mariana Islands</option>
                                <option value="NO" >Norway</option>
                                <option value="OM" >Oman</option>
                                <option value="PK" >Pakistan</option>
                                <option value="PW" >Palau</option>
                                <option value="PS" >Palestinian Occ. Territories</option>
                                <option value="PA" >Panama</option>
                                <option value="PG" >Papua New Guinea</option>
                                <option value="PY" >Paraguay</option>
                                <option value="PE" >Peru</option>
                                <option value="PH" >Philippines</option>
                                <option value="PL" >Poland</option>
                                <option value="PT" >Portugal</option>
                                <option value="PR" >Puerto Rico</option>
                                <option value="QA" >Qatar</option>
                                <option value="RE" >Reunion</option>
                                <option value="RO" >Romania</option>
                                <option value="RW" >Ruanda</option>
                                <option value="RU" >Russian Federation</option>
                                <option value="LC" >Saint Lucia</option>
                                <option value="WS" >Samoa</option>
                                <option value="SM" >San Marino</option>
                                <option value="ST" >Sao Tome &amp; Principe</option>
                                <option value="SA" >Saudi Arabia</option>
                                <option value="SN" >Senegal</option>
                                <option value="SC" >Seychelles</option>
                                <option value="SL" >Sierra Leone</option>
                                <option value="SG" >Singapore</option>
                                <option value="SK" >Slovakia</option>
                                <option value="SI" >Slovenia</option>
                                <option value="SB" >Solomon Islands</option>
                                <option value="SO" >Somalia</option>
                                <option value="ZA" >South Africa</option>
                                <option value="GS" >South Georgia &amp; South Sandwich</option>
                                <option value="KR" >South Korea</option>
                                <option value="SU" >Soviet Union</option>
                                <option value="ES" >Spain</option>
                                <option value="LK" >Sri Lanka</option>
                                <option value="SH" >St. Helena</option>
                                <option value="KN" >St. Kitts and Nevis</option>
                                <option value="PM" >St. Pierre &amp; Miquelon</option>
                                <option value="VC" >St. Vincent &amp; the Grenadines</option>
                                <option value="SD" >Sudan</option>
                                <option value="SR" >Suriname</option>
                                <option value="SJ" >Svalbard &amp; Jan Mayen Islands</option>
                                <option value="SZ" >Swaziland</option>
                                <option value="SE" >Sweden</option>
                                <option value="CH" >Switzerland</option>
                                <option value="SY" >Syrian Arab Republic</option>
                                <option value="TW" >Taiwan</option>
                                <option value="TJ" >Tajikistan</option>
                                <option value="TZ" >Tanzania</option>
                                <option value="TH" >Thailand</option>
                                <option value="TG" >Togo</option>
                                <option value="TK" >Tokelau</option>
                                <option value="TO" >Tonga</option>
                                <option value="TT" >Trinidad and Tobago</option>
                                <option value="TN" >Tunisia</option>
                                <option value="TC" >Turcs &amp; Caicos Islands</option>
                                <option value="TR" >Turkey</option>
                                <option value="TM" >Turkmenistan</option>
                                <option value="TV" >Tuvalu</option>
                                <option value="UM" >U.S. Minor Outlaying Islands</option>
                                <option value="UG" >Uganda</option>
                                <option value="UA" >Ukraine</option>
                                <option value="AE" >United Arab Emirates</option>
                                <option value="GB" >United Kingdom</option>
                                <option value="UY" >Uruguay</option>
                                <option value="US" >USA</option>
                                <option value="UZ" >Uzbekistan</option>
                                <option value="VU" >Vanuatu</option>
                                <option value="VA" >Vatican City State</option>
                                <option value="VE" >Venezuela</option>
                                <option value="VN" >Vietnam</option>
                                <option value="VI" >Virgin Islands (US)</option>
                                <option value="WF" >Wallis &amp; Futuna Islands</option>
                                <option value="EH" >Western Sahara</option>
                                <option value="YE" >Yemen</option>
                                <option value="YU" >Yugoslavia</option>
                                <option value="ZM" >Zambia</option>
                                <option value="ZW" >Zimbabwe</option>
                            </select>
                            <i class="icon-time"></i>
                        </div>
                    </div>
                </fieldset>
                <input type="hidden" id="hiddenEmail" name="hiddenEmail" value="{{ hidden_email }}">
                <input type="hidden" id="hiddenPhoneNumber" name="hiddenPhoneNumber" value="{{ hidden_phone_number }}">
                <input type="hidden" id="hiddenUsername" name="hiddenUsername" value="{{ hidden_username }}">
                <fieldset class="scheduler-border col-md-2 mb-3">
                    <legend class="scheduler-border">Person & Rooms</legend>
                    <div class="control-group">
                        <div class="controls bootstrap-timepicker">
                            <input type="text" value="1 Room & 2 Adults "  readonly id="room" style="font-size: 14px;" onclick="showForm()">
                            <input type="hidden" id="roomInfoInput" name="roomInfoInput">
                            <input type="hidden" id="totalRoomInfoInput" name="totalRoomInfoInput">
                            <!-- <input type="hidden" id="totalNoOfRooms" name="totalNoOfRooms"> -->
                        </div>
                    </div>
                </fieldset>
                <div class="col-md-12 text-end mb-2" id="btn">
                    <button type="submit" class="btn btn-primary" id="search-btn">Search</button>
                </div>
            </form>
        </div>
    </section>

    <section id="form">
        <div id="wrapper">
            <div id="form_div">
                <table class="table table-hover text-nowrap" id="attribute_table">
                    <thead>
                        <tr>
                            <th class="room-h">Room</th>
                            <th class="room-h">Adults</th>
                            <th class="room-h">Child</th>
                            <th class="room-h" id="age_1">Age 1</th>
                            <th class="room-h" id="age_2">Age 2</th>
                            <th class="room-h" id="age_3">Age 3</th>
                            <th class="room-h" id="age_4">Age 4</th>
                            <!-- <th class="room-h">Child 1</th> -->
                        </tr>
                    </thead>
                    <tr id="row1" class="room-info">
                        <td class="room_no">Room1</td>
                        <td>
                            <select name='attribute_name' class='selectbox_form attribute_name' id="adult_1" onchange="getAdultCount()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </td>
                        <td>
                            <select name='attribute_id' id="child_1" class='selectbox_form  attribute_value' onchange="getAdultCount()">
                                <option data-parent='0' value='0'>Select</option>
                                <option  value="1">1</option>
                                <option value='2'>2</option>
                                <option value='3'>3</option>
                                <option value='4'>4</option>
                            </select>
                        </td>
                        <td>
                            <select id="childage_1_1" class='selectbox_form  attribute_value' onchange="getAdultCount()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </td>
                        <td>
                            <select  id="childage_1_2" class='selectbox_form  attribute_value' onchange="getAdultCount()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </td>
                        <td>
                            <select id="childage_1_3" class='selectbox_form  attribute_value' onchange="getAdultCount()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </td>
                        <td>
                            <select id="childage_1_4" class='selectbox_form attribute_value' onchange="getAdultCount()">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                    </tr>
                </table>

                <input class="btn" id="add-btn" type="button" onclick="add_attribute_row();" value="Add Room+">

                <input class="btn " id="remove-btn" type="button" onclick="del_att_row();" value="Remove Room-">
            </div>
            <button class="btn btn-primary" id="app-btn" onclick="hideForm()">Apply</button>
        </div>
        
    </section>

    <!-- FORM  -->
    

    <script>
       
        function getAdultCount() {
            $rowno = $("#attribute_table tr").length-2
            totaladult=0
            totalchild=0
            roominfo=[]
            totalroominf0=[]

            for(i=1;i<=$rowno;i++) {
                totaladult=parseInt(totaladult) + parseInt($("#adult_"+i).val())
                totalchild=parseInt(totalchild) + parseInt($("#child_"+i).val())
                // var childAge = parseInt($("#child_"+i).val()) !== 0 ? [parseInt($("#childage_"+i).val())] : null;
                
                // Handle the first row separately
                // var childrenCountFirstRow = parseInt($("#child_1").val());
                // var childAgeFirstRow = [];

                // for (var k = 1; k <= childrenCountFirstRow; k++) {
                //     var ageFirstRow = parseInt($("#childage_" + k).val());
                //     if (!isNaN(ageFirstRow)) {
                //         childAgeFirstRow.push(ageFirstRow);
                //     }
                // }

                // roominfo[0] = {
                //     "NoOfAdults": parseInt($("#adult_1").val()),
                //     "NoOfChild": parseInt($("#child_1").val()),
                //     "ChildAge": childAgeFirstRow
                // };
                

                var childrenCount = parseInt($("#child_" + i).val());
                var childAge = [];

                for (var j = 1; j <= childrenCount; j++) {
                var age = parseInt($("#childage_" + i + "_" + j).val());
                if (!isNaN(age)) {
                    childAge.push(age);
                }
              
            }
    
                roominfo[i-1]={"NoOfAdults":parseInt($("#adult_"+i).val()) ,"NoOfChild":parseInt($("#child_"+i).val()),"ChildAge":childAge }
                

                // roominfo[i-1]={"NoOfAdults":parseInt($("#adult_"+i).val()) ,"NoOfChild": parseInt($("#child_"+i).val()),"ChildAge": childAge }
            }

            var roomCount = $rowno + " " + "Room" +" " + "&" + " " + totaladult +" " + "Adults";
            document.getElementById('room').value = roomCount;
            
            showChildAgeSelectors()

            // console.log($rowno,totaladult,totalchild)
            totalroominf0={"TotalRooms":$rowno,"NoOfAdults":totaladult,"NoOfChild":totalchild}
            console.log(roominfo,totalroominf0)
            console.log(totalroominf0)

            document.getElementById('roomInfoInput').value = JSON.stringify(roominfo);
            document.getElementById('totalRoomInfoInput').value = JSON.stringify(totalroominf0);
            document.getElementById('totalNoOfRooms').value = $rowno;

            // document.getElementById('roomInfoInput').value = JSON.stringify(roominfo);
            // document.getElementById('totalRoomInfoInput').value = JSON.stringify({
            //     "TotalRooms": $rowno,


            };

            function showChildAgeSelectors() {
            // Hide all child age selectors first
            $("[id^=childage_]").hide();
            $("[id^=age_]").hide();

            // Get the number of children selected in the first row
            var childrenCountFirstRow = parseInt($("#child_1").val());

            // Show the corresponding child age selectors in the first row
            for (var i = 1; i <= childrenCountFirstRow; i++) {
                $("#childage_" + i).show();
                $("#age_" + i).show();
            }
            

            // Iterate through each dynamically added row
            $("#attribute_table tr").each(function(index, row) {
                var rowNumber = index + 1;
                var childrenCount = parseInt($("#child_" + rowNumber).val());

                // Show the corresponding child age selectors for each dynamically added row
                for (var i = 1; i <= childrenCount; i++) {
                    $("#childage_" + rowNumber + "_" + i).show();
                    $("#age_" + i).show();
                }
            });

            
        }


        function hideForm() {
        var x = document.getElementById("form");
        if (x.style.display === "block") {
            // If the form is being hidden, validate the previous row before hiding
            var prevRowNo = $("#attribute_table tr").length - 2; // Get the previous row number
            if (!validatePreviousRow(prevRowNo)) {
                alert("Please select valid options for the Adults.");
                return; // Do not hide the form if validation fails
            }
            x.style.display = "none";
        } else {
            x.style.display = "none";
        }
    }


    function add_attribute_row() {
    // Get the current number of rows
    var $rowno = $("#attribute_table tr").length - 1;

    // Check if the limit of 6 rows has been reached
    if ($rowno <= 6) {
        // Check if the previous row's selects have valid values
        var prevRowIsValid = validatePreviousRow($rowno - 1);

        if (prevRowIsValid) {
            // Add a new row
            $("#attribute_table tr:last").after("<tr  id='row" + $rowno + "'>" +
                "<td class='room_no'>Room" + $rowno + "</td>" +
                "<td><select name='attribute_name' onchange='getAdultCount()' id='adult_" + $rowno + "' class='selectbox_form  attribute_name'>" +
                "<option value='1' selected>1</option><option value='2'>2</option><option value='3'>3</option>" +
                "<option value='4'>4</option><option value='5'>5</option><option value='6'>6</option></select></td>" +
                "<td><select name='attribute_id' id='child_" + $rowno + "' onchange='getAdultCount()' class='selectbox_form  attribute_value'>" +
                "<option data-parent='0' value='0'>Select</option><option data-parent='Colour' value='1'>1</option><option data-parent='Colour' value='2'>2</option>" +
                "<option data-parent='Colour' value='3'>3</option><option data-parent='Colour' value='4'>4</option></select></td></tr>");

            for (var i = 1; i <= 4; i++) {
                $("#row" + $rowno).append("<td><select id='childage_" + $rowno + "_" + i + "' onchange='getAdultCount()' class='selectbox_form  attribute_value'>" +
                    "<option data-parent='Colour' value='1'>1</option><option data-parent='Colour' value='2'>2</option>" +
                    "<option data-parent='Colour' value='3'>3</option><option data-parent='Colour' value='4'>4</option><option data-parent='Colour' value='5'>5</option>" +
                    "<option data-parent='Colour' value='6'>6</option><option data-parent='Colour' value='7'>7</option><option data-parent='Colour' value='8'>8</option>" +
                    "<option data-parent='Colour' value='9'>9</option><option data-parent='Colour' value='10'>10</option><option data-parent='Colour' value='11'>11</option>" +
                    "<option data-parent='Colour' value='12'>12</option></select></td>");
            }

            // Call the getAdultCount function
            showChildAgeSelectors();
            getAdultCount();
        } else {
            // Alert the user or handle the case where the previous row's selects are not valid
            alert("Please select valid options for the Adults.");
        }
    } else {
        // Alert the user or handle the case where the limit is reached
        alert("Only 6 rooms are allowed.");
        }
    }

    // Function to validate the selects of the previous row
    function validatePreviousRow(prevRowNo) {
    // Check if the previous row's selects have valid values
    var adultValue = $("#adult_" + prevRowNo).val();
    // var childValue = $("#child_" + prevRowNo).val();

    // Return true if both selects have valid values, otherwise false
    return adultValue !== "0" ;
    }


function del_att_row() {
        rowno = $("#attribute_table tr").length-2 ;
        if(rowno > 1)
        $('#row' + rowno).remove();
        showChildAgeSelectors();
        getAdultCount()
    }

       
 </script>
 

    <!-- FOOTER -->
    <footer class="bg-dark text-white">
        <div class="container">
            <div class="row align-items-center footer">
                <div class="col-md-2 footer-img">
                    <img src="{% static 'image/booking/Magnet logo.png' %}" alt="VF Logo" class="img-fluid">
                </div>
                <div class="col-md-2 footer-icons">
                    <img src="{% static 'image/booking/facebook Icons.svg' %}" alt="Facebook Icon" class="footer-icon">
                    <img src="{% static 'image/booking/x Icons.svg' %}" alt="X Icon" class="footer-icon">
                    <img src="{% static 'image/booking/youtube Icons.svg' %}"  alt="YouTube Icon" class="footer-icon">
                    <img src="{% static 'image/booking/insta Icons.svg' %}" alt="Instagram Icon" class="footer-icon">
                    <img src="{% static 'image/booking/linked in Icons.svg' %}" alt="LinkedIn Icon" class="footer-icon">
                </div>
            </div>
        </div>
    </footer>  

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DATE FUNCTIONS ------------------- -->
    <script>
        $(function () {
            // Initialize Datepicker for the first date
            $("#check-in").datepicker({
            minDate: 0, // Minimum date is today
            dateFormat: 'dd MM yy', // Set the date format
            onSelect: function (dateText, inst) {
                // Update the data-date attribute using moment.js
                $(this).attr("data-date", moment(dateText, "DD MMMM YYYY").format($(this).attr("data-date-format")));

                // Calculate the next date using moment.js
                var nextDate = moment(dateText, "DD MMMM YYYY").add(1, 'days').format("DD MMMM YYYY");

                // Set the default date for the second datepicker to one day after the selected date
                $("#check-out").datepicker("option", "minDate", nextDate);
                $("#check-out").datepicker("setDate", nextDate);
            }
            });

            // Initialize Datepicker for the second date
            $("#check-out").datepicker({
            minDate: 1, // Minimum date is one day after today
            dateFormat: 'dd MM yy', // Set the date format
            });

            // Set the default date to today for the first datepicker
            $("#check-in").datepicker("setDate", new Date());

            // Set the default date for the second datepicker to one day after today
            var nextDefaultDate = moment().add(1, 'days').format("DD MMMM YYYY");
            $("#check-out").val(nextDefaultDate);
        });

   
        //   DEFAULT ADULT FUNCTIONS
 
        $(document).ready(function() {
            $("#adult_1").val("2");
            getAdultCount();
            });
   
        // LOADER --------------------------------------------------------

        var loader =  document.getElementById("preloader")
                window.addEventListener("load", function() {
                    loader.style.display="none"
                })

    </script>
    <script type="text/javascript">
        window.addEventListener('pageshow', function(event) {
            var historyTraversal = event.persisted || (typeof window.performance != 'undefined' && window.performance.navigation.type === 2);
            if (historyTraversal) {
                // Reload the page if navigating back
                window.location.reload();
            }
        });
    </script>

    <!-- STYLES -->
    <style>

        #form {
            /* margin: -50px 20px 20px 700px; */
            background:  rgba(255, 255, 255, 1);
            /* width: 700px; */
            padding: 10px;
            height: auto;
            position: absolute;
            box-shadow: 5px 5px 12px grey;
            border-radius: 10px;
            justify-content: center;
            align-items: center;
            z-index: 99;
            display: none;
        }

         legend {
            float: none;
            width: auto;
            /* padding: 0; */
            padding: 2px 6px;
            margin-bottom: 0.5rem;
            font-size: calc(1.275rem + .3vw);
            line-height: inherit;
            font-weight: 600;
            font-size: 1em !important;
        }

        legend.scheduler-border {
            font-size: 0.9em !important;
            font-weight: normal !important;
            text-align: left !important;
        }

        .selectbox_form {
            width: 60px;
            padding:6px 4px;
            border-radius: 8px;
        }

        #form select {
            font-size: 12px;
        }

        .table>:not(caption)>*>* {
                padding: 4px !important;
            }

        .nav-item a {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 1) !important;
        }

        #log-btn {
            color: black;
            background-color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
        }

        #log-btn:hover {
            background-color: rgba(41, 41, 41, 0.8);
            color: white;
        }

        


        
        @media only screen and (max-width: 768px) {
            #main_container {
                flex-direction: column;
            }

            fieldset.scheduler-border {
                width: 100% !important;
            }

            .titles {
                font-size: 17px;
                font-weight: 600;
            }

            #form select {
                font-size: 10px;
            }

            .table>:not(caption)>*>* {
                padding: 4px !important;
            }

            .selectbox_form {
                width: 40px;
                padding: 4px;
                border-radius: 8px;
            }

            .room-h {
                font-size: 14px;
            }

            .room_no {
                font-size: 13px;
            }
        }

        @media only screen and (max-width: 1235px) {
            fieldset.scheduler-border {
                margin: 0 0.19em 1.5em 0 !important;
            }
        }

        
        @media only screen and (max-width: 1023px) {
            fieldset.scheduler-border {
                padding: 4px !important;
            }
        }

        @media only screen and (max-width: 880px) {
            fieldset.scheduler-border {
                padding: 4px !important;
            }

            fieldset.scheduler-border {
                width: 200px;
            }

            #input-sec {
                justify-content: space-between;
            }
        }


           
 #form {
    margin: -50px 20px 20px 950px;
    /* Media query for screens up to 500px */
    @media only screen and (min-width: 400px) and (max-width: 500px) {
        margin: -65px 20px 20px;
        padding: 6px;
    }

    /* Media query for screens up to 700px */
    @media only screen and (min-width: 300px) and (max-width: 400px) {
        margin: -65px 2px 10px 2px;
    }

    /* Media query for screens up to 700px */
    @media only screen and (min-width: 501px) and (max-width: 700px) {
        margin: -65px 10px 10px 100px;
    }

    /* Media query for screens up to 900px */
    @media only screen and (min-width: 701px) and (max-width: 913px) {
        margin: -65px 10px 10px 250px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 913px) and (max-width: 1100px) {
        margin: -65px 10px 10px 400px;
    }

     /* Media query for screens up to 1100px */
     @media only screen and (min-width: 1100px) and (max-width:1200px ) {
        margin: -65px 10px 10px 540px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 1100px) and (max-width:1280px ) {
        margin: -65px 10px 10px 650px;
    }

    /* Media query for screens up to 1100px */
    @media only screen and (min-width: 1280px) and (max-width: 1400px) {
        margin: -65px 10px 10px 716px;
    }

}
        

         

    </style>

    <!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>  -->
</body>
</html>