{% load static %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zxx">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Payment Booking</title>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'image/home/Magnet logo.png' %}">
    <!-- Bootstrap core CSS -->
    <link href="{% static 'css/home/bootstrap.min.css' %}" rel="stylesheet" type="text/css">
    <!--Custom CSS-->
    <link href="{% static 'css/home/style.css' %}" rel="stylesheet" type="text/css">
    <!--Plugin CSS-->
    <link href="{% static 'css/home/plugin.css' %}" rel="stylesheet" type="text/css">

    <!--Font Awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css">

    <link rel="stylesheet" href="{% static 'css/home/fonts/line-icons.css' %}" type="text/css">
</head>

    <!-- Preloader -->
    <div id="preloader">
        <div id="status"></div>
    </div>
    <!-- Preloader Ends -->

    <!-- header starts -->
    {% include 'home/header.html' %}
    <!-- header ends -->

    <button type="button" id="timeOutBtn" class="btn btn-primary d-none" data-bs-toggle="modal" data-bs-target="#exampleModaltimeout">
        Timeout
    </button>
    <div class="modal fade" id="exampleModaltimeout" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header justify-content-center">
              <h3 class="modal-title theme" id="exampleModalLabel">Timeout</h3>
            </div>
            <div class="modal-body p-2">
                <div id="customPopup" class="container popup">
                    <div class="popup-content col-md-12 text-center">
                        <img src="/VFpages/static/image/booking/Timeout.png" alt="">
                        <p class="mt-2" mt-2="">Your session has timed out. Please try again.</p>
                    </div>
                </div>
            </div>
            <!-- <div class="modal-footer">
                <a href="{% url 'hotel' %}"><button type="button" class="btn btn-secondary">Ok</button></a>
            </div> -->
          </div>
        </div>
      </div>


    <!-- top Destination starts -->
    <section class="trending pt-6 pb-0 bg-lgrey" style="z-index: 0;">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-xs-12 mb-4">
                    <div class="payment-book">
                        <div class="booking-box">
                            <div class="travellers-info mb-4">
                                <h3>Contact Details</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th class="text-start">User Name</th>
                                            <th class="text-start">Mobile Number</th>
                                            <th class="text-start">Email</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="theme2">{{ combined_data.user_name }}</td>
                                            <td class="theme2">{{ combined_data.phone_number }}</td>
                                            <td class="theme2">{{ combined_data.email }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="desc-box fs-14 bg-grey p-2 rounded  text_canpol">
                                <h5 class="mb-2">Cancellation Policy</h5>
                                <p class="mb-0">{{ combined_data.cancellation_policy|safe }}</p>
                            </div>
                            <div class="text-end mb-2">
                                <button class="theme2 fs-14 py-0 px-3 shadows my-1 rounded-pill fs-14 bg-grey" type="button"  data-bs-toggle="modal" data-bs-target="#exampleModal" >Read More...</button>
                            </div>
                            <!-- Modal -->
                            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable p-2" style="max-width: 1250px;">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title theme" id="exampleModalLabel">Cancellation Policy</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body border-t bg-grey p-2" style="font-size: 13px;overflow-y: scroll;height:400px;">
                                        <p>{{ combined_data.cancellation_policy|safe }}</p>
                                        </div>
                                    </div>
                                </div>  
                            </div>
                           
                            <div class="desc-box bg-grey p-2 mb-2 rounded">
                                <h5 class="mb-2">Booking Notes</h5>
                                <p class="mb-0 fs-14">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Nihil dolorum cumque nobis omnis nesciunt, eum quaerat assumenda mollitia reprehenderit fuga exercitationem optio labore, totam deserunt architecto? Aspernatur id at quas rerum ad animi hic reiciendis aut, mollitia assumenda maiores! Enim ab ratione, ea et expedita explicabo sed a perspiciatis accusantium consequatur laudantium voluptatem eum architecto suscipit, officiis exercitationem omnis necessitatibus inventore. Amet soluta sit adipisci provident, odio ex quo eaque, ut unde omnis sed laboriosam aliquam. Natus sed dolor quod ea, dicta rerum rem sit aut. Numquam esse corporis corrupti minus, magni molestias obcaecati beatae ut sequi, voluptate voluptatibus rem!</p>
                            </div>
                            <div class="desc-box bg-grey p-2 mb-2 rounded">
                                <h5 class="mb-2">General Terms & Conditions</h5>
                                <p class="mb-0 fs-14">Lorem ipsum dolor sit amet consectetur adipisicing elit. Labore suscipit veniam odio ea quo eum. Excepturi nihil ex corrupti iure voluptates aperiam ab alias ea cupiditate, perspiciatis culpa, exercitationem, magni a tempora magnam in doloribus deleniti commodi expedita ducimus iste odio reprehenderit suscipit. Quos aliquam magnam, nulla voluptas adipisci debitis nobis officiis quidem ducimus id sapiente vel quibusdam, reiciendis reprehenderit praesentium alias fuga aliquid natus sit laudantium. Deserunt, at. Molestiae sit blanditiis harum numquam fugiat earum iusto libero labore facilis, magni quas quasi voluptas maxime omnis natus dolores qui expedita atque soluta culpa ducimus officia dolor, asperiores laborum. Ratione alias, laudantium sunt a enim nulla, neque repellendus quasi maiores magni quae veniam id eveniet beatae. Voluptas in natus possimus perferendis. Sapiente reiciendis ea laborum amet fugiat voluptates sint suscipit numquam unde itaque, nesciunt maiores expedita est delectus sequi dolor beatae. Necessitatibus nobis repudiandae iste, mollitia labore ipsa ut perferendis soluta minima rerum commodi vitae dolorum explicabo id pariatur fugit quis excepturi iusto quo odio eveniet amet quos ducimus cum! Corporis, voluptatem. Totam laborum aspernatur labore quas quae expedita sit dolores eveniet, veritatis dolorem commodi voluptate voluptas quia culpa ducimus ut exercitationem cum illo non delectus, beatae fugiat esse. Asperiores, dicta.</p>
                            </div>
                            <form action="">
                                <div class="form-group mb-0 d-flex">
                                    <input type="checkbox"  id="contactCheckbox"><p class="theme2 fs-14 mb-0 ms-2">By continuing, you agree to the Terms and Conditions.</p> 
                                    
                                </div>
                                <span class="error" id="checkboxError"></span>
                                <div class="booking-border d-flex mt-2">
                                    <button type="button"  class="nir-btn me-2" id="pay-btn" onclick="validateCheckbox()">Proceed To Payment</button>
                                    <!-- <a href="#" class="nir-btn-black"><i class="fa fa-envelope-open-text"></i> Send To</a> -->
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 mb-4 ps-ld-4">
                    <div class="sidebar-sticky ">
                        <div class="sidebar-item mb-2 rounded overflow-hidden bg-title p-4">
                                <h4 class="white text-center border-b pb-2">Pricing Details</h4>
                                <div class="row">
                                    <div class="col-lg-6 mb-2">
                                        <div class="form-group">
                                            <p class="white pb-1 mb-0">Check In</p>
                                            <span class="choosen-date white mb-0 border-0 "><i class="fa fa-calendar"></i> {{ combined_data.check_in_date }}</span>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 mb-2">
                                        <div class="form-group">
                                            <p class="white pb-1 mb-0">Check Out</p>
                                            <span class="choosen-date white mb-0 border-0 "><i class="fa fa-calendar"></i> {{ combined_data.check_out_date }}</span>
                                        </div>
                                    </div>
                                  
                                    <div class="col-lg-12">
                                        <div class="form-group bg-white p-3 rounded mb-2">
                                            <ul>
                                                <li class="d-block pb-1">Base Fare <span style="font-size: 12px;" class="rn_det"> ({{ combined_data.total_rooms }} Room X {{ combined_data.no_of_nights }} Night)</span><span class="float-end fw-bold black"><span style="font-family:'Poppins,'">₹</span> {{ combined_data.published_price }}</span></li>
                                                <li class="d-block pb-1">Taxes and Fees<span class="float-end fw-bold black"><span style="font-family:'Poppins,'">₹</span> {{ combined_data.final_tax }}</span></li>
                                                <li class="d-block  pb-1">Total Price<span class="float-end fw-bold black"><span style="font-family:'Poppins,'">₹</span> {{ combined_data.total_price }}</span></li>
                                                <li class="d-block border-t">
                                                    <div class="pt-1">
                                                        <span class="fw-bold">Your Price</span><span class="float-end fw-bold black"><span style="font-family:'Poppins,'">₹</span> {{ combined_data.total_price }}</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- <div class="col-lg-12">
                                        <div class="form-group mb-0">
                                            <a href="#" class="nir-btn w-100">Instant Book</a>
                                        </div>
                                    </div> -->
                                </div>
                        </div>
                        <div class="sidebar-item bg-white rounded box-shadow overflow-hidden p-3 mb-2">
                            <!-- <h4>Hotel Summary</h4> -->
                            <div class="trend-full border-b">
                                <div class="row">
                                    <div class="">
                                        <div class="trend-content position-relative">
                                            <h5 class="mb-1">{{ combined_data.hotel_name }}</h5>
                                            <div class="rating star-view mb-1">
                                                {% for star in "12345" %}
                                                <span class="fa fa-star {% if forloop.counter <= combined_data.rating %}checked{% else %}unchecked{% endif %}"></span>
                                               {% endfor %}<span>({{ combined_data.rating }} - star)</span>
                                            </div>
                                            <address class="mb-2" style="font-size: 14px;"><i class="icon-directions theme me-2" style="font-size: 18px;"></i>{{ combined_data.address }}</address>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="trend-check border-b pb-2">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="trend-check-item bg-grey rounded p-2">
                                            <p class="mb-0">Nights</p>
                                            <span class="mb-0 num black fw-bold">{{ combined_data.no_of_nights }}</span>
                                            <!-- <small>15:00 - 22:00</small> -->
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="trend-check-item bg-grey rounded p-2">
                                            <p class="mb-0">Rooms</p>
                                            <span class="mb-0 num black fw-bold">{{ combined_data.total_rooms }}</span>
                                            <!-- <small>1:00 - 10:00</small> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% for hotel in combined_data.hotel_details %}
                            <div class="trend-check border-b pb-2">
                                <p class="mb-0">Room Type</p>
                                <h6 class="mb-0">{{ hotel.HotelName }}</h6>
                                <!-- <small><a href="#" class="theme text-decoration-underline">travelling on different dates?</a></small> -->
                            </div>
                            <div class="trend-check border-b pb-2">
                                <p class="mb-0">INC</p>
                                <span class="mb-0 num black fw-bold">{{ hotel.OfferedPrice }}</span>
                                <!-- <small><a href="#" class="theme text-decoration-underline">travelling on different dates?</a></small> -->
                            </div>
                            {% endfor %}
                        </div>  
                    </div>
                </div>
                <style>
                    .number {
                        font-family: "Poppins,sans-serif" !important;
                    }
                </style>
            </div>
        </div>
    </section>
    <!-- top Destination ends -->
   <input type="hidden" name="balance_time" id="balance_time" value="{{ combined_data.time_difference }}">
    <footer id="footer" class="text-center container-fluid mt-3 mb-1" style="position: sticky;bottom: 0; z-index: 1;">
        <p class="mb-0 py-2">Time Remaining:<span id="time" class="ms-2"></span></p>
    </footer>


    <!-- footer starts -->
    {% include 'home/footer.html' %}
    <!-- footer ends -->
    
    <!-- Back to top start -->
    <div id="back-to-top">
        <a href="#"></a>
    </div>
    <!-- Back to top ends -->

   <style>
    .modal-backdrop {
        display: none;
    }

    .navbar-default {
        background: white !important;
    }

    footer {
        z-index: 0;
    }

    .text_canpol {
        height: 157px;
        overflow-y: hidden;
        font-size: 14px;
    }

    .fs-14 {
        font-size: 14px !important;
    }

    .fa-star.checked {
        color: orange;
    }

    .fa-star.unchecked {
        color: #ccc;
        display: none !important;
    }

    
    @media (max-width: 540px)  {
    table>tbody tr td, table thead tr th {
       font-size: 12px !important;
       word-wrap: break-word;
    }

    table {
        table-layout: fixed;
    }

    .rn_det{ 
        font-size: 10px  !important;
    }
}

   </style>

    <script>
        function validateCheckbox(e) {
            var valid = true;
            document.getElementById('checkboxError').innerText = '';
            var checkbox = document.getElementById('contactCheckbox').checked;
            if (!checkbox) {
            document.getElementById('checkboxError').innerText = 'Please select the checkbox';
        } else {
                valid = false;
                razarpay();
        } 
    }
    </script>
     <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script> 
        function razarpay() {
            var options = {
                key: "{{ razorpay_merchant_key }}", 
                currency: "{{ currency }}",
                name: "Vacation Feast",
                image:"{% static 'image/home/Magnet logo.png' %}" ,
                order_id: "{{ razorpay_order_id }}",
                amount: "{{ razorpay_amount }}", 
                callback_url: "{{ callback_url }}",
                theme : {
                        "color": "#029e9d"
                    }
                };
                var rzp1 = new Razorpay(options);
                rzp1.open();
                e.preventDefault();
                console.log("clicked")
            }
            
    </script>
     <script>
        function startTimer(duration, display) {
            var timer = duration, minutes, seconds;
            setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                display.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    timer = 0;
                } else if(timer === 0){
                    $("#timeOutBtn").click();
                    console.log("clicked")
                    setTimeout(function() {
                        window.location.href = "{% url 'hotel' %}"; // Replace with the desired URL
                    }, 2000);
                }
            }, 1000);
        }

        window.onload = function () {
            let formattedTime = `{{ combined_data.time_difference }}`;
                let balanceTime = formattedTime.toString().slice(2,7);
                let timeString = balanceTime;

                // Extract hours and minutes
                let [hours, minutes] = timeString.split(':').map(Number);

                // Convert hours to minutes and add to the total minutes
                
                let totalMinutes = hours * 60 + minutes;
                var Minutes =  totalMinutes,
                display = document.querySelector('#time');
                startTimer(Minutes, display);
        };
    </script>




     <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> -->
    <!-- *Scripts* -->
    <script src="{% static 'js/home/jquery-3.5.1.min.js' %}"></script>
    <script src="{% static 'js/home/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/home/particles.js' %}"></script>
    <script src="{% static 'js/home/particlerun.js' %}"></script>
    <script src="{% static 'js/home/plugin.js' %}"></script>
    <script src="{% static 'js/home/main.js' %}"></script>
    <script src="{% static 'js/home/custom-accordian.js' %}"></script>
    <script src="{% static 'js/home/custom-nav.js' %}"></script>
</body>
</html>